Managing Firewall Threat Defense with Cloud-delivered Firewall
Management Center inCisco Defense Orchestrator
First Published: 2022-06-28
Last Modified: 2024-07-12
Americas Headquarters
Cisco Systems, Inc.
170WestTasman Drive
San Jose, CA95134-1706
USA
http://www .cisco.com
Tel:408526-4000
800553-NETS (6387)
Fax: 408527-0883

THE SPECIFICA TIONS AND INFORMA TION REGARDING THE PRODUCTS INTHIS MANUAL ARE SUBJECT TOCHANGE WITHOUT NOTICE. ALL STATEMENTS,
INFORMA TION, AND RECOMMENDA TIONS INTHIS MANUAL ARE BELIEVED TOBEACCURA TEBUT ARE PRESENTED WITHOUT WARRANTY OFANY KIND,
EXPRESS ORIMPLIED. USERS MUST TAKE FULL RESPONSIBILITY FOR THEIR APPLICA TION OFANY PRODUCTS.
THE SOFTW ARE LICENSE AND LIMITED WARRANTY FOR THE ACCOMP ANYING PRODUCT ARE SET FOR THINTHE INFORMA TION PACKET THA TSHIPPED WITH
THE PRODUCT AND ARE INCORPORA TED HEREIN BYTHIS REFERENCE. IFYOU ARE UNABLE TOLOCA TETHE SOFTW ARE LICENSE ORLIMITED WARRANTY ,
CONT ACT YOUR CISCO REPRESENT ATIVE FOR ACOPY .
TheCisco implementation ofTCP header compression isanadaptation ofaprogram developed bytheUniversity ofCalifornia, Berkeley (UCB) aspartofUCB's public domain version of
theUNIX operating system. Allrights reserved. Copyright ©1981, Regents oftheUniversity ofCalifornia.
NOTWITHST ANDING ANY OTHER WARRANTY HEREIN, ALL DOCUMENT FILES AND SOFTW ARE OFTHESE SUPPLIERS ARE PROVIDED “AS IS"WITH ALL FAUL TS.
CISCO AND THE ABOVE-NAMED SUPPLIERS DISCLAIM ALL WARRANTIES, EXPRESSED ORIMPLIED, INCLUDING, WITHOUT LIMIT ATION, THOSE OF
MERCHANT ABILITY ,FITNESS FOR APARTICULAR PURPOSE AND NONINFRINGEMENT ORARISING FROM ACOURSE OFDEALING, USAGE, ORTRADE PRACTICE.
INNOEVENT SHALL CISCO ORITSSUPPLIERS BELIABLE FOR ANY INDIRECT ,SPECIAL, CONSEQUENTIAL, ORINCIDENT ALDAMAGES, INCLUDING, WITHOUT
LIMIT ATION, LOST PROFITS ORLOSS ORDAMAGE TODATAARISING OUT OFTHE USE ORINABILITY TOUSE THIS MANUAL, EVEN IFCISCO ORITSSUPPLIERS
HAVEBEEN ADVISED OFTHE POSSIBILITY OFSUCH DAMAGES.
Any Internet Protocol (IP)addresses andphone numbers used inthisdocument arenotintended tobeactual addresses andphone numbers. Any examples, command display output, network
topology diagrams, andother figures included inthedocument areshown forillustrative purposes only.Any useofactual IPaddresses orphone numbers inillustrative content isunintentional
andcoincidental.
Allprinted copies andduplicate softcopies ofthisdocument areconsidered uncontrolled. Seethecurrent online version forthelatest version.
Cisco hasmore than 200offices worldwide. Addresses andphone numbers arelisted ontheCisco website atwww .cisco.com/go/of fices.
Cisco andtheCisco logo aretrademarks orregistered trademarks ofCisco and/or itsaffiliates intheU.S. andother countries. Toview alistofCisco trademarks, gotothisURL:
https://www .cisco.com/c/en/us/about/legal/trademarks.html .Third-party trademarks mentioned aretheproperty oftheir respective owners. Theuseoftheword partner does notimply a
partnership relationship between Cisco andanyother company .(1721R)
©2024 Cisco Systems, Inc.Allrights reserved.

CONTENTS
Managing Cisco Secur eFirewall ThreatDefense with Cloud-deli veredFirewall Management Center 89 PART I
Managing Cisco Secur eFirewall ThreatDefense Devices with Cloud-deli veredFirewall Management
Center 1CHAPTER 1
Enable Cloud-delivered Firewall Management Center onYourCDO Tenant 3
Hardware andSoftware Support 3
CDO Platform Maintenance Schedule 4
Cisco AIAssistant User Guide 5 CHAPTER 2
Getting Started with Cisco AIAssistant 5
Prompt Guide forCisco AIAssistant 9
Create Policy Rules 12
Cisco AIAssistant Frequently Asked Questions (FAQ) 16
Onboard Devices toCloud-deli veredFirewall Management Center 21 PART II
Onboard anFTD totheCloud-deli veredFirewall Management Center 23 CHAPTER 3
Onboarding Overview 23
Prerequisites toOnboard aDevice toCloud-delivered Firewall Management Center 24
Onboard aDevice with aCLIRegistration Key 25
Onboard aDevice with Zero-T ouch Provisioning 27
Deploy aThreat Defense Device with AWS 28
Deploy aThreat Defense Device inAzure 30
Onboard anAzure VNet Environment 30
Deploy aThreat Defense Virtual inAzure 32
Deploy aThreat Defense Device toGoogle Cloud Platform 33
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
iii

Create VPC Networks forGCP 33
Deploy aThreat Defense Device onGoogle Cloud Platform 34
Onboard aSecure Firewall Threat Defense Cluster 36
Delete Devices from Cloud-delivered Firewall Management Center 37
About Device Interfaces 38
Management Interfaces 38
About Data Interfaces 38
Network Routes onDevice Management Interfaces 39
LogIntotheCommand Line Interface ontheDevice 39
Troubleshooting 41
Troubleshoot Cloud-delivered Firewall Management Center Connectivity with TCP 41
Troubleshoot Threat Defense Device Connectivity 42
Troubleshoot Device Connectivity Loss After Cloud-delivered Firewall Management Center
Update 42
Troubleshoot Onboarding aDevice totheCloud-delivered Firewall Management Center Using the
CLIRegistration Key 43
Error: Device Remains inPending Setup State After Onboarding 43
Troubleshoot Onboarding aDevice toCloud-delivered Firewall Management Center Using theSerial
Number 43
Device isOffline orUnreachable 43
Error: Serial Number Already Claimed 44
Error: Claim Error 45
Error: Failed toClaim 46
Error: Provisional Error 47
Migrate On-Pr emManagement Center Managed Secur eFirewall ThreatDefense toCloud-deli vered
Firewall Management Center 49CHAPTER 4
About Migrating Threat Defense toCloud-delivered Firewall Management Center 49
Supported Secure Firewall Management Center andSecure Firewall Threat Defense Software for
Migration 50
Licensing 51
Supported Features 51
Unsupported Features 54
Migration Guidelines andLimitations forVPN Configuration 55
Managing Threat Defense Events andAnalytics 56
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
ivContents

Before YouBegin Migration 57
Migrate Threat Defense toCloud-delivered Firewall Management Center 59
ViewaThreat Defense Migration Job 61
Proceed Migration Process 63
Commit Migration Changes Manually toCloud-delivered Firewall Management Center 63
Revert theThreat Defense Management toOn-Prem Firewall Management Center 64
ViewMigrated Devices 65
Generate aThreat Defense Migration Report 66
Delete aMigration Job 66
Enable Notification Settings 67
Troubleshoot Threat Defense Migration toCloud 67
Verify Threat Defense Connectivity with Cloud-delivered Firewall Management Center 70
Device Management 73 CHAPTER 5
LogIntotheCommand Line Interface ontheDevice 73
Add aDevice Group 75
Shut Down orRestart theDevice 75
Download theManaged Device List 76
Configure Device Settings 77
Edit General Settings 77
Copy aConfiguration toAnother Device 79
Export andImport theDevice Configuration 80
Edit License Settings 84
ViewSystem Information 84
ViewtheInspection Engine 85
ViewHealth Information 85
Edit Management Settings 85
Update theHostname orIPAddress intheManagement Center 85
Change Both Management Center andThreat Defense IPAddresses 87
Change theManager Access Interface from Management toData 91
Change theManager Access Interface from Data toManagement 95
Change theManager Access Interface from Management toData inaHigh Availability Pair 97
Change theManager Access Interface from Data toManagement inaHigh Availability Pair 101
Configure aRedundant Manager Access Data Interface 103
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
vContents

Modify Threat Defense Management Interfaces attheCLI 108
Modify theThreat Defense Data Interface Used forManagement attheCLI 114
Manually Roll Back theConfiguration iftheManagement Center Loses Connectivity 116
Troubleshoot Management Connectivity onaData Interface 118
Troubleshoot Management Connectivity onaData Interface inaHigh Availability Pair 123
ViewInventory Details 128
Edit Applied Policies 128
Edit Advanced Settings 130
Configure Automatic Application Bypass 131
Configure Object Group Search 131
Configure Interface Object Optimization 133
Edit Deployment Settings 133
Edit Cluster Health Monitor Settings 136
HotSwap anSSD ontheSecure Firewall 3100 140
Migrate theConfiguration toaNew Model 143
Supported Devices forMigration 143
License forMigration 143
Prerequisites forMigration 144
What Configurations Does theWizard Migrate? 144
Limitations forMigration 146
Migrate theSecure Firewall Threat Defense 146
Best Practices forMigration 147
Change Management 149 CHAPTER 6
About Change Management 149
How toConfigure Devices intheChange Management Workflow 150
Creating Separate Approver andConfiguration Roles 150
Policies andObjects thatSupport Change Management 151
Requirements andPrerequisites forChange Management 152
Guidelines andLimitations forChange Management 153
Enabling orDisabling Change Management 153
Managing Tickets 154
Creating Change Management Tickets 156
Opening aTicket forConfiguration Changes 156
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
viContents

Previewing aTicket 157
Submitting aTicket 157
Discarding aTicket 158
Approving orRejecting aTicket 158
History forChange Management 159
Users 161 CHAPTER 7
About Users 161
Internal andExternal Users 161
CLIAccess 161
CLIUser Roles 162
Requirements andPrerequisites forUser Accounts forDevices 162
Guidelines andLimitations forUser Accounts forDevices 163
Add anInternal User attheCLI 163
Troubleshooting LDAP Authentication Connections 165
Conf iguration Deployment 169 CHAPTER 8
About Configuration Deployment 169
Configuration Changes thatRequire Deployment 169
Deployment Preview 170
Selective Policy Deployment 171
System Username 173
Auto-Enabling ofApplication Detectors 173
Asset Rediscovery with Network Discovery Policy Changes 174
Snort Restart Scenarios 174
Restart Warnings forDevices 174
Inspect TrafficDuring Policy Apply 175
Snort Restart TrafficBehavior 176
Configurations thatRestart theSnort Process When Deployed orActivated 178
Changes thatImmediately Restart theSnort Process 179
Requirements andPrerequisites forPolicy Management 180
Best Practices forDeploying Configuration Changes 180
Deploy theConfiguration 181
Deploy Configuration Changes 182
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
viiContents

Redeploy Existing Configurations toaDevice 187
Manage Deployments 189
ViewDeployment Status 189
ViewDeployment History 189
Download Policy Changes Report forMultiple Devices 193
Compare Policies 194
Generate Current Policy Reports 195
History forConfiguration Deployment 196
System Settings 199 PART III
System Conf iguration 201 CHAPTER 9
Requirements andPrerequisites fortheSystem Configuration 201
Manage theSecure Firewall Management Center System Configuration 201
Access Control Preferences 202
Change Reconciliation 203
Configuring Change Reconciliation 203
Change Reconciliation Options 204
Email Notification 204
Intrusion Policy Preferences 204
SetIntrusion Policy Preferences 204
Manager Remote Access 205
Network Analysis Policy Preferences 205
Users 207 CHAPTER 10
About Users 207
Internal andExternal Users 207
User Roles 207
Create aUser Record with YourCDO Username 210
Troubleshooting LDAP Authentication Connections 211
Updates 213 CHAPTER 11
About System Updates 213
Guidelines andLimitations forSystem Updates 215
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
viiiContents

Update theVulnerability Database (VDB) 215
Schedule VDB Updates 216
Manually Update theVDB 216
Update theGeolocation Database (GeoDB) 217
Schedule GeoDB Updates 217
Manually Update theGeoDB 218
Update Intrusion Rules 218
Schedule Intrusion Rule Updates 220
Manually Update Intrusion Rules 220
Import Local Intrusion Rules 221
Best Practices forImporting Local Intrusion Rules 222
ViewIntrusion Rule Update Logs 223
Intrusion Rule Update LogDetails 223
Licenses 227 CHAPTER 12
About Licenses 227
Smart Software Manager andAccounts 228
How Licensing Works fortheManagement Center andDevices 228
Periodic Communication with theSmart Software Manager 228
Evaluation Mode 228
Out-of-Compliance State 229
Unregistered State 229
End-User License Agreement 229
License Types andRestrictions 229
Essentials Licenses 231
Malware Defense Licenses 231
IPSLicenses 232
Carrier License 233
URL Filtering Licenses 234
Secure Client Licenses 234
Licensing forExport-Controlled Functionality 235
Threat Defense Virtual Licenses 236
License PIDs 237
Requirements andPrerequisites forLicensing 243
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
ixContents

Requirements andPrerequisites forLicensing forHigh Availability ,Clustering, and
Multi-Instance 243
Licensing forDevice High-A vailability 243
Licensing forDevice Clusters 243
Create aCisco Account 244
Create aSmart Account andAdd Licenses 244
Configure Smart Licensing 246
Register theManagement Center forSmart Licensing 246
Register theManagement Center with theSmart Software Manager 246
Assign Licenses toDevices 249
Assign Licenses toaSingle Device 249
Assign Licenses toMultiple Managed Devices 250
Manage Smart Licensing 250
Deregister theManagement Center 251
Monitoring Smart License Status 251
Monitoring Smart Licenses 252
Troubleshooting Smart Licensing 253
Configure Legacy Management Center PAK-Based Licenses 253
Additional Information about Licensing 254
Security Certif ications Compliance 255 CHAPTER 13
Security Certifications Compliance Modes 255
Security Certifications Compliance Characteristics 256
Security Certifications Compliance Recommendations 257
Appliance Hardening 258
Protecting YourNetwork 259
Health andMonitoring 261 PART IV
Health 263 CHAPTER 14
Requirements andPrerequisites forHealth Monitoring 263
About Health Monitoring 263
Health Modules 265
Configuring Health Monitoring 275
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xContents

Health Policies 276
Default Health Policy 276
Creating Health Policies 276
Apply aHealth Policy 277
Edit aHealth Policy 278
Delete aHealth Policy 279
Send Vendor-Neutral Telemetry Streams Using OpenConfig 279
Generate Certificates andPrivate Keys 280
Configure OpenConfig Streaming Telemetry 282
Troubleshoot OpenConfig Streaming Telemetry 283
Device Exclusion inHealth Monitoring 285
Excluding Appliances from Health Monitoring 285
Excluding Health Policy Modules 286
Expired Health Monitor Exclusions 287
Health Monitor Alerts 287
Health Monitor Alert Information 287
Creating Health Monitor Alerts 288
Editing Health Monitor Alerts 289
Deleting Health Monitor Alerts 289
About theHealth Monitor 289
Using Management Center Health Monitor 291
Running AllModules foranAppliance 292
Running aSpecific Health Module 292
Generating Health Module Alert Graphs 293
Hardware Statistics onManagement Center 293
Device Health Monitors 294
Viewing System Details andTroubleshooting 294
Viewing theDevice Health Monitor 295
Cluster Health Monitor 298
Viewing theCluster Health Monitor 299
Health Monitor Status Categories 300
Health Event Views 301
Viewing Health Events 301
Viewing theHealth Events Table 302
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xiContents

TheHealth Events Table 302
About System Auditing 303
Audit Records 303
Audit LogWorkflow Fields 304
TheAudit Events Table View 304
Troubleshooting 307 CHAPTER 15
Best Practices forTroubleshooting 307
System Messages 307
Message Types 308
Message Management 310
ViewBasic System Information 310
ViewAppliance Information 310
Manage System Messages 311
ViewDeployment Messages 311
ViewUpgrade Messages 312
ViewHealth Messages 313
ViewTaskMessages 313
Manage TaskMessages 314
Memory Usage Thresholds forHealth Monitor Alerts 314
Disk Usage andDrain ofEvents Health Monitor Alerts 315
Health Monitor Reports forTroubleshooting 319
Generate Troubleshooting Files forSpecific System Functions 319
Download Advanced Troubleshooting Files 320
General Troubleshooting 321
Connection-Based Troubleshooting 321
Troubleshoot aConnection 321
Advanced Troubleshooting fortheSecure Firewall Threat Defense Device 322
Packet Capture Overview 322
UsetheCapture Trace 324
Packet Tracer Overview 326
UsethePacket Tracer 326
How tousetheThreat Defense Diagnostic CLIfrom theWebInterface 328
Feature-Specific Troubleshooting 329
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xiiContents

Tools 331 PART V
Backup/Restor e333 CHAPTER 16
About Backup andRestore 333
Requirements forBackup andRestore 334
Guidelines andLimitations forBackup andRestore 335
Best Practices forBackup andRestore 335
Back UpManaged Devices 338
Back UpaThreat Defense Device from Cloud-delivered Firewall Management Center 338
Restore CDO-Managed Devices 339
Restore aThreat Defense Device 339
Restore Threat Defense from Backup: Threat Defense Virtual 342
Scheduling 345 CHAPTER 17
About TaskScheduling 345
Requirements andPrerequisites forTaskScheduling 346
Configuring aRecurring Task 346
Scheduled Backups 347
Schedule Remote Device Backups 347
Configuring Certificate Revocation ListDownloads 348
Automating Policy Deployment 348
Nmap Scan Automation 349
Scheduling anNmap Scan 350
Automating Report Generation 351
Specify Report Generation Settings foraScheduled Report 351
Automating Cisco Recommendations 352
Software Upgrade Automation 353
Automating Software Downloads 353
Automating Software Pushes 354
Automating Software Installs 355
Vulnerability Database Update Automation 355
Automating VDB Update Downloads 356
Automating VDB Update Installs 356
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xiiiContents

Automating URL Filtering Updates Using aScheduled Task 357
Scheduled TaskReview 358
TaskListDetails 358
Viewing Scheduled Tasks ontheCalendar 359
Editing Scheduled Tasks 360
Deleting Scheduled Tasks 360
Import/Export 361 CHAPTER 18
About Configuration Import/Export 361
Configurations thatSupport Import/Export 361
Special Considerations forConfiguration Import/Export 362
Requirements andPrerequisites forConfiguration Import/Export 363
Exporting Configurations 363
Importing Configurations 364
Import Conflict Resolution 365
Reporting andAlerting 369 PART VI
Exter nalAlerting with Alert Responses 371 CHAPTER 19
Secure Firewall Management Center Alert Responses 371
Configurations Supporting Alert Responses 372
Requirements andPrerequisites forAlert Responses 372
Creating anSNMP Alert Response 372
Creating aSyslog Alert Response 374
Syslog Alert Facilities 375
Syslog Severity Levels 376
Creating anEmail Alert Response 376
Exter nalAlerting forIntrusion Events 379 CHAPTER 20
About External Alerting forIntrusion Events 379
License Requirements forExternal Alerting forIntrusion Events 380
Requirements andPrerequisites forExternal Alerting forIntrusion Events 380
Configuring SNMP Alerting forIntrusion Events 380
Intrusion SNMP Alert Options 381
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xivContents

Configuring Syslog Alerting forIntrusion Events 382
Facilities andSeverities forIntrusion Syslog Alerts 383
Configuring Email Alerting forIntrusion Events 384
Intrusion Email Alert Options 384
Events andAssets 387 PART VII
Cisco Security Analytics andLogging 389 CHAPTER 21
About Security Analytics andLogging 389
Comparison ofSAL Remote Event Storage andMonitoring Options 390
About SAL (OnPrem) 390
Licensing forSAL (OnPrem) 391
Manage SAL (OnPrem) forCDO-Managed Threat Defense Devices 391
Configure SAL (OnPrem) Integration 393
Configure aSecure Network Analytics Manager 393
Configure aSecure Network Analytics Data Store 394
About SAL (SaaS) 396
Licensing forSAL (SaaS) 396
Configure theSAL (SaaS) Integration 396
Requirements, Guideline, andLimitations fortheSAL (SaaS) Integration 397
Send Cloud-delivered Firewall Management Center-Managed Events toSAL (SaaS) Using Syslog 397
Send Cloud-delivered Firewall Management Center-Managed Event Logs toSAL (SaaS) Using a
Direct Connection 400
ViewandWorkwith Events inCDO 401
ViewandWorkwith Events inCisco Secure Cloud Analytics 401
FTD Dashboard 403 CHAPTER 22
About theFTD Dashboard 403
ViewtheFTD Dashboard 404
FTD Dashboard Widgets 405
TopIntrusion Rules Widget 405
TopIntrusion Attackers Widget 405
TopIntrusion TargetsWidget 405
TopMalware Signatures Widget 405
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xvContents

TopMalware Senders Widget 405
TopMalware Receivers Widget 406
Malware Events byDisposition Widget 406
Network Activity Widget 406
Event Activity Widget 406
Access Control Actions Widget 406
TopAccess Control Policies Widget 406
TopAccess Control Rules Widget 406
TopDevices Widget 406
TopUsers Widget 406
TopUsers byBlocked Connections Widget 407
TopDevices with Health Alerts Widget 407
TopLoaded Devices Widget 407
TopWebApplications Widget 407
TopClient Applications Widget 407
TopBlocked WebApplications Widget 407
Modify TimeSettings fortheFTD Dashboard 407
Device Operations 409 PART VIII
Transpar entorRouted Firewall Mode 411 CHAPTER 23
About theFirewall Mode 411
About Routed Firewall Mode 411
About Transparent Firewall Mode 412
Using theTransparent Firewall inYourNetwork 412
Passing TrafficForRouted-Mode Features 412
About Bridge Groups 413
Bridge Virtual Interface (BVI) 413
Bridge Groups inTransparent Firewall Mode 413
Bridge Groups inRouted Firewall Mode 414
Allowing Layer 3Traffic 415
Allowed MAC Addresses 415
BPDU Handling 415
MAC Address vs.Route Lookups 416
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xviContents

Unsupported Features forBridge Groups inTransparent Mode 417
Unsupported Features forBridge Groups inRouted Mode 418
Default Settings 419
Guidelines forFirewall Mode 419
SettheFirewall Mode 420
Logical Devices ontheFirepower4100/9300 423 CHAPTER 24
About Interfaces 423
Chassis Management Interface 423
Interface Types 424
FXOS Interfaces vs.Application Interfaces 426
Shared Interface Scalability 428
Shared Interface Best Practices 428
Shared Interface Usage Examples 430
Viewing Shared Interface Resources 436
Inline SetLink State Propagation fortheThreat Defense 437
About Logical Devices 437
Standalone andClustered Logical Devices 438
Logical Device Application Instances: Container andNative 438
Container Instance Interfaces 438
How theChassis Classifies Packets 439
Classification Examples 439
Cascading Container Instances 443
Typical Multi-Instance Deployment 444
Automatic MAC Addresses forContainer Instance Interfaces 445
Container Instance Resource Management 446
Performance Scaling Factor forMulti-Instance Capability 446
Container Instances andHigh Availability 446
Container Instances andClustering 446
Licenses forContainer Instances 446
Requirements andPrerequisites forLogical Devices 447
Requirements andPrerequisites forHardware andSoftware Combinations 447
Requirements andPrerequisites forContainer Instances 449
Requirements andPrerequisites forHigh Availability 450
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xviiContents

Requirements andPrerequisites forClustering 450
Guidelines andLimitations forLogical Devices 454
Guidelines andLimitations forInterfaces 454
General Guidelines andLimitations 457
Configure Interfaces 457
Enable orDisable anInterface 457
Configure aPhysical Interface 458
Add anEtherChannel (Port Channel) 459
Add aVLAN Subinterface forContainer Instances 461
Configure Logical Devices 462
Add aResource Profile forContainer Instances 462
Add aStandalone Threat Defense 463
Add aStandalone Threat Defense fortheCisco Defense Orchestrator 468
Add aHigh Availability Pair 474
Change anInterface onaThreat Defense Logical Device 475
Connect totheConsole oftheApplication 477
High Availability 479 CHAPTER 25
About Secure Firewall Threat Defense High Availability 479
High Availability Support onThreat Defense Devices inaRemote Branch OfficeDeployment 480
High Availability System Requirements 480
Hardware Requirements 480
Software Requirements 481
License Requirements forThreat Defense Devices inaHigh Availability Pair 481
Failover andStateful Failover Links 481
Failover Link 481
Stateful Failover Link 483
Avoiding Interrupted Failover andData Links 483
MAC Addresses andIPAddresses inHigh Availability 485
Stateful Failover 486
Supported Features 486
Unsupported Features 488
Bridge Group Requirements forHigh Availability 488
Failover Health Monitoring 489
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xviiiContents

Unit Health Monitoring 489
Heartbeat Module Redundancy 489
Interface Monitoring 490
Failover Triggers andDetection Timing 491
About Active/Standby Failover 492
Primary/Secondary Roles andActive/Standby Status 493
Active Unit Determination atStartup 493
Failover Events 493
Config-Sync Optimization 494
Requirements andPrerequisites forHigh Availability 495
Guidelines forHigh Availability 495
Add aHigh Availability Pair 498
Configure Optional High Availability Parameters 501
Configure Standby IPAddresses andInterface Monitoring 501
Edit High Availability Failover Criteria 502
Configure Virtual MAC Addresses 502
Manage High Availability 503
Switch theActive Peer intheThreat Defense High Availability Pair 503
Refresh Node Status foraSingle Threat Defense High Availability Pair 504
Suspend andResume High Availability 504
Replace aUnit inThreat Defense High Availability Pair 505
Replace aPrimary Threat Defense HAUnit with noBackup 505
Replace aSecondary Threat Defense HAUnit with noBackup 506
Break aHigh Availability Pair 507
Remove aHigh Availability Pair 508
Monitoring High Availability 509
ViewFailover History 509
ViewStateful Failover Statistics 509
Troubleshooting High Availability Break inaRemote Branch Deployment 509
How toBreak aHigh Availability PairinActive-Active State 510
How toBreak aHigh Availability Pairwhen Active orStandby Unit hasLost Connectivity 511
How toaBreak High Availability Pairwhen theSecondary Device isinaFailed orDisabled State 513
History forHigh Availability 514
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xixContents

Clustering fortheSecur eFirewall 3100 517 CHAPTER 26
About Clustering fortheSecure Firewall 3100 517
How theCluster FitsintoYourNetwork 517
Control andData Node Roles 518
Cluster Interfaces 518
Cluster Control Link 518
Configuration Replication 518
Management Network 518
Licenses forClustering 519
Requirements andPrerequisites forClustering 519
Guidelines forClustering 520
Configure Clustering 524
About Cluster Interfaces 524
Cluster Control Link 524
Spanned EtherChannels 526
Cable andAdd Devices totheManagement Center 529
Create aCluster 531
Configure Interfaces 537
Configure Cluster Health Monitor Settings 538
Manage Cluster Nodes 542
Add aNew Cluster Node 542
Break aNode 544
Break theCluster 545
Disable Clustering 546
Rejoin theCluster 547
Change theControl Node 547
Edit theCluster Configuration 548
Reconcile Cluster Nodes 549
Delete (Unregister) theCluster orNodes andRegister toaNew Management Center 551
Monitoring theCluster 552
Cluster Health Monitor Dashboard 554
Viewing Cluster Health 555
Cluster Metrics 556
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxContents

Examples forClustering 557
Firewall onaStick 557
TrafficSegregation 558
Reference forClustering 558
Threat Defense Features andClustering 558
Unsupported Features with Clustering 558
Centralized Features forClustering 559
Connection Settings andClustering 560
FTP andClustering 560
Multicast Routing inIndividual Interface Mode 560
NATandClustering 560
Dynamic Routing 562
SIPInspection andClustering 562
SNMP andClustering 563
Syslog andClustering 563
Cisco TrustSec andClustering 563
VPN andClustering 563
Performance Scaling Factor 563
Control Node Election 564
High Availability Within theCluster 564
Node Health Monitoring 564
Interface Monitoring 565
Status After Failure 565
Rejoining theCluster 565
Data Path Connection State Replication 566
How theCluster Manages Connections 566
Connection Roles 566
New Connection Ownership 568
Sample Data Flow forTCP 568
Sample Data Flow forICMP andUDP 569
History forClustering 570
Clustering forThreatDefense Virtual inaPrivateCloud 571 CHAPTER 27
About Threat Defense Virtual Clustering inthePrivate Cloud 571
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxiContents

How theCluster FitsintoYourNetwork 571
Control andData Node Roles 572
Individual Interfaces 572
Policy-Based Routing 573
Equal-Cost Multi-Path Routing 573
Cluster Control Link 574
Cluster Control Link TrafficOverview 574
Configuration Replication 575
Management Network 575
Licenses forThreat Defense Virtual Clustering 575
Requirements andPrerequisites forThreat Defense Virtual Clustering 575
Guidelines forThreat Defense Virtual Clustering 576
Configure Threat Defense Virtual Clustering 577
Add Devices totheManagement Center 577
Create aCluster 578
Configure Interfaces 585
Configure Cluster Health Monitor Settings 586
Manage Cluster Nodes 590
Add aNew Cluster Node 590
Break aNode 592
Break theCluster 593
Disable Clustering 594
Rejoin theCluster 595
Change theControl Node 595
Edit theCluster Configuration 596
Reconcile Cluster Nodes 597
Delete theCluster orNodes from theManagement Center 599
Monitoring theCluster 599
Cluster Health Monitor Dashboard 602
Viewing Cluster Health 603
Cluster Metrics 604
Reference forClustering 605
Threat Defense Features andClustering 605
Unsupported Features andClustering 605
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxiiContents

Centralized Features forClustering 605
Connection Settings andClustering 606
Dynamic Routing andClustering 606
FTP andClustering 607
NATandClustering 607
SIPInspection andClustering 609
SNMP andClustering 609
Syslog andClustering 609
Cisco Trustsec andClustering 609
VPN andClustering 610
Performance Scaling Factor 610
Control Node Election 610
High Availability within theCluster 611
Node Health Monitoring 611
Interface Monitoring 611
Status After Failure 611
Rejoining theCluster 612
Data Path Connection State Replication 612
How theCluster Manages Connections 613
Connection Roles 613
New Connection Ownership 614
Sample Data Flow forTCP 614
Sample Data Flow forICMP andUDP 615
History forThreat Defense Virtual Clustering inaPrivate Cloud 617
Clustering forThreatDefense Virtual inaPublic Cloud 619 CHAPTER 28
About Threat Defense Virtual Clustering inthePublic Cloud 620
How theCluster FitsintoYourNetwork 620
Individual Interfaces 620
Control andData Node Roles 621
Cluster Control Link 621
Cluster Control Link TrafficOverview 622
Configuration Replication 622
Management Network 622
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxiiiContents

Licenses forThreat Defense Virtual Clustering 622
Requirements andPrerequisites forThreat Defense Virtual Clustering 623
Guidelines forThreat Defense Virtual Clustering 624
Deploy theCluster inAWS 626
AWSGateway Load Balancer andGeneve Single-Arm Proxy 626
Sample Topology 627
End-to-End Process forDeploying Threat Defense Virtual Cluster onAWS 627
Templates 629
Deploy theStack inAWSUsing aCloudFormation Template 630
Deploy theCluster inAWSManually 635
Create theDay0 Configuration forAWS 635
Deploy Cluster Nodes 639
Deploy theCluster inAzure 640
Sample Topology forGWLB-based Cluster Deployment 641
Azure Gateway Load Balancer andPaired Proxy 642
End-to-End Process forDeploying Threat Defense Virtual Cluster inAzure with GWLB 642
Templates 644
Prerequisites 644
Deploy Cluster onAzure with GWLB Using anAzure Resource Manager Template 645
Sample Topology forNLB-based Cluster Deployment 648
End-to-End Process forDeploying Threat Defense Virtual Cluster inAzure with NLB 648
Templates 650
Prerequisites 650
Deploy Cluster onAzure with NLB Using anAzure Resource Manager Template 651
Deploy theCluster inAzure Manually 653
Create theDay0 Configuration forAzure 653
Deploy Cluster Nodes Manually -GWLB-based Deployment 657
Deploy Cluster Nodes Manually -NLB-based Deployment 658
Troubleshooting Cluster Deployment inAzure 658
Deploy theCluster inGCP 659
Sample Topology 660
End-to-End Process forDeploying Threat Defense Virtual Cluster inGCP 660
Templates 662
Deploy theInstance Group inGCP Using anInstance Template 662
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxivContents

Deploy theCluster inGCP Manually 663
Create theDay0 Configuration forGCP 663
Deploy Cluster Nodes Manually 666
Allow Health Checks forGCP Network Load Balancers 666
Add theCluster totheManagement Center (Manual Deployment) 667
Configure Cluster Health Monitor Settings 673
Manage Cluster Nodes 677
Disable Clustering 678
Rejoin theCluster 678
Reconcile Cluster Nodes 678
Delete (Unregister) theCluster orNodes andRegister toaNew Management Center 679
Monitoring theCluster 680
Cluster Health Monitor Dashboard 683
Viewing Cluster Health 684
Cluster Metrics 685
Upgrading theCluster 686
Reference forClustering 686
Threat Defense Features andClustering 687
Unsupported Features andClustering 687
Centralized Features forClustering 687
Cisco Trustsec andClustering 688
Connection Settings andClustering 688
Dynamic Routing andClustering 688
FTP andClustering 689
NATandClustering 689
SIPInspection andClustering 691
SNMP andClustering 691
Syslog andClustering 691
VPN andClustering 691
Performance Scaling Factor 692
Control Node Election 692
High Availability within theCluster 692
Node Health Monitoring 693
Interface Monitoring 693
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxvContents

Status After Failure 693
Rejoining theCluster 693
Data Path Connection State Replication 694
How theCluster Manages Connections 694
Connection Roles 694
New Connection Ownership 696
Sample Data Flow forTCP 696
Sample Data Flow forICMP andUDP 697
History forThreat Defense Virtual Clustering inthePublic Cloud 698
Clustering fortheFirepower4100/9300 699 CHAPTER 29
About Clustering ontheFirepower 4100/9300 Chassis 699
Bootstrap Configuration 700
Cluster Members 700
Cluster Control Link 700
Size theCluster Control Link 701
Cluster Control Link Redundancy 701
Cluster Control Link Reliability forInter-Chassis Clustering 702
Cluster Control Link Network 702
Management Network 702
Management Interface 702
Cluster Interfaces 702
Spanned EtherChannels 702
Configuration Replication 703
Licenses forClustering 703
Requirements andPrerequisites forClustering 704
Clustering Guidelines andLimitations 707
Configure Clustering 711
FXOS: Add aThreat Defense Cluster 711
Create aThreat Defense Cluster 711
Add More Cluster Nodes 722
Management Center: Add aCluster 725
Management Center: Configure Cluster ,Data Interfaces 731
Management Center: Configure Cluster Health Monitor Settings 733
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxviContents

FXOS: Remove aCluster Node 737
Management Center: Manage Cluster Members 738
Add aNew Cluster Member 738
Replace aCluster Member 739
Deactivate aMember 740
Rejoin theCluster 741
Delete (Unregister) aData Node 741
Change theControl Unit 742
Reconcile Cluster Members 743
Management Center: Monitoring theCluster 743
Cluster Health Monitor Dashboard 745
Viewing Cluster Health 746
Cluster Metrics 748
Examples forClustering 748
Firewall onaStick 749
TrafficSegregation 750
Reference forClustering 750
Threat Defense Features andClustering 750
Unsupported Features with Clustering 750
Centralized Features forClustering 751
Connection Settings 752
Dynamic Routing andClustering 752
FTP andClustering 753
Multicast Routing andClustering 753
NATandClustering 753
SIPInspection andClustering 754
SNMP andClustering 754
Syslog andClustering 755
TLS/SSL Connections andClustering 755
Cisco TrustSec andClustering 755
VPN andClustering 755
Performance Scaling Factor 755
Control Unit Election 755
High Availability Within theCluster 756
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxviiContents

Chassis-Application Monitoring 756
Unit Health Monitoring 756
Interface Monitoring 757
Decorator Application Monitoring 757
Status After Failure 757
Rejoining theCluster 757
Data Path Connection State Replication 758
How theCluster Manages Connections 759
Connection Roles 759
New Connection Ownership 760
Sample Data Flow forTCP 760
Sample Data Flow forICMP andUDP 761
History forClustering 762
Interfaces andDevice Settings 767 PART IX
Interface Overview 769 CHAPTER 30
Management Interface 769
Management Interface 769
Diagnostic Interface 770
Interface Mode andTypes 770
Security Zones andInterface Groups 772
Auto-MDI/MDIX Feature 773
Default Settings forInterfaces 774
Create Security Zone andInterface Group Objects 774
Enable thePhysical Interface andConfigure Ethernet Settings 775
Configure EtherChannel Interfaces 777
About EtherChannels 778
About EtherChannels 778
Guidelines forEtherChannels 781
Configure anEtherChannel 782
Sync Interface Changes with theManagement Center 786
Manage theNetwork Module fortheSecure Firewall 3100 789
Configure Breakout Ports 790
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxviiiContents

Add aNetwork Module 793
HotSwap theNetwork Module 795
Replace theNetwork Module with aDifferent Type 797
Remove theNetwork Module 800
MergetheManagement andDiagnostic Interfaces 803
Unmer getheManagement Interface 809
History forInterfaces 810
Regular Firewall Interfaces 813 CHAPTER 31
Requirements andPrerequisites forRegular Firewall Interfaces 813
Configure Firepower 1010 Switch Ports 813
About Firepower 1010 Switch Ports 814
Understanding Firepower 1010 Ports andInterfaces 814
Auto-MDI/MDIX Feature 814
Guidelines andLimitations forFirepower 1010 Switch Ports 815
Configure Switch Ports andPower Over Ethernet 816
Enable orDisable Switch Port Mode 816
Configure aVLAN Interface 817
Configure Switch Ports asAccess Ports 819
Configure Switch Ports asTrunk Ports 821
Configure Power Over Ethernet 823
Configure Loopback Interfaces 824
About Loopback Interfaces 824
Guidelines andLimitations forLoopback Interfaces 825
Configure aLoopback Interface 825
Rate-Limit TraffictotheLoopback Interface 826
Configure VLAN Subinterfaces and802.1Q Trunking 830
Guidelines andLimitations forVLAN Subinterfaces 830
Maximum Number ofVLAN Subinterfaces byDevice Model 830
Add aSubinterface 831
Configure VXLAN Interfaces 833
About VXLAN Interfaces 833
Encapsulation 833
VXLAN Tunnel Endpoint 833
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxixContents

VTEP Source Interface 834
VNI Interfaces 834
VXLAN Packet Processing 835
Peer VTEPs 835
VXLAN UseCases 836
Requirements andPrerequisites forVXLAN Interfaces 840
Guidelines forVXLAN Interfaces 840
Configure VXLAN orGeneve Interfaces 841
Configure VXLAN Interfaces 841
Configure Geneve Interfaces 844
Allow Gateway Load Balancer Health Checks 845
Configure Routed andTransparent Mode Interfaces 846
About Routed andTransparent Mode Interfaces 846
Dual IPStack (IPv4 andIPv6) 847
31-Bit Subnet Mask 847
Guidelines andLimitations forRouted andTransparent Mode Interfaces 847
Configure Routed Mode Interfaces 849
Configure Bridge Group Interfaces 854
Configure General Bridge Group Member Interface Parameters 854
Configure theBridge Virtual Interface (BVI) 856
Configure IPv6 Addressing 857
About IPv6 857
Configure theIPv6 Prefix Delegation Client 858
Configure aGlobal IPv6 Address 861
Configure IPv6 Neighbor Discovery 866
Configure Advanced Interface Settings 868
About Advanced Interface Configuration 868
About MAC Addresses 868
About theMTU 870
About theTCP MSS 871
ARP Inspection forBridge Group Traffic 872
MAC Address Table 872
Default Settings 873
Guidelines forARP Inspection andtheMAC Address Table 873
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxContents

Configure theMTU 873
Configure theMAC Address 874
Add aStatic ARP Entry 875
Add aStatic MAC Address andDisable MAC Learning foraBridge Group 876
SetSecurity Configuration Parameters 876
History forRegular Firewall Interfaces forSecure Firewall Threat Defense 878
Inline Sets andPassiveInterfaces 885 CHAPTER 32
About IPSInterfaces 885
IPSInterface Types 885
About Hardware Bypass forInline Sets 886
Hardware Bypass Triggers 886
Hardware Bypass Switchover 887
Snort FailOpen vs.Hardware Bypass 887
Hardware Bypass Status 887
Requirements andPrerequisites forInline Sets 887
Guidelines forInline Sets andPassive Interfaces 889
Configure aPassive Interface 890
Configure anInline Set 892
DHCP andDDNS 895 CHAPTER 33
About DHCP andDDNS Services 895
About theDHCPv4 Server 895
DHCP Options 895
About theDHCPv6 Stateless Server 896
About theDHCP Relay Agent 896
Requirements andPrerequisites forDHCP andDDNS 897
Guidelines forDHCP andDDNS Services 897
Configure theDHCPv4 Server 898
Configure theDHCPv6 Stateless Server 900
Create theDHCP IPv6 Pool 900
Enable theDHCPv6 Stateless Server 903
Configure theDHCP Relay Agent 904
Configure Dynamic DNS 905
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxiContents

History forDHCP andDDNS 911
SNMP fortheFirepower1000/2100 913 CHAPTER 34
About SNMP fortheFirepower 1000/2100 913
Enabling SNMP andConfiguring SNMP Properties forFirepower 1000/2100 913
Creating anSNMP TrapforFirepower 1000/2100 914
Creating anSNMP User forFirepower 1000/2100 916
Quality ofService 917 CHAPTER 35
Introduction toQoS 917
About QoS Policies 917
Requirements andPrerequisites forQoS 918
Rate Limiting with QoS Policies 918
Creating aQoS Policy 919
Setting TargetDevices foraQoS Policy 920
Configuring QoS Rules 920
QoS Rule Components 921
QoS Rule Conditions 922
Interface Rule Conditions 922
Network Rule Conditions 923
User Rule Conditions 923
Application Rule Conditions 923
Port Rule Conditions 924
URL Rule Conditions 926
Custom SGT Rule Conditions 926
ISESGT vsCustom SGT Rule Conditions 926
Autotransition from Custom SGTstoISESGTs927
Platf orm Settings 929 CHAPTER 36
Introduction toPlatform Settings 930
Requirements andPrerequisites forPlatform Settings Policies 930
Manage Platform Settings Policies 930
ARP Inspection 931
Banner 932
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxiiContents

DNS 933
External Authentication 936
Fragment Settings 941
HTTP Access 942
ICMP Access 943
NetFlow 944
Add Collector inNetFlow 945
Add TrafficClass toNetFlow 945
SSH Access 946
SMTP Server 948
SNMP 948
About SNMP 950
SNMP Terminology 950
MIBs andTraps 951
Supported Tables andObjects inMIBs 951
Add SNMPv3 Users 955
Add SNMP Hosts 958
Configure SNMP Traps 959
Configure SSL Settings 961
About SSL Settings 962
Syslog 965
About Syslog 965
Severity Levels 966
Syslog Message Filtering 967
Syslog Message Classes 967
Guidelines forLogging 970
Configure Syslog Logging forThreat Defense Devices 971
Threat Defense Platform Settings That Apply toSecurity Event Syslog Messages 972
Enable Logging andConfigure Basic Settings 973
Enable Logging Destinations 974
Send Syslog Messages toanE-mail Address 975
Create aCustom Event List 976
Limit theRate ofSyslog Message Generation 977
Configure Syslog Settings 978
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxiiiContents

Configure aSyslog Server 979
Timeouts 981
TimeSynchronization 983
TimeZone 984
UCAPL/CC Compliance 985
Performance Profile 986
Netw orkAddr essTranslation 989 CHAPTER 37
Why UseNAT? 989
NATBasics 990
NATTerminology 990
NATTypes 990
NATinRouted andTransparent Mode 991
NATinRouted Mode 991
NATinTransparent Mode orWithin aBridge Group 992
Auto NATandManual NAT 993
Auto NAT 993
Manual NAT 993
Comparing Auto NATandManual NAT 994
NATRule Order 994
NATInterfaces 996
NATExemption 997
Configuring Routing forNAT 997
Addresses ontheSame Network astheMapped Interface 997
Addresses onaUnique Network 998
TheSame Address astheReal Address (Identity NAT) 998
Requirements andPrerequisites forNATPolicies 998
Guidelines forNAT 999
Firewall Mode Guidelines forNAT 999
IPv6 NATGuidelines 999
IPv6 NATBest Practices 1000
NATSupport forInspected Protocols 1000
FQDN Destination Guidelines 1002
Additional Guidelines forNAT 1003
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxivContents

Manage NATPolicies 1005
Creating NATPolicies 1005
Configuring NATPolicy Targets 1006
Configure NATforThreat Defense 1007
Customizing NATRules forMultiple Devices 1008
Searching andFiltering theNATRule Table 1010
Enabling, Disabling, orDeleting Multiple Rules 1011
Dynamic NAT 1012
About Dynamic NAT 1012
Dynamic NATDisadvantages andAdvantages 1013
Configure Dynamic Auto NAT 1014
Configure Dynamic Manual NAT 1015
Dynamic PAT 1017
About Dynamic PAT 1017
Dynamic PATDisadvantages andAdvantages 1018
PATPool Object Guidelines 1018
Configure Dynamic Auto PAT 1019
Configure Dynamic Manual PAT 1022
Configure PATwith Port Block Allocation 1025
Static NAT 1027
About Static NAT 1027
Configure Static Auto NAT 1031
Configure Static Manual NAT 1032
Identity NAT 1035
Configure Identity Auto NAT 1036
Configure Identity Manual NAT 1037
NATRule Properties forThreat Defense 1040
Interface Objects NATProperties 1040
Translation Properties forAuto NAT 1041
Translation Properties forManual NAT 1042
PATPool NATProperties 1043
Advanced NATProperties 1044
Translating IPv6 Networks 1045
NAT64/46: Translating IPv6 Addresses toIPv4 1046
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxvContents

NAT64/46 Example: Inside IPv6 Network with Outside IPv4 Internet 1046
NAT64/46 Example: Inside IPv6 Network with Outside IPv4 Internet andDNS Translation 1048
NAT66: Translating IPv6 Addresses toDifferent IPv6 Addresses 1052
NAT66Example, Static Translation between Networks 1052
NAT66Example, Simple IPv6 Interface PAT 1055
Monitoring NAT 1058
Examples forNAT 1059
Providing Access toanInside WebServer (Static Auto NAT) 1059
Dynamic Auto NATforInside Hosts andStatic NATforanOutside WebServer 1062
Inside Load Balancer with Multiple Mapped Addresses (Static Auto NAT,One-to-Many) 1066
Single Address forFTP,HTTP ,andSMTP (Static Auto NAT-with-Port-T ranslation) 1069
Different Translation Depending ontheDestination (Dynamic Manual PAT) 1074
Different Translation Depending ontheDestination Address andPort (Dynamic Manual PAT) 1079
NATandSite-to-Site VPN 1084
Rewriting DNS Queries andResponses Using NAT 1088
DNS64 Reply Modification 1089
DNS Reply Modification, DNS Server onOutside 1096
DNS Reply Modification, DNS Server onHost Network 1099
Alarms fortheCisco ISA 3000 1103 CHAPTER 38
About Alarms 1103
Alarm Input Interfaces 1104
Alarm Output Interface 1104
Syslog Alarms 1105
SNMP Alarms 1105
Defaults forAlarms 1105
Requirements andPrerequisites forAlarms 1106
Configure theAlarms fortheISA3000 1106
Configure Alarm Input Contacts 1106
Configure Power Supply Alarms 1109
Configure Temperature Alarms 1111
Monitoring Alarms 1114
Monitoring Alarm Status 1114
Monitoring Syslog Messages forAlarms 1114
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxviContents

Turning OfftheExternal Alarm 1115
Routing 1117 PART X
Static andDefault Routes 1119 CHAPTER 39
About Static andDefault Routes 1119
Default Route 1119
Static Routes 1120
Route tonull0 Interface toDrop Unwanted Traffic 1120
Route Priorities 1120
Transparent Firewall Mode andBridge Group Routes 1120
Static Route Tracking 1121
Requirements andPrerequisites forStatic Routes 1121
Guidelines forStatic andDefault Routes 1122
Add aStatic Route 1122
Reference forRouting 1124
Path Determination 1124
Supported Route Types 1124
Static Versus Dynamic 1124
Single-Path Versus Multipath 1125
FlatVersus Hierarchical 1125
Link-State Versus Distance Vector 1125
Supported Internet Protocols forRouting 1125
Routing Table 1126
How theRouting Table IsPopulated 1126
How Forwarding Decisions AreMade 1128
Dynamic Routing andHigh Availability 1129
Dynamic Routing inClustering 1129
Dynamic Routing inIndividual Interface Mode 1130
Routing Table forManagement Traffic 1131
Equal-Cost Multi-Path (ECMP) Routing 1131
About Route Maps 1132
Permit andDeny Clauses 1132
Match andSetClause Values 1132
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxviiContents

Virtual Routers 1135 CHAPTER 40
About Virtual Routers andVirtual Routing andForwarding (VRF) 1135
About Virtual Routers andDynamic VTI 1136
How toConfigure aVirtual Router with Dynamic VTI 1136
Applications ofVirtual Routers 1136
Global andUser-Defined Virtual Routers 1137
Configuring Policies tobeVirtual-Router-A ware 1138
Interconnecting Virtual Routers 1139
Overlapping IPAddresses 1140
Configuring SNMP onUser-Defined Virtual Routers 1141
Maximum Number ofVirtual Routers ByDevice Model 1142
Requirements andPrerequisites forVirtual Routers 1143
Guidelines andLimitations forVirtual Routers 1143
Modifications totheManagement Center WebInterface -Routing Page 1145
Manage Virtual Routers 1146
Create aVirtual Router 1146
Configure aVirtual Router 1146
Modify aVirtual Router 1148
Remove Virtual Routers 1149
Monitoring Virtual Routers 1149
Configuration Examples forVirtual Routers 1150
How toRoute toaDistant Server through Virtual Routers 1150
How toProvide Internet Access with Overlapping Address Spaces 1154
How toAllow RAVPN Access toInternal Networks inVirtual Routing 1161
How toSecure Trafficfrom Networks inMultiple Virtual Routers over aSite-to-Site VPN 1164
How toSecure Trafficfrom Networks with Multiple Virtual Routers over aSite-to-Site VPN with
Dynamic VTI 1167
How toRoute Trafficbetween TwoOverlapping Network Host inVirtual Routing 1169
How toManage Overlapping Segments inRouted Firewall Mode with BVI Interfaces 1172
How toConfigure User Authentication with Overlapping Networks 1176
How toInterconnect Virtual Routers using BGP 1182
ECMP 1189 CHAPTER 41
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxviiiContents

About ECMP 1189
Guidelines andLimitations forECMP 1189
Manage ECMP Page 1191
Create anECMP Zone 1191
Configure anEqual Cost Static Route 1192
Modify anECMP Zone 1193
Remove anECMP Zone 1194
Configuration Example forECMP 1194
Bidir ectional Forwarding Detection Routing 1197 CHAPTER 42
About BFD Routing 1197
Guidelines forBFD Routing 1197
Configure BFD 1198
Configure BFD Policies 1199
Configure Single-Hop BFD Policies 1199
Configure Multi-Hop BFD Policies 1200
History forBFD Routing 1201
OSPF 1203 CHAPTER 43
OSPF 1203
About OSPF 1203
OSPF Support forFast Hello Packets 1205
Prerequisites forOSPF Support forFast Hello Packets 1205
OSPF Hello Interval andDead Interval 1205
OSPF Fast Hello Packets 1205
Benefits ofOSPF Fast Hello Packets 1205
Implementation Differences Between OSPFv2 andOSPFv3 1206
Requirements andPrerequisites forOSPF 1206
Guidelines forOSPF 1206
Configure OSPFv2 1209
Configure OSPF Areas, Ranges, andVirtual Links 1209
Configure OSPF Redistribution 1212
Configure OSPF Inter-Area Filtering 1213
Configure OSPF Filter Rules 1214
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xxxixContents

Configure OSPF Summary Addresses 1215
Configure OSPF Interfaces andNeighbors 1216
Configure OSPF Advanced Properties 1218
Configure OSPFv3 1221
Configure OSPFv3 Areas, Route Summaries, andVirtual Links 1221
Configure OSPFv3 Redistribution 1223
Configure OSPFv3 Summary Prefixes 1224
Configure OSPFv3 Interfaces, Authentication, andNeighbors 1225
Configure OSPFv3 Advanced Properties 1227
History forOSPF 1230
EIGRP 1231 CHAPTER 44
About EIGRP Routing 1231
Requirements andPrerequisites forEIGRP 1232
Guidelines andLimitations ofEIGRP Routing 1232
Configure EIGRP 1234
Configure EIGRP Settings 1234
Configure EIGRP Neighbors Settings 1235
Configure EIGRP Filter Rules Settings 1235
Configure EIGRP Redistribution Settings 1236
Configure EIGRP Summary Address Settings 1237
Configure EIGRP Interfaces Settings 1237
Configure EIGRP Advanced Settings 1238
BGP 1241 CHAPTER 45
About BGP 1241
Routing Table Changes 1241
When toUseBGP 1242
BGP Path Selection 1243
BGP Multipath 1243
Requirements andPrerequisites forBGP 1244
Guidelines forBGP 1244
Configure BGP 1245
Configure BGP Basic Settings 1245
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xlContents

Configure BGP General Settings 1248
Configure BGP Neighbor Settings 1249
Configure BGP Aggregate Address Settings 1253
Configure BGPv4 Filtering Settings 1253
Configure BGP Network Settings 1254
Configure BGP Redistribution Settings 1255
Configure BGP Route Injection Settings 1256
Configure BGP Route Import/Export Settings 1256
RIP 1259 CHAPTER 46
About RIP 1259
Routing Update Process 1259
RIPRouting Metric 1260
RIPStability Features 1260
RIPTimers 1260
Requirements andPrerequisites forRIP 1261
Guidelines forRIP 1261
Configure RIP 1262
Multicast 1265 CHAPTER 47
About Multicast Routing 1265
IGMP Protocol 1265
Stub Multicast Routing 1266
PIM Multicast Routing 1266
PIM Source Specific Multicast Support 1267
Multicast Bidirectional PIM 1267
PIM Bootstrap Router (BSR) 1268
PIM Bootstrap Router (BSR) Terminology 1268
Multicast Group Concept 1269
Multicast Addresses 1269
Clustering 1269
Requirements andPrerequisites forMulticast Routing 1269
Guidelines forMulticast Routing 1269
Configure IGMP Features 1270
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xliContents

Enable Multicast Routing 1271
Configure IGMP Protocol 1271
Configure IGMP Access Groups 1273
Configure IGMP Static Groups 1273
Configure IGMP Join Groups 1274
Configure PIM Features 1275
Configure PIM Protocol 1275
Configure PIM Neighbor Filters 1276
Configure PIM Bidirectional Neighbor Filters 1277
Configure PIM Rendezvous Points 1278
Configure PIM Route Trees 1278
Configure PIM Request Filters 1279
Configure theSecure Firewall Threat Defense Device asaCandidate Bootstrap Router 1280
Configure Multicast Routes 1281
Configure Multicast Boundary Filters 1281
Policy Based Routing 1283 CHAPTER 48
About Policy Based Routing 1283
Guidelines andLimitations forPolicy Based Routing 1285
Path Monitoring 1286
Configure Path Monitoring Settings 1288
Configure Policy-Based Routing Policy 1289
Add Path Monitoring Dashboard 1292
Configuration Example forPolicy Based Routing 1292
Configuration Example forPBR with Path Monitoring 1297
Objects andCertif icates 1301 PART XI
Object Management 1303 CHAPTER 49
Introduction toObjects 1304
TheObject Manager 1306
Importing Objects 1306
Editing Objects 1309
Viewing Objects andTheir Usage 1309
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xliiContents

Filtering Objects orObject Groups 1310
Object Groups 1311
Grouping Reusable Objects 1311
Object Overrides 1312
Managing Object Overrides 1313
Allowing Object Overrides 1314
Adding Object Overrides 1314
Editing Object Overrides 1314
AAA Server 1315
Add aRADIUS Server Group 1315
RADIUS Server Group Options 1316
RADIUS Server Options 1317
Add aSingle Sign-on Server 1318
Access List 1320
Configure Extended ACL Objects 1320
Configure Standard ACL Objects 1323
Address Pools 1324
Application Filters 1324
ASPath 1325
BFD Template 1325
Cipher Suite List 1326
Creating Cipher Suite Lists 1327
Community List 1327
Extended Community 1328
DHCP IPv6 Pool 1330
Distinguished Name 1330
Creating Distinguished Name Objects 1332
DNS Server Group 1333
Creating DNS Server Group Objects 1333
External Attributes 1333
Dynamic Objects 1333
Create Dynamic Objects with Cloud-delivered Firewall Management Center 1334
Create Dynamic Objects with Cloud-delivered Firewall Management Center andOn-Premises
Cisco Secure Dynamic Attributes Connector 1336
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xliiiContents

WorkWithDynamic Objects 1337
Dynamic Object Mappings 1337
About API-Created Dynamic Objects 1338
Security Group Tag 1339
Creating Security Group TagObjects 1339
FileList 1339
Source Files forFileLists 1340
Adding Individual SHA-256 Values toFileLists 1341
Uploading Individual Files toFileLists 1341
Uploading Source Files toFileLists 1342
Editing SHA-256 Values inFileLists 1343
Downloading Source Files from FileLists 1343
FlexConfig 1344
Geolocation 1345
Creating Geolocation Objects 1345
Interface 1345
Key Chain 1346
Creating Key Chain Objects 1346
Network 1348
Network Wildcard Mask 1349
Creating Network Objects 1350
Importing Network Objects 1351
Editing andDeleting Network Objects andGroups 1351
PKI 1351
Internal Certificate Authority Objects 1352
CACertificate andPrivate Key Import 1353
Importing aCACertificate andPrivate Key 1353
Generating aNew CACertificate andPrivate Key 1354
New Signed Certificates 1354
Creating anUnsigned CACertificate andCSR 1354
Uploading aSigned Certificate Issued inResponse toaCSR 1355
CACertificate andPrivate Key Downloads 1355
Downloading aCACertificate andPrivate Key 1355
Trusted Certificate Authority Objects 1356
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xlivContents

Trusted CAObject 1356
Adding aTrusted CAObject 1357
Certificate Revocation Lists inTrusted CAObjects 1357
Adding aCertificate Revocation ListtoaTrusted CAObject 1357
External Certificate Objects 1358
Adding External Certificate Objects 1358
Internal Certificate Objects 1359
Adding Internal Certificate Objects 1359
Certificate Enrollment Objects 1360
Adding Certificate Enrollment Objects 1361
Add Certificate Enrollment 1363
Certificate Enrollment Object EST Options 1363
Certificate Enrollment Object SCEP Options 1364
Certificate Enrollment Object Certificate Parameters 1365
Certificate Enrollment Object Key Options 1366
Certificate Enrollment Object Revocation Options 1367
Policy List 1368
Port 1369
Creating Port Objects 1370
Importing Port Objects 1371
Prefix List 1371
Configure IPv6 Prefix List 1371
Configure IPv4 Prefix List 1372
Route Map 1372
Security Intelligence 1376
How toModify Security Intelligence Objects 1377
Global andDomain Security Intelligence Lists 1378
Security Intelligence Lists andMultitenancy 1378
Delete Entries from Global Security Intelligence Lists 1379
ListandFeed Updates forSecurity Intelligence 1380
Changing theUpdate Frequency forSecurity Intelligence Feeds 1380
Custom Security Intelligence Lists andFeeds 1380
Custom Lists andFeeds: Requirements 1380
URL Lists andFeeds: URL Syntax andMatching Criteria 1381
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xlvContents

Custom Security Intelligence Feeds 1382
Custom Security Intelligence Lists 1384
Sinkhole 1386
Creating Sinkhole Objects 1386
SLA Monitor 1386
TimeRange 1388
Creating TimeRange Objects 1388
TimeZone 1389
Tunnel Zone 1390
URL 1390
Creating URL Objects 1391
Variable Set 1391
Variable Sets inIntrusion Policies 1393
Variables 1393
Predefined Default Variables 1394
Network Variables 1396
Port Variables 1397
Advanced Variables 1398
Variable Reset 1398
Adding Variables toSets 1399
Nesting Variables 1401
Managing Variable Sets 1402
Creating Variable Sets 1403
Managing Variables 1403
Adding Variables 1404
Editing Variables 1405
VLAN Tag 1406
Creating VLAN TagObjects 1406
VPN 1407
Certificate Map Objects 1407
Secure Client Custom Attributes Objects 1408
Add Secure Client Custom Attributes Objects 1409
Add Custom Attributes toaGroup Policy 1410
Threat Defense Group Policy Objects 1410
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xlviContents

Configure Group Policy Objects 1411
Group Policy General Options 1412
Group Policy Secure Client Options 1414
Group Policy Advanced Options 1417
Threat Defense IPsec Proposals 1418
Configure IKEv1 IPsec Proposal Objects 1418
Configure IKEv2 IPsec Proposal Objects 1419
Threat Defense IKE Policies 1420
Configure IKEv1 Policy Objects 1420
Configure IKEv2 Policy Objects 1421
Secure Client Customization 1423
FileObjects 1423
Certif icates 1427 CHAPTER 50
Requirements andPrerequisites forCertificates 1427
Secure Firewall Threat Defense VPN Certificate Guidelines andLimitations 1427
Managing Threat Defense Certificates 1428
Automatically Update CABundles 1429
Installing aCertificate Using Self-Signed Enrollment 1431
Installing aCertificate using EST Enrollment 1432
Installing aCertificate Using SCEP Enrollment 1433
Installing aCertificate Using Manual Enrollment 1433
Installing aCertificate Using aPKCS12 File 1434
Troubleshooting Threat Defense Certificates 1435
History forCertificates 1436
VPN 1437 PART XII
VPN Overview 1439 CHAPTER 51
VPN Types 1439
VPN Basics 1440
Internet Key Exchange (IKE) 1440
IPsec 1441
VPN Packet Flow 1442
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xlviiContents

IPsec Flow Offload 1442
VPN Licensing 1443
How Secure Should aVPN Connection Be? 1443
Complying with Security Certification Requirements 1444
Deciding Which Encryption Algorithm toUse 1444
Deciding Which Hash Algorithms toUse 1445
Deciding Which Diffie-Hellman Modulus Group toUse 1445
Deciding Which Authentication Method toUse 1446
Pre-shared Keys 1446
PKIInfrastructure andDigital Certificates 1446
Removed orDeprecated Hash Algorithms, Encryption Algorithms, andDiffie-Hellman Modulus
Groups 1448
VPN Topology Options 1448
Point-to-Point VPN Topology 1449
Hub andSpoke VPN Topology 1449
FullMesh VPN Topology 1450
Implicit Topologies 1451
Site-to-Site VPNs 1453 CHAPTER 52
About Site-to-Site VPN 1453
Secure Firewall Threat Defense Site-to-site VPN Guidelines andLimitations 1455
Types ofSite-to-Site VPN Topologies 1455
Requirements andPrerequisites forSite-to-Site VPN 1456
Manage SitetoSiteVPNs 1457
Configure aPolicy-based Site-to-Site VPN 1458
Threat Defense VPN Endpoint Options 1459
Threat Defense VPN IKE Options 1462
Threat Defense VPN IPsec Options 1465
Threat Defense Advanced Site-to-site VPN Deployment Options 1467
Threat Defense VPN Advanced IKE Options 1467
Threat Defense VPN Advanced IPsec Options 1468
Threat Defense Advanced Site-to-site VPN Tunnel Options 1468
About Virtual Tunnel Interfaces 1469
Static VTI 1470
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xlviiiContents

Dynamic VTI 1471
Guidelines andLimitations forVirtual Tunnel Interfaces 1473
Add aVTI Interface 1477
Create aRoute-based Site-to-Site VPN 1478
Configure Endpoints foraPoint toPoint Topology 1479
Advanced Configurations foraPoint toPoint Topology inaRoute-based VPN 1481
Configure Endpoints foraHub andSpoke Topology 1482
Advanced Configurations forHub andSpokes inaRoute-based VPN 1484
Configure Multiple Hubs inaRoute-based VPN 1485
Configure Routing forMultiple Hubs inaRoute-based VPN 1487
Verify theMultiple Hubs Configuration inaRoute-based VPN 1489
Route TrafficThrough aBackup VTI Tunnel 1489
Configure Dynamic VTI foraRoute-based Site-to-Site VPN 1490
How toConfigure aVirtual Router with Dynamic VTI 1491
Configure Routing andACPolicies forVTI 1491
Deploy aSASE Tunnel onUmbrella 1494
Guidelines andLimitations forConfiguring SASE Tunnels onUmbrella 1495
How toDeploy aSASE Tunnel onUmbrella 1496
Prerequisites forConfiguring Umbrella SASE Tunnels 1496
Map Management Center Umbrella Parameters andCisco Umbrella APIKeys 1497
Configure aSASE Tunnel forUmbrella 1498
ViewSASE Tunnel Status 1500
Monitoring theSite-to-Site VPNs 1501
History forSite-to-Site VPN 1507
Remote Access VPN 1509 CHAPTER 53
Remote Access VPN Overview 1509
Remote Access VPN Features 1510
Secure Client Components 1512
Remote Access VPN Authentication 1512
Understanding Policy Enforcement ofPermissions andAttributes 1514
Understanding AAA Server Connectivity 1514
License Requirements forRemote Access VPN 1515
Requirements andPrerequisites forRemote Access VPN 1515
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
xlixContents

Remote Access VPN Guidelines andLimitations 1516
Configuring aNew Remote Access VPN Connection 1519
Prerequisites forConfiguring Remote Access VPN 1519
Create aNew Remote Access VPN Policy 1520
Update theAccess Control Policy ontheSecure Firewall Threat Defense Device 1522
(Optional) Configure NATExemption 1523
Configure DNS 1524
Add Secure Client Profile XML File 1524
(Optional) Configure Split Tunneling 1525
(Optional) Configure Dynamic Split Tunneling 1526
Verify Dynamic Split Tunneling Configuration 1527
Verify theConfiguration 1527
Create aCopy ofanExisting Remote Access VPN Policy 1527
SetTargetDevices foraRemote Access VPN Policy 1528
Associate Local Realm with Remote Access VPN Policy 1528
Additional Remote Access VPN Configurations 1529
Configure Connection Profile Settings 1529
Configure IPAddresses forVPN Clients 1530
Configure AAA Settings forRemote Access VPN 1531
Create orUpdate Aliases foraConnection Profile 1546
Configure Access Interfaces forRemote Access VPN 1547
Configure Advanced Options forRemote Access VPN 1549
Cisco Secure Client Image 1549
Remote Access VPN Address Assignment Policy 1551
Configure Certificate toConnection Profile Mapping 1552
Configure Group Policies 1552
Configuring LDAP Attribute Mapping 1553
Configuring VPN Load Balancing 1555
Configure IPsec Settings 1558
Customize Cisco Secure Client 1563
Configure Secure Client Management VPN Tunnel 1573
Requirements andPrerequisites forSecure Client Management VPN Tunnel 1573
Limitations ofSecure Client Management VPN Tunnel 1574
Configuring Secure Client Management VPN Tunnel onThreat Defense 1574
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lContents

Multiple Certificate Authentication 1576
Guidelines andLimitations ofMultiple Certificate Authentication 1576
Configuring Multiple Certificate Authentication 1577
Customizing Remote Access VPN AAA Settings 1578
Authenticate VPN Users viaClient Certificates 1578
Configure VPN User Authentication viaClient Certificate andAAA Server 1579
Manage Password Changes over VPN Sessions 1581
Send Accounting Records totheRADIUS Server 1582
Delegating Group Policy Selection toAuthorization Server 1582
Override theSelection ofGroup Policy orOther Attributes bytheAuthorization Server 1583
Deny VPN Access toaUser Group 1584
Restrict Connection Profile Selection foraUser Group 1585
Update theSecure Client Profile forRemote Access VPN Clients 1586
RADIUS Dynamic Authorization 1586
Configuring RADIUS Dynamic Authorization 1587
Two-Factor Authentication 1588
Configuring RSA Two-Factor Authentication 1588
Configuring Duo Two-Factor Authentication 1589
Secondary Authentication 1591
Configure Remote Access VPN Secondary Authentication 1591
Single Sign-On Authentication with SAML 2.0 1593
Guidelines andLimitations forSAML 2.0 1594
Configuring aSAML Single Sign-On Authentication 1595
Configuring SAML Authorization 1596
Advanced Secure Client Configurations 1597
Configure Secure Client Modules onaThreat Defense 1597
Types ofSecure Client Modules 1598
Prerequisites forConfiguring Secure Client Modules 1599
Guidelines forConfiguring Secure Client Modules 1600
Install Secure Client Modules using aThreat Defense 1601
Configure aRemote Access VPN Group Policy with Secure Client Modules 1601
Verify Secure Client Modules Configuration 1602
Configure Application-Based (Per App VPN) Remote Access VPN onMobile Devices 1603
Prerequisites andLicensing forConfiguring PerApp VPN Tunnels 1603
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
liContents

Determine theApplication IDsforMobile Applications 1603
Configure Application-Based VPN Tunnels 1604
Verify PerApp Configuration 1606
Remote Access VPN Examples 1606
How toLimit Secure Client Bandwidth PerUser 1606
How toUseVPN Identity forUser-Id Based Access Control Rules 1607
Configure Threat Defense Multiple Certificate Authentication 1607
Dynamic Access Policies 1613 CHAPTER 54
About Secure Firewall Threat Defense Dynamic Access Policy 1613
Hierarchy ofPolicy Enforcement ofPermissions andAttributes inThreat Defense 1613
Licensing forDynamic Access Policies 1615
Prerequisites forDynamic Access Policy 1615
Guidelines andLimitations forDynamic Access Policies 1616
Configure aDynamic Access Policy (DAP) 1616
Create aDynamic Access Policy 1616
Create aDynamic Access Policy Record 1616
Configure AAA Criteria Settings forDAP 1617
Configure Endpoint Attribute Selection Criteria inDAP 1618
Add anAnti-Malware Endpoint Attribute toaDAP 1619
Add aDevice Endpoint Attribute toaDAP 1619
Add Secure Client Endpoint Attributes toaDAP 1620
Add NAC Endpoint Attributes toaDAP 1620
Add anApplication Attribute toaDAP 1620
Add aPersonal Firewall Endpoint Attribute toaDAP 1621
Add anOperating System Endpoint Attribute toaDAP 1621
Add aProcess Endpoint Attribute toaDAP 1621
Add aRegistry Endpoint Attribute toaDAP 1622
Add aFileEndpoint Attribute toaDAP 1622
Add Certificate Authentication Attributes toaDAP 1622
Configure Advanced Settings forDAP 1623
Associate Dynamic Access Policy with Remote Access VPN 1623
History forDynamic Access Policy 1624
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
liiContents

VPN Monitoring andTroubleshooting inCDO 1625 CHAPTER 55
Monitor Remote Access VPN Sessions 1625
SD-W ANSummary Dashboard 1625
Prerequisites forUsing SD-W ANSummary Dashboard 1626
Monitor WANDevices andInterfaces Using theSD-W ANSummary Dashboard 1627
Monitor Application Performance Metrics ofWANInterfaces Using theSD-W ANSummary
Dashboard 1628
System Messages 1629
Debug Commands 1629
debug aaa 1630
debug crypto 1631
debug crypto ca 1632
debug crypto ikev1 1633
debug crypto ikev2 1633
debug crypto ipsec 1634
debug ldap 1634
debug ssl 1634
debug webvpn 1635
Access Contr ol 1639 PART XIII
Access Contr olOverview 1641 CHAPTER 56
Introduction toAccess Control 1641
Introduction toRules 1642
Filtering Rules byDevice 1642
Rule andOther Policy Warnings 1643
Access Control Policy Default Action 1644
Deep Inspection Using FileandIntrusion Policies 1646
Access Control TrafficHandling with Intrusion andFilePolicies 1647
FileandIntrusion Inspection Order 1648
Access Control Policy Inheritance 1649
Best Practices forApplication Control 1650
Recommendations forApplication Control 1650
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
liiiContents

Best Practices forConfiguring Application Control 1652
Application Characteristics 1653
Application-Specific Notes andLimitations 1654
Best Practices forAccess Control Rules 1655
General Best Practices forAccess Control 1655
Best Practices forOrdering Rules 1656
Rule Preemption 1657
Rule Actions andRule Order 1658
Application Rule Order 1659
URL Rule Order 1659
Best Practices forSimplifying andFocusing Rules 1659
Maximum Number ofAccess Control Rules andIntrusion Policies 1660
Access Contr olPolicies 1661 CHAPTER 57
Access Control Policy Components 1661
System-Created Access Control Policies 1662
Requirements andPrerequisites forAccess Control Policies 1662
Managing Access Control Policies 1663
Creating aBasic Access Control Policy 1664
Editing anAccess Control Policy 1665
Locking anAccess Control Policy 1666
Managing Access Control Policy Inheritance 1668
Choosing aBase Access Control Policy 1668
Inheriting Access Control Policy Settings from theBase Policy 1669
Locking Settings inDescendant Access Control Policies 1669
Requiring anAccess Control Policy inaDomain 1670
Setting TargetDevices foranAccess Control Policy 1670
Logging Settings forAccess Control Policies 1671
Access Control Policy Advanced Settings 1672
Associating Other Policies with Access Control 1676
Viewing Rule HitCounts 1677
Analyzing Rule Conflicts andWarnings 1679
Searching forRules 1680
History forAccess Control Policies 1682
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
livContents

Access Contr olRules 1685 CHAPTER 58
Introduction toAccess Control Rules 1685
Access Control Rule Management 1687
Access Control Rule Components 1688
Access Control Rule Order 1689
Access Control Rule Actions 1690
Access Control Rule Monitor Action 1690
Access Control Rule TrustAction 1690
Access Control Rule Blocking Actions 1691
Access Control Rule Interactive Blocking Actions 1691
Access Control Rule Allow Action 1692
Requirements andPrerequisites forAccess Control Rules 1693
Guidelines andLimitations forAccess Control Rules 1694
Managing Access Control Rules 1695
Adding anAccess Control Rule Category 1695
Create andEdit Access Control Rules 1695
Access Control Rule Conditions 1697
Enabling andDisabling Access Control Rules 1705
Copying Access Control Rules from One Access Control Policy toAnother 1706
Moving Access Control Rules toaPrefilter Policy 1706
Positioning anAccess Control Rule 1708
Adding Comments toanAccess Control Rule 1709
Examples forAccess Control Rules 1709
How toControl Access Using Security Zones 1710
How toControl Application Usage 1710
How toBlock Threats 1711
How toBlock QUIC Traffic 1714
Cisco Secur eDynamic Attrib utes Connector 1717 CHAPTER 59
About theCisco Secure Dynamic Attributes Connector 1717
How ItWorks 1718
About theDashboard 1719
Dashboard ofanUnconfigured System 1720
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lvContents

Dashboard ofaConfigured System 1721
Add, Edit, orDelete Connectors 1723
Add, Edit, orDelete Dynamic Attributes Filters 1724
Create aConnector 1725
Amazon WebServices Connector—About User Permissions andImported Data 1726
Create anAWSUser with Minimal Permissions fortheCisco Secure Dynamic Attributes
Connector 1726
Create anAWSConnector 1728
Azure Connector—About User Permissions andImported Data 1729
Create anAzure User with Minimal Permissions fortheCisco Secure Dynamic Attributes
Connector 1729
Create anAzure Connector 1731
Create anAzure Service TagsConnector 1732
Create aMulticloud Defense Connector 1733
Create aGitHub Connector 1735
Google Cloud Connector—About User Permissions andImported Data 1735
Create aGoogle Cloud User with Minimal Permissions fortheCisco Secure Dynamic Attributes
Connector 1736
Create aGoogle Cloud Connector 1737
Create anOffice365Connector 1738
Create aWebex Connector 1739
Create aZoom Connector 1740
Create anAdapter 1740
How toCreate anOn-Prem Firewall Management Center Adapter 1741
How toCreate aCloud-delivered Firewall Management Center Adapter 1741
Create Dynamic Attributes Filters 1742
Dynamic Attribute Filter Examples 1744
UseDynamic Objects inAccess Control Policies 1744
About Dynamic Objects inAccess Control Rules 1745
Create Access Control Rules Using Dynamic Attributes Filters 1745
Troubleshoot theDynamic Attributes Connector 1746
Troubleshoot Error Messages 1746
GetYourTenant ID 1747
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lviContents

URL Filtering 1749 CHAPTER 60
URL Filtering Overview 1749
About URL Filtering with Category andReputation 1749
URL Category andReputation Descriptions 1750
URL Filtering Data from theCisco Cloud 1751
Best Practices forURL Filtering 1751
Filtering HTTPS Traffic 1754
UseCategories inURL Filtering 1755
License Requirements forURL Filtering 1756
Requirements andPrerequisites forURL Filtering 1756
How toConfigure URL Filtering with Category andReputation 1757
Enable URL Filtering Using Category andReputation 1758
URL Filtering Options 1758
Configuring URL Conditions 1760
Rules with URL Conditions 1761
URL Rule Order 1762
DNS Filtering: Identify URL Reputation andCategory During DNS Lookup 1762
Enable DNS Filtering toIdentify URLs During Domain Lookup 1762
DNS Filtering Limitations 1763
DNS Filtering andEvents 1763
Manual URL Filtering 1763
Manual URL Filtering Options 1764
Supplement orSelectively Override Category andReputation-Based URL Filtering 1764
Configure HTTP Response Pages 1765
Limitations toHTTP Response Pages 1765
Requirements andPrerequisites forHTTP Response Pages 1766
Choosing HTTP Response Pages 1766
Configure Interactive Blocking with HTTP Response Pages 1767
Configuring Interactive Blocking 1767
Setting theUser Bypass Timeout foraBlocked Website 1768
Configure URL Filtering Health Monitors 1769
Dispute URL Category andReputation 1769
IftheURL Category SetChanges, TakeAction 1770
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lviiContents

URL Category andReputation Changes: EffectonEvents 1771
Troubleshoot URL Filtering 1771
Security Intelligence 1775 CHAPTER 61
About Security Intelligence 1775
Best Practices forSecurity Intelligence 1776
License Requirements forSecurity Intelligence 1776
Requirements andPrerequisites forSecurity Intelligence 1777
Security Intelligence Sources 1777
Configure Security Intelligence 1778
Security Intelligence Options 1780
Security Intelligence Categories 1781
Block ListIcons 1783
Configuration Example: Security Intelligence Blocking 1783
Security Intelligence Monitoring 1784
Override Security Intelligence Blocking 1784
Troubleshooting Security Intelligence 1785
Security Intelligence Categories AreMissing from theAvailable Options List 1785
DNS Policies 1787 CHAPTER 62
DNS Policy Overview 1787
Cisco Umbrella DNS Policies 1788
DNS Policy Components 1788
License Requirements forDNS Policies 1789
Requirements andPrerequisites forDNS Policies 1789
Managing DNS andUmbrella DNS Policies 1790
Creating Basic DNS Policies 1790
Editing DNS Policies 1791
DNS Rules 1792
Creating andEditing DNS Rules 1792
DNS Rule Management 1793
Enabling andDisabling DNS Rules 1793
DNS Rule Order Evaluation 1794
DNS Rule Actions 1794
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lviiiContents

DNS Rule Conditions 1795
Security Zone Rule Conditions 1795
Network Rule Conditions 1796
VLAN TagsRule Conditions 1796
DNS Rule Conditions 1797
How toCreate DNS Rules 1797
Controlling TrafficBased onDNS andSecurity Zone 1797
Controlling TrafficBased onDNS andNetwork 1798
Controlling TrafficBased onDNS andVLAN 1798
Controlling TrafficBased onDNS ListorFeed 1799
DNS Policy Deploy 1799
Cisco Umbrella DNS Policies 1800
How toRedirect DNS Requests toCisco Umbrella 1800
Prerequisites forConfiguring theUmbrella DNS Connector 1801
Configure Cisco Umbrella Connection Settings 1802
Create anUmbrella DNS Policy 1803
Edit Umbrella DNS Policies andRules 1803
Associate theUmbrella DNS Policy with anAccess Control Policy 1804
Prefiltering andPrefilter Policies 1805 CHAPTER 63
About Prefiltering 1805
About Prefilter Policies 1805
Tunnel vsPrefilter Rules 1806
Prefiltering vsAccess Control 1807
Passthrough Tunnels andAccess Control 1809
Best Practices forFastpath Prefiltering 1810
Best Practices forEncapsulated TrafficHandling 1810
Requirements andPrerequisites forPrefilter Policies 1811
Configure Prefiltering 1812
Tunnel andPrefilter Rule Components 1813
Prefilter Rule Conditions 1815
Interface Rule Conditions 1815
Network Rule Conditions 1815
VLAN TagsRule Conditions 1816
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lixContents

Port Rule Conditions forPrefilter Rules 1816
TimeandDay Rule Conditions 1817
Tunnel Rule Conditions 1817
Encapsulation Rule Conditions 1817
Tunnel Zones andPrefiltering 1818
Using Tunnel Zones 1818
Creating Tunnel Zones 1820
Moving Prefilter Rules toanAccess Control Policy 1821
Prefilter Policy HitCounts 1822
LargeFlow Offloads 1823
Flow Offload Limitations 1824
Service Policies 1827 CHAPTER 64
About Threat Defense Service Policies 1827
How Service Policies Relate toFlexConfig andOther Features 1828
What AreConnection Settings? 1828
Requirements andPrerequisites forService Policies 1829
Guidelines andLimitations forService Policies 1829
Configure Threat Defense Service Policies 1830
Configure aService Policy Rule 1830
Bypass TCP State Checks forAsymetrical Routing (TCP State Bypass) 1833
TheAsymetrical Routing Problem 1833
Guidelines andLimitations forTCP State Bypass 1834
Configure TCP State Bypass 1835
Disable TCP Sequence Randomization 1837
Examples forService Policy Rules 1838
Protect Servers from aSYN Flood DoS Attack (TCP Intercept) 1838
Make theThreat Defense Device Appear onTraceroutes 1841
Monitoring Service Policies 1842
Intelligent Application Bypass 1845 CHAPTER 65
Introduction toIAB 1845
IAB Options 1846
Requirements andPrerequisites forIntelligent Application Bypass 1848
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxContents

Configuring Intelligent Application Bypass 1848
IAB Logging andAnalysis 1849
Content Restriction 1853 CHAPTER 66
About Content Restriction 1853
Requirements andPrerequisites forContent Restriction 1854
Guidelines andLimitations forContent Restriction 1855
Using Access Control Rules toEnforce Content Restriction 1855
Safe Search Options forAccess Control Rules 1856
Using aDNS Sinkhole toEnforce Content Restriction 1856
ZeroTrust Access 1859 CHAPTER 67
About Zero TrustAccess 1859
How Threat Defense Works with Zero TrustAccess 1860
Why UseZero TrustAccess? 1861
Components ofaZero TrustAccess Configuration 1861
Zero TrustAccess Workflow 1862
Limitations forZero TrustAccess 1863
Prerequisites forZero TrustApplication Policy 1864
Manage Zero TrustApplication Policies 1864
Create aZero TrustApplication Policy 1865
Create anApplication Group 1866
Create anApplication 1867
SetTargeted Devices forZero TrustAccess Policy 1869
Edit aZero TrustApplication Policy 1870
Monitor Zero TrustSessions 1871
History forZero TrustAccess 1872
Intrusion Detection andPrevention 1873 PART XIV
Netw orkAnalysis andIntrusion Policies Overview 1875 CHAPTER 68
Network Analysis andIntrusion Policy Basics 1875
How Policies Examine TrafficForIntrusions 1876
Decoding, Normalizing, andPreprocessing: Network Analysis Policies 1877
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxiContents

Access Control Rules: Intrusion Policy Selection 1878
Intrusion Inspection: Intrusion Policies, Rules, andVariable Sets 1879
Intrusion Event Generation 1880
System-Provided andCustom Network Analysis andIntrusion Policies 1881
System-Provided Network Analysis andIntrusion Policies 1881
Benefits ofCustom Network Analysis andIntrusion Policies 1883
Benefits ofCustom Network Analysis Policies 1883
Benefits ofCustom Intrusion Policies 1884
Limitations ofCustom Policies 1885
License Requirements forNetwork Analysis andIntrusion Policies 1887
Requirements andPrerequisites forNetwork Analysis andIntrusion Policies 1887
TheNavigation Panel: Network Analysis andIntrusion Policies 1887
Conflicts andChanges: Network Analysis andIntrusion Policies 1889
Exiting aNetwork Analysis orIntrusion Policy 1890
Getting Started with Intrusion Policies 1891 CHAPTER 69
Intrusion Policy Basics 1891
License Requirements forIntrusion Policies 1892
Requirements andPrerequisites forIntrusion Policies 1893
Managing Intrusion Policies 1893
Custom Intrusion Policy Creation 1894
Creating aCustom Snort 2Intrusion Policy 1894
Editing Snort 2Intrusion Policies 1895
Intrusion Policy Changes 1896
Access Control Rule Configuration toPerform Intrusion Prevention 1896
Access Control Rule Configuration andIntrusion Policies 1897
Configuring anAccess Control Rule toPerform Intrusion Prevention 1897
Drop Behavior inanInline Deployment 1897
Setting Drop Behavior inanInline Deployment 1898
Drop Behavior inaDual System Deployment 1898
Intrusion Policy Advanced Settings 1899
Optimizing Performance forIntrusion Detection andPrevention 1900
Tuning Intrusion Policies Using Rules 1901 CHAPTER 70
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxiiContents

Intrusion Rule Tuning Basics 1901
Intrusion Rule Types 1901
License Requirements forIntrusion Rules 1902
Requirements andPrerequisites forIntrusion Rules 1903
Viewing Intrusion Rules inanIntrusion Policy 1903
Intrusion Rules Page Columns 1903
Intrusion Rule Details 1904
Viewing Intrusion Rule Details 1905
Setting aThreshold foranIntrusion Rule 1906
Setting Suppression foranIntrusion Rule 1906
Setting aDynamic Rule State from theRule Details Page 1907
Setting anSNMP Alert foranIntrusion Rule 1907
Adding aComment toanIntrusion Rule 1908
Intrusion Rule Filters inanIntrusion Policy 1908
Intrusion Rule Filters Notes 1908
Intrusion Policy Rule Filters Construction Guidelines 1909
Intrusion Rule Configuration Filters 1911
Intrusion Rule Content Filters 1911
Intrusion Rule Categories 1912
Intrusion Rule Filter Components 1913
Intrusion Rule Filter Usage 1914
Setting aRule Filter inanIntrusion Policy 1914
Intrusion Rule States 1915
Intrusion Rule State Options 1915
Setting Intrusion Rule States 1916
Intrusion Event Notification Filters inanIntrusion Policy 1916
Intrusion Event Thresholds 1917
Intrusion Event Thresholds Configuration 1917
Adding andModifying Intrusion Event Thresholds 1918
Viewing andDeleting Intrusion Event Thresholds 1919
Intrusion Policy Suppression Configuration 1920
Intrusion Policy Suppression Types 1920
Suppressing Intrusion Events foraSpecific Rule 1920
Viewing andDeleting Suppression Conditions 1921
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxiiiContents

Dynamic Intrusion Rule States 1922
Dynamic Intrusion Rule State Configuration 1923
Setting aDynamic Rule State from theRules Page 1923
Adding Intrusion Rule Comments 1925
Custom Intrusion Rules 1927 CHAPTER 71
Custom Intrusion Rules Overview 1927
License Requirements fortheIntrusion Rule Editor 1928
Requirements andPrerequisites fortheIntrusion Rule Editor 1928
Rule Anatomy 1928
TheIntrusion Rule Header 1929
Intrusion Rule Header Action 1930
Intrusion Rule Header Protocol 1930
Intrusion Rule Header Direction 1931
Intrusion Rule Header Source andDestination IPAddresses 1931
Intrusion Rule Header Source andDestination Ports 1934
Intrusion Event Details 1935
Adding aCustom Classification 1938
Defining anEvent Priority 1939
Defining anEvent Reference 1939
Custom Rule Creation 1939
Writing New Rules 1940
Modifying Existing Rules 1941
Adding Comments toIntrusion Rules 1942
Deleting Custom Rules 1943
Searching forRules 1943
Search Criteria forIntrusion Rules 1944
Rule Filtering ontheIntrusion Rules Editor Page 1945
Filtering Guidelines 1945
Keyword Filtering 1945
Character String Filtering 1947
Combination Keyword andCharacter String Filtering 1947
Filtering Rules 1947
Keywords andArguments inIntrusion Rules 1948
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxivContents

Thecontent andprotected_content Keywords 1948
Basic content andprotected_content Keyword Arguments 1950
content andprotected_content Keyword Search Locations 1951
Overview: HTTP content andprotected_content Keyword Arguments 1953
Overview: content Keyword Fast Pattern Matcher 1957
Thereplace Keyword 1959
Thebyte_jump Keyword 1960
Thebyte_test Keyword 1963
Thebyte_extract Keyword 1965
Thebyte_math Keyword 1968
Overview: Thepcre Keyword 1970
pcre Syntax 1971
pcre Modifier Options 1973
pcre Example Keyword Values 1976
Themetadata Keyword 1978
Service Metadata 1979
Metadata Search Guidelines 1984
IPHeader Values 1985
ICMP Header Values 1987
TCP Header Values andStream Size 1988
Thestream_reassembly Keyword 1992
SSL Keywords 1992
Theappid Keyword 1994
Application Layer Protocol Values 1995
TheRPC Keyword 1995
TheASN.1 Keyword 1995
Theurilen Keyword 1996
DCE/RPC Keywords 1997
SIPKeywords 2000
GTP Keywords 2002
SCADA Keywords 2014
Modbus Keywords 2014
DNP3 Keywords 2015
CIPandENIP Keywords 2018
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxvContents

S7Commplus Keywords 2019
Packet Characteristics 2020
Active Response Keywords 2022
Theresp Keyword 2022
Thereact Keyword 2023
Thedetection_filter Keyword 2024
ThetagKeyword 2025
Theflowbits Keyword 2026
flowbits Keyword Options 2026
Guidelines forUsing theflowbits Keyword 2028
flowbits Keyword Examples 2028
Thehttp_encode Keyword 2033
http_encode Keyword Syntax 2034
http_encode Keyword example: Using Twohttp_endcode Keywords toSearch forTwo
Encodings 2034
Overview: Thefile_type andfile_group Keywords 2034
Thefile_type andfile_group Keywords 2035
Thefile_data Keyword 2036
Thepkt_data Keyword 2037
Thebase64_decode andbase64_data Keywords 2037
LayersinIntrusion andNetw orkAnalysis Policies 2039 CHAPTER 72
Layer Basics 2039
License Requirements forNetwork Analysis andIntrusion Policy Layers 2039
Requirements andPrerequisites forNetwork Analysis andIntrusion Policy Layers 2040
TheLayer Stack 2040
TheBase Layer 2041
System-Provided Base Policies 2041
Custom Base Policies 2041
TheEffectofRule Updates onBase Policies 2042
Changing theBase Policy 2043
TheCisco Recommendations Layer 2043
Layer Management 2044
Shared Layers 2045
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxviContents

Managing Layers 2046
Navigating Layers 2047
Intrusion Rules inLayers 2047
Configuring Intrusion Rules inLayers 2048
Removing Rule Settings from Multiple Layers 2049
Accepting Rule Changes from aCustom Base Policy 2050
Preprocessors andAdvanced Settings inLayers 2051
Configuring Preprocessors andAdvanced Settings inLayers 2052
Tailoring Intrusion Protection toYourNetw orkAssets 2053 CHAPTER 73
About Cisco Recommended Rules 2053
Default Settings forCisco Recommendations 2054
Advanced Settings forCisco Recommendations 2055
Generating andApplying Cisco Recommendations 2056
Script Detection 2057
Sensiti veData Detection 2059 CHAPTER 74
Sensitive Data Detection Basics 2059
Global Sensitive Data Detection Options 2060
Individual Sensitive Data TypeOptions 2061
System-Provided Sensitive Data Types 2062
License Requirements forSensitive Data Detection 2062
Requirements andPrerequisites forSensitive Data Detection 2063
Configuring Sensitive Data Detection 2063
Monitored Application Protocols andSensitive Data 2064
Special Case: Sensitive Data Detection inFTP Traffic 2065
Custom Sensitive Data Types 2065
Data Patterns inCustom Sensitive Data Types 2066
Configuring Custom Sensitive Data Types 2068
Editing Custom Sensitive Data Types 2069
Global Limit forIntrusion EventLogging 2071 CHAPTER 75
Global Rule Thresholding Basics 2071
Global Rule Thresholding Options 2072
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxviiContents

License Requirements forGlobal Thresholds 2073
Requirements andPrerequisites forGlobal Thresholds 2074
Configuring Global Thresholds 2074
Disabling theGlobal Threshold 2075
Intrusion Prevention Performance Tuning 2077 CHAPTER 76
About Intrusion Prevention Performance Tuning 2077
License Requirements forIntrusion Prevention Performance Tuning 2078
Requirements andPrerequisites forIntrusion Prevention Performance Tuning 2078
Limiting Pattern Matching forIntrusions 2078
Regular Expression Limits Overrides forIntrusion Rules 2079
Overriding Regular Expression Limits forIntrusion Rules 2080
PerPacket Intrusion Event Generation Limits 2081
Limiting Intrusion Events Generated PerPacket 2081
Packet andIntrusion Rule Latency Threshold Configuration 2082
Latency-Based Performance Settings 2082
Packet Latency Thresholding 2082
Packet Latency Thresholding Notes 2083
Enabling Packet Latency Thresholding 2084
Configuring Packet Latency Thresholding 2084
Rule Latency Thresholding 2085
Rule Latency Thresholding Notes 2086
Configuring Rule Latency Thresholding 2087
Intrusion Performance Statistic Logging Configuration 2088
Configuring Intrusion Performance Statistic Logging 2088
Netw orkMalwar eProtection andFilePolicies 2091 PART XV
Netw orkMalwar eProtection andFilePolicies 2093 CHAPTER 77
About Network Malware Protection andFilePolicies 2093
FilePolicies 2094
Requirements andPrerequisites forFilePolicies 2094
License Requirements forFileandMalware Policies 2095
Best Practices forFilePolicies andMalware Detection 2095
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxviiiContents

FileRule Best Practices 2095
FileDetection Best Practices 2096
FileBlocking Best Practices 2096
FilePolicy Best Practices 2097
How toConfigure Malware Protection 2098
Plan andPrepare forMalware Protection 2098
Configure FilePolicies 2099
Add FilePolicies toYourAccess Control Configuration 2100
Configuring anAccess Control Rule toPerform Malware Protection 2101
SetUpMaintenance andMonitoring ofMalware Protection 2102
Cloud Connections forMalware Protection 2102
AMP Cloud Connection Configurations 2103
Requirements andBest Practices forAMP Cloud Connections 2103
Change AMP Options 2103
Dynamic Analysis Connections 2104
Requirements forDynamic Analysis 2104
Viewing theDefault Dynamic Analysis Connection 2104
Enabling Access toDynamic Analysis Results inthePublic Cloud 2104
Maintain YourSystem: Update FileTypes Eligible forDynamic Analysis 2105
FilePolicies andFileRules 2106
Create orEdit aFilePolicy 2106
Advanced andArchive FileInspection Options 2106
Managing FilePolicies 2109
FileRules 2110
FileRule Components 2111
FileRule Actions 2112
Creating FileRules 2119
Access Control Rule Logging forMalware Protection 2120
Retrospective Disposition Changes 2120
FileandMalware Inspection Performance andStorage Options 2120
Tuning FileandMalware Inspection Performance andStorage 2122
(Optional) Malware Protection with AMP forEndpoints 2123
Comparison ofMalware Protection: Firepower vs.AMP forEndpoints 2123
About Integrating Firepower with AMP forEndpoints 2124
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxixContents

Benefits ofIntegrating Firepower andAMP forEndpoints 2124
AMP forEndpoints andAMP Private Cloud 2125
Integrate Firepower andSecure Endpoint 2125
History forNetwork Malware Protection andFilePolicies 2127
Encrypted TrafficHandling 2129 PART XVI
TrafficDecryption Overview 2131 CHAPTER 78
TrafficDecryption Explained 2131
TLS/SSL Handshake Processing 2132
ClientHello Message Handling 2133
ServerHello andServer Certificate Message Handling 2136
TLS/SSL Best Practices 2138
TheCase forDecryption 2138
When toDecrypt Traffic,When NottoDecrypt 2139
Decrypt andResign (Outgoing Traffic) 2140
Known Key Decryption (Incoming Traffic) 2141
Other Decryption Rule Actions 2141
Decryption Rule Components 2141
Decryption Rule Order Evaluation 2142
Multi-Rule Example 2143
TLS Crypto Acceleration 2145
TLS Crypto Acceleration Guidelines andLimitations 2146
ViewtheStatus ofTLS Crypto Acceleration 2147
How toConfigure Decryption Policies andRules 2148
History forDecryption Policy 2149
Decryption Policies 2153 CHAPTER 79
About Decryption Policies 2153
Requirements andPrerequisites forDecryption Policies 2154
Create aDecryption Policy 2154
Create aDecryption Policy with Outbound Connection Protection 2156
Upload anInternal CAforOutbound Protection 2158
Generate anInternal CAforOutbound Protection 2158
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxContents

Create aDecryption Policy with Inbound Connection Protection 2159
Create aDecryption Policy with Other Rule Actions 2161
Decryption Policy Default Actions 2162
Default Handling Options forUndecryptable Traffic 2162
SetDefault Handling forUndecryptable Traffic 2164
Decryption Policy Advanced Options 2164
TLS 1.3Decryption Best Practices 2166
Decryption Rules 2169 CHAPTER 80
Decryption Rules Overview 2169
Requirements andPrerequisites forDecryption Rules 2169
Decryption Rule Guidelines andLimitations 2170
Guidelines forUsing TLS/SSL Decryption 2170
Decryption Rule Unsupported Features 2171
TLS/SSL DoNotDecrypt Guidelines 2171
TLS/SSL Decrypt -Resign Guidelines 2173
TLS/SSL Decrypt -Known Key Guidelines 2175
TLS/SSL Block Guidelines 2175
TLS/SSL Certificate Pinning Guidelines 2176
TLS/SSL Heartbeat Guidelines 2176
TLS/SSL Anonymous Cipher Suite Limitation 2176
TLS/SSL Normalizer Guidelines 2176
Other Decryption Rule Guidelines 2177
Decryption Rule TrafficHandling 2177
Encrypted TrafficInspection Configuration 2179
Decryption Rule Order Evaluation 2180
Decryption Rule Conditions 2181
Security Zone Rule Conditions 2182
Network Rule Conditions 2182
VLAN TagsRule Conditions 2183
User Rule Conditions 2183
Application Rule Conditions 2184
Port Rule Conditions 2185
Category Rule Conditions 2185
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxiContents

Server Certificate-Based Decryption Rule Conditions 2186
Certificate Decryption Rule Conditions 2186
Distinguished Name (DN) Rule Conditions 2187
Trusting External Certificate Authorities 2192
Certificate Status Decryption Rule Conditions 2193
Cipher Suite Decryption Rule Conditions 2196
Encryption Protocol Version Decryption Rule Conditions 2199
Decryption Rule Actions 2199
Decryption Rule Monitor Action 2199
Decryption Rule DoNotDecrypt Action 2200
Decryption Rule Blocking Actions 2201
Decryption Rule Decrypt Actions 2201
Monitor TLS/SSL Hardware Acceleration 2201
Informational Counters 2202
Alert Counters 2202
Error Counters 2202
Fatal Counters 2203
Troubleshooting Using Crypto Archives 2204
Decryption Rules andPolicy Example 2207 CHAPTER 81
Decryption Rules Best Practices 2207
Bypass Inspection with Prefilter andFlow Offload 2208
DoNotDecrypt Best Practices 2209
Decrypt -Resign andDecrypt -Known Key Best Practices 2209
Decryption Rules toPutFirst 2210
Decryption Rules toPutLast 2210
Decryption Policy Walkthrough 2210
Recommended Policy andRule Settings 2211
Decryption Policy Settings 2212
Access Control Policy Settings 2213
Decryption Rule Examples 2214
TraffictoPrefilter 2215
First Decryption Rule: DoNotDecrypt Specific Traffic 2215
Next Decryption Rules: Decrypt Specific TestTraffic 2216
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxiiContents

DoNotDecrypt Low-Risk Categories, Reputations, orApplications 2217
Create aDecrypt -Resign Rule forCategories 2218
Last Decryption Rules: Block orMonitor Certificates andProtocol Versions 2220
Decryption Rule Settings 2226
User Identity 2227 PART XVII
User Identity Overview 2229 CHAPTER 82
About User Identity 2229
Identity Terminology 2230
About User Identity Sources 2230
Best Practices forUser Identity 2231
Identity Deployments 2233
How toSetUpanIdentity Policy 2233
TheUser Activity Database 2237
TheUsers Database 2237
Cisco Defense Orchestrator Host andUser Limits 2238
Cloud-delivered Firewall Management Center Host Limit 2238
Cisco Defense OrchestratorCloud-delivered Firewall Management Center User Limit 2239
Realms 2241 CHAPTER 83
About Realms andRealm Sequences 2241
Realms andTrusted Domains 2243
Supported Servers forRealms 2246
Supported Server Object Class andAttribute Names 2247
License Requirements forRealms 2248
Requirements andPrerequisites forRealms 2248
Create aProxy Sequence 2248
Create aMicrosoft Azure ADRealm 2250
About Azure ADandISEwith Resource Owned Password Credentials 2250
About Azure ADandISEwith TEAP/EAP-TLS 2251
How toCreate aMicrosoft Azure ADRealm 2251
Configure Microsoft Azure Active Directory 2252
How toConfigure ISEforMicrosoft Azure AD 2253
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxiiiContents

GetRequired Information ForYourMicrosoft Azure ADRealm 2254
Create anAzure ADRealm 2256
Azure ADUser Session Timeout 2257
Create anLDAP Realm oranActive Directory Realm andRealm Directory 2258
Prerequisites forKerberos Authentication 2260
Realm Fields 2261
Realm Directory andSynchronize fields 2264
Connect Securely toActive Directory 2267
Find theActive Directory Server's Name 2267
Export theActive Directory Server's Root Certificate 2268
Synchronize Users andGroups 2269
Create aRealm Sequence 2270
Configure theManagement Center forCross-Domain-T rust: TheSetup 2272
Configure theSecure Firewall Management Center forCross-Domain-T rustStep 1:Configure Realms
andDirectories 2273
Configure themanagement center forCross-Domain-T rustStep 2:Synchronize Users andGroups 2277
Configure themanagement center forCross-Domain-T rustStep 3:Resolve Issues 2278
Manage aRealm 2279
Compare Realms 2280
Troubleshoot Realms andUser Downloads 2280
Troubleshoot Cross-Domain Trust 2283
History forRealms 2286
User Contr olwith ISE/ISE-PIC 2287 CHAPTER 84
TheISE/ISE-PIC Identity Source 2287
Source andDestination Security Group Tag(SGT) Matching 2288
License Requirements forISE/ISE-PIC 2289
Requirements andPrerequisites forISE/ISE-PIC 2289
ISE/ISE-PIC Guidelines andLimitations 2289
How toConfigure ISE/ISE-PIC forUser Control 2292
How toConfigure ISEWithout aRealm 2292
How toConfigure ISE/ISE-PIC forUser Control Using aRealm 2293
Configure ISE/ISE-PIC 2295
Configure Security Groups andSXP Publishing inISE 2295
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxivContents

Export Certificates from theISE/ISE-PIC Server forUseintheManagement Center 2298
Export aSystem Certificate 2299
Generate aSelf-Signed Certificate 2299
Import ISE/ISE-PIC Certificates 2300
Configure ISEforUser Control 2301
ISE/ISE-PIC Configuration Fields 2302
Troubleshoot theISE/ISE-PIC orCisco TrustSec Issues 2304
History forISE/ISE-PIC 2305
User Contr olwith Capti vePortal 2307 CHAPTER 85
TheCaptive Portal Identity Source 2307
About Hostname Redirect 2308
License Requirements forCaptive Portal 2308
Requirements andPrerequisites forCaptive Portal 2308
Captive Portal Guidelines andLimitations 2308
How toConfigure theCaptive Portal forUser Control 2311
Configure theCaptive Portal Part1:Create aNetwork Object 2312
Configure theCaptive Portal Part2:Create anIdentity Policy andActive Authentication Rule 2314
Update aCustom Authentication Form 2316
Configure theCaptive Portal Part3:Create aTCP Port Access Control Rule 2316
Configure theCaptive Portal Part4:Create aUser Access Control Rule 2317
Captive Portal Example: Create aDecryption Policy with anOutbound Rule 2318
Configure Captive Portal Part6:Associate Identity andDecryption Policies with theAccess Control
Policy 2320
Captive Portal Fields 2321
Exclude Applications from Captive Portal 2322
Troubleshoot theCaptive Portal Identity Source 2323
History forCaptive Portal 2324
User Contr olwith Remote Access VPN 2325 CHAPTER 86
TheRemote Access VPN Identity Source 2325
Configure RAVPN forUser Control 2326
Troubleshoot theRemote Access VPN Identity Source 2326
NotObserving Correct Settings forVPN Statistics 2327
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxvContents

User Contr olwith TSAgent 2329 CHAPTER 87
TheTerminal Services (TS) Agent Identity Source 2329
TSAgent Guidelines 2330
User Control with TSAgent 2330
Troubleshoot theTSAgent Identity Source 2330
History forTSAgent 2331
User Identity Policies 2333 CHAPTER 88
About Identity Policies 2333
License Requirements forIdentity Policies 2334
Requirements andPrerequisites forIdentity Policies 2334
Create anIdentity Policy 2335
Create anIdentity Mapping Filter 2336
Identity Rule Conditions 2337
Security Zone Rule Conditions 2337
Network Rule Conditions 2338
Redirect toHost Name Network Rule Conditions 2338
VLAN TagsRule Conditions 2338
Port Rule Conditions 2339
Port, Protocol, andICMP Code Rule Conditions 2339
Realm &Settings Rule Conditions 2340
Create anIdentity Rule 2342
Identity Rule Fields 2344
Sample Identity Policies andRules 2344
Create anIdentity Policy with aPassive Authentication Rule 2345
Create aSample Identity Policy with anActive Authentication Rule 2347
Active Authentication Using aRealm 2349
Active Authentication Using aRealm Sequence 2350
Manage anIdentity Policy 2351
Manage anIdentity Rule 2352
Troubleshoot User Control 2352
Netw orkDisco very 2355 PART XVIII
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxviContents

Netw orkDisco veryOverview 2357 CHAPTER 89
About Detection ofHost, Application, andUser Data 2357
Host andApplication Detection Fundamentals 2358
Passive Detection ofOperating System andHost Data 2358
Active Detection ofOperating System andHost Data 2359
Current Identities forApplications andOperating Systems 2359
Current User Identities 2360
Application andOperating System Identity Conflicts 2361
NetFlow Data 2361
Requirements forUsing NetFlow Data 2362
Differences between NetFlow andManaged Device Data 2362
Host Identity Sour ces 2365 CHAPTER 90
Overview: Host Data Collection 2365
Requirements andPrerequisites forHost Identity Sources 2366
Determining Which Host Operating Systems theSystem CanDetect 2366
Identifying Host Operating Systems 2366
Custom Fingerprinting 2367
Managing Fingerprints 2368
Activating andDeactivating Fingerprints 2368
Editing anActive Fingerprint 2369
Editing anInactive Fingerprint 2369
Creating aCustom Fingerprint forClients 2370
Creating aCustom Fingerprint forServers 2372
Host Input Data 2375
Requirements forUsing Third-Party Data 2375
Third-Party Product Mappings 2376
Mapping Third-Party Products 2376
Mapping Third-Party Product Fixes 2377
Mapping Third-Party Vulnerabilities 2378
Custom Product Mappings 2379
Creating Custom Product Mappings 2379
Editing Custom Product Mapping Lists 2380
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxviiContents

Activating andDeactivating Custom Product Mappings 2381
Nmap Scanning 2381
Nmap Remediation Options 2382
Nmap Scanning Guidelines 2386
Example: Using Nmap toResolve Unknown Operating Systems 2387
Example: Using Nmap toRespond toNew Hosts 2388
Managing Nmap Scanning 2389
Adding anNmap Scan Instance 2390
Editing anNmap Scan Instance 2391
Adding anNmap Scan Target 2392
Editing anNmap Scan Target 2392
Creating anNmap Remediation 2393
Editing anNmap Remediation 2395
Running anOn-Demand Nmap Scan 2395
Nmap Scan Results 2396
Viewing Nmap Scan Results 2396
Nmap Scan Results Fields 2397
Importing Nmap Scan Results 2398
Application Detection 2399 CHAPTER 91
Overview: Application Detection 2399
Application Detector Fundamentals 2400
Identification ofApplication Protocols intheWebInterface 2401
Implied Application Protocol Detection from Client Detection 2402
Host Limits andDiscovery Event Logging 2402
Special Considerations forApplication Detection 2403
Application Detection inSnort 2andSnort 3 2404
Requirements andPrerequisites forApplication Detection 2405
Custom Application Detectors 2405
Custom Application Detector andUser-Defined Application Fields 2405
Configuring Custom Application Detectors 2408
Creating aUser-Defined Application 2409
Specifying Detection Patterns inBasic Detectors 2410
Specifying Detection Criteria inAdvanced Detectors 2411
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxviiiContents

Specifying EVE Process Assignments 2412
Testing aCustom Application Protocol Detector 2413
Viewing orDownloading Detector Details 2414
Sorting theDetector List 2414
Filtering theDetector List 2415
Filter Groups fortheDetector List 2415
Navigating toOther Detector Pages 2416
Activating andDeactivating Detectors 2416
Editing Custom Application Detectors 2417
Deleting Detectors 2418
Netw orkDisco veryPolicies 2419 CHAPTER 92
Overview: Network Discovery Policies 2419
Requirements andPrerequisites forNetwork Discovery Policies 2420
Network Discovery Customization 2420
Configuring theNetwork Discovery Policy 2421
Network Discovery Rules 2421
Configuring Network Discovery Rules 2422
Actions andDiscovered Assets 2422
Monitored Networks 2423
Port Exclusions 2425
Zones inNetwork Discovery Rules 2427
TheTraffic-Based Detection Identity Source 2427
Configuring Advanced Network Discovery Options 2430
Network Discovery General Settings 2431
Configuring Network Discovery General Settings 2431
Network Discovery Identity Conflict Settings 2431
Configuring Network Discovery Identity Conflict Resolution 2432
Network Discovery Vulnerability Impact Assessment Options 2432
Enabling Network Discovery Vulnerability Impact Assessment 2433
Indications ofCompromise 2433
Enabling Indications ofCompromise Rules 2434
Adding NetFlow Exporters toaNetwork Discovery Policy 2434
Network Discovery Data Storage Settings 2435
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxixContents

Configuring Network Discovery Data Storage 2436
Configuring Network Discovery Event Logging 2437
Adding Network Discovery OSandServer Identity Sources 2437
Troubleshooting YourNetwork Discovery Strategy 2438
FlexConf igPolicies 2441 PART XIX
FlexConf igPolicies 2443 CHAPTER 93
FlexConfig Policy Overview 2443
Recommended Usage forFlexConfig Policies 2444
CLICommands inFlexConfig Objects 2444
Determine theASA Software Version andCurrent CLIConfiguration 2445
Prohibited CLICommands 2445
Template Scripts 2447
FlexConfig Variables 2448
How toProcess Variables 2448
How toSeeWhat aVariable WillReturn foraDevice 2451
FlexConfig Policy Object Variables 2452
FlexConfig System Variables 2453
Predefined FlexConfig Objects 2454
Predefined TextObjects 2459
Requirements andPrerequisites forFlexConfig Policies 2463
Guidelines andLimitations forFlexConfig 2463
Customizing Device Configuration with FlexConfig Policies 2464
Configure FlexConfig Objects 2466
Add aPolicy Object Variable toaFlexConfig Object 2468
Configure Secret Keys 2469
Configure FlexConfig TextObjects 2470
Configure theFlexConfig Policy 2471
SetTargetDevices foraFlexConfig Policy 2472
Preview theFlexConfig Policy 2473
Verify theDeployed Configuration 2474
Remove Features Configured Using FlexConfig 2475
Convert from FlexConfig toManaged Feature 2477
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxContents

Examples forFlexConfig 2477
How toConfigure Precision TimeProtocol (ISA 3000) 2477
How toConfigure Automatic Hardware Bypass forPower Failure (ISA 3000) 2481
Migrating FlexConfig Policies 2483
Advanced Netw orkAnalysis andPreprocessing 2487 PART XX
Advanced Access Contr olSettings forNetw orkAnalysis andIntrusion Policies 2489 CHAPTER 94
About Advanced Access Control Settings forNetwork Analysis andIntrusion Policies 2489
Requirements andPrerequisites forAdvanced Access Control Settings forNetwork Analysis and
Intrusion Policies 2489
Inspection ofPackets That Pass Before TrafficIsIdentified 2490
Best Practices forHandling Packets That Pass Before TrafficIdentification 2490
Specify aPolicy toHandle Packets That Pass Before TrafficIdentification 2490
Advanced Settings forNetwork Analysis Policies 2491
Setting theDefault Network Analysis Policy 2492
Network Analysis Rules 2493
Network Analysis Policy Rule Conditions 2493
Configuring Network Analysis Rules 2494
Managing Network Analysis Rules 2495
GetStarted with Snort 3Netw orkAnalysis Policies 2497 CHAPTER 95
Overview ofNetwork Analysis Policies 2497
Manage Network Analysis Policies 2498
Snort 3Definitions andTerminologies forNetwork Analysis Policy 2499
Prerequisites forNetwork Analysis andIntrusion Policies 2501
Custom Network Analysis Policy Creation forSnort 3 2501
Common Industrial Protocol Safety 2505
Detect andBlock Safety Segments inCIPPackets 2506
Network Analysis Policy Mapping 2506
ViewNetwork Analysis Policy Mapping 2507
Create aNetwork Analysis Policy 2507
Modify theNetwork Analysis Policy 2507
Search foranInspector ontheNetwork Analysis Policy Page 2508
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxiContents

Copy theInspector Configuration 2508
Customize theNetwork Analysis Policy 2509
Make Inline Edit foranInspector toOverride Configuration 2512
Revert Unsaved Changes during Inline Edits 2513
ViewtheListofInspectors with Overrides 2514
Revert Overridden Configuration toDefault Configuration 2514
Validate Snort 3Policies 2515
Examples ofCustom Network Analysis Policy Configuration 2517
Network Analysis Policy Settings andCached Changes 2528
Custom Rules inSnort 3 2528
Overview ofEncrypted Visibility Engine 2531
How EVE Works 2532
Indications ofCompromise Events 2532
QUIC Fingerprinting inEVE 2533
Configure EVE 2533
ViewEVE Events 2534
ViewEVE Dashboard 2535
About Elephant Flow Detection andRemediation 2536
Elephant Flow Upgrade from Intelligent Application Bypass 2536
Configure Elephant Flow 2536
Application LayerPreprocessors 2541 CHAPTER 96
Introduction toApplication Layer Preprocessors 2541
License Requirements forApplication Layer Preprocessors 2542
Requirements andPrerequisites forApplication Layer Preprocessors 2542
TheDCE/RPC Preprocessor 2542
Connectionless andConnection-Oriented DCE/RPC Traffic 2543
DCE/RPC Target-Based Policies 2544
RPC over HTTP Transport 2545
DCE/RPC Global Options 2545
DCE/RPC Target-Based Policy Options 2547
Traffic-Associated DCE/RPC Rules 2551
Configuring theDCE/RPC Preprocessor 2551
TheDNS Preprocessor 2553
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxiiContents

DNS Preprocessor Options 2554
Configuring theDNS Preprocessor 2555
TheFTP/T elnet Decoder 2556
Global FTP andTelnet Options 2556
Telnet Options 2557
Server-Level FTP Options 2558
FTP Command Validation Statements 2560
Client-Level FTP Options 2561
Configuring theFTP/T elnet Decoder 2562
TheHTTP Inspect Preprocessor 2563
Global HTTP Normalization Options 2564
Server-Level HTTP Normalization Options 2565
Server-Level HTTP Normalization Encoding Options 2573
Configuring TheHTTP Inspect Preprocessor 2576
Additional HTTP Inspect Preprocessor Rules 2578
TheSunRPC Preprocessor 2578
SunRPC Preprocessor Options 2579
Configuring theSunRPC Preprocessor 2579
TheSIPPreprocessor 2580
SIPPreprocessor Options 2581
Configuring theSIPPreprocessor 2583
Additional SIPPreprocessor Rules 2584
TheGTP Preprocessor 2585
GTP Preprocessor Rules 2585
Configuring theGTP Preprocessor 2586
TheIMAP Preprocessor 2587
IMAP Preprocessor Options 2587
Configuring theIMAP Preprocessor 2588
Additional IMAP Preprocessor Rules 2589
ThePOP Preprocessor 2590
POP Preprocessor Options 2590
Configuring thePOP Preprocessor 2591
Additional POP Preprocessor Rules 2592
TheSMTP Preprocessor 2593
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxiiiContents

SMTP Preprocessor Options 2593
Configuring SMTP Decoding 2597
TheSSH Preprocessor 2598
SSH Preprocessor Options 2599
Configuring theSSH Preprocessor 2602
TheSSL Preprocessor 2603
How SSL Preprocessing Works 2603
SSL Preprocessor Options 2604
Configuring theSSL Preprocessor 2605
SSL Preprocessor Rules 2606
SCAD APreprocessors 2609 CHAPTER 97
Introduction toSCADA Preprocessors 2609
License Requirements forSCADA Preprocessors 2609
Requirements andPrerequisites forSCADA Preprocessors 2610
TheModbus Preprocessor 2610
Modbus Preprocessor Ports Option 2610
Configuring theModbus Preprocessor 2611
Modbus Preprocessor Rules 2612
TheDNP3 Preprocessor 2612
DNP3 Preprocessor Options 2612
Configuring theDNP3 Preprocessor 2613
DNP3 Preprocessor Rules 2614
TheCIPPreprocessor 2614
CIPPreprocessor Options 2615
CIPEvents 2615
CIPPreprocessor Rules 2616
Guidelines forConfiguring theCIPPreprocessor 2616
Configuring theCIPPreprocessor 2617
TheS7Commplus Preprocessor 2618
Configuring theS7Commplus Preprocessor 2618
Transport andNetw orkLayerPreprocessors 2621 CHAPTER 98
Introduction toTransport andNetwork Layer Preprocessors 2621
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxivContents

License Requirements forTransport andNetwork Layer Preprocessors 2621
Requirements andPrerequisites forTransport andNetwork Layer Preprocessors 2622
Advanced Transport/Network Preprocessor Settings 2622
Ignored VLAN Headers 2622
Active Responses inIntrusion Drop Rules 2622
Advanced Transport/Network Preprocessor Options 2623
Configuring Advanced Transport/Network Preprocessor Settings 2624
Checksum Verification 2625
Checksum Verification Options 2625
Verifying Checksums 2626
TheInline Normalization Preprocessor 2627
Inline Normalization Options 2627
Configuring Inline Normalization 2632
TheIPDefragmentation Preprocessor 2633
IPFragmentation Exploits 2633
Target-Based Defragmentation Policies 2634
IPDefragmentation Options 2634
Configuring IPDefragmentation 2637
ThePacket Decoder 2638
Packet Decoder Options 2638
Configuring Packet Decoding 2641
TCP Stream Preprocessing 2642
State-Related TCP Exploits 2643
Target-Based TCP Policies 2643
TCP Stream Reassembly 2644
TCP Stream Preprocessing Options 2645
Configuring TCP Stream Preprocessing 2651
UDP Stream Preprocessing 2653
UDP Stream Preprocessing Options 2653
Configuring UDP Stream Preprocessing 2654
Specif icThreatDetection 2655 CHAPTER 99
Introduction toSpecific Threat Detection 2655
License Requirements forSpecific Threat Detection 2655
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxvContents

Requirements andPrerequisites forSpecific Threat Detection 2656
Back Orifice Detection 2656
Back Orifice Detection Preprocessor 2656
Detecting Back Orifice 2657
Portscan Detection 2657
Portscan Types, Protocols, andFiltered Sensitivity Levels 2658
Portscan Event Generation 2660
Portscan Event Packet View 2662
Configuring Portscan Detection 2663
Rate-Based Attack Prevention 2665
Rate-Based Attack Prevention Examples 2666
detection_filter Keyword Example 2666
Dynamic Rule State Thresholding orSuppression Example 2667
Policy-W ideRate-Based Detection andThresholding orSuppression Example 2668
Rate-Based Detection with Multiple Filtering Methods Example 2669
Rate-Based Attack Prevention Options andConfiguration 2670
Rate-Based Attack Prevention, Detection Filtering, andThresholding orSuppression 2671
Configuring Rate-Based Attack Prevention 2672
Adapti veProfiles 2675 CHAPTER 100
About Adaptive Profiles 2675
License Requirements forAdaptive Profiles 2676
Requirements andPrerequisites forAdaptive Profiles 2676
Adaptive Profile Updates 2676
Adaptive Profile Updates andCisco Recommended Rules 2677
Adaptive Profile Options 2677
Configuring Adaptive Profiles 2678
Refer ence 2681 PART XXI
FAQandSupport 2683 CHAPTER 101
CDO Platform Maintenance Schedule 2683
What does thedefault action "Analyze alltunnel traffic"forprefiltering mean? 2684
How CDO Processes Personal Information 2684
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxviContents

CanIrestore abackup from adifferent device? 2684
Does deploying anew prefilter policy immediately affectongoing sessions? 2684
How doIkeep mysecurity databases andfeeds uptodate? 2684
What version ofSecure Firewall Threat Defense canImanage with cloud-delivered Firewall Management
Center? 2685
How doIexclude specific traffic(Webex, Zoom, etc)from theremote access VPN? 2685
How doIprevent users from accessing undesirable external network resources, such asinappropriate
websites? 2686
Security Feed Questions 2687
How doIupdate intrusion rules (SRU/LSP)? 2687
How doIupdate myCisco vulnerability database (VDB)? 2687
How doIupdate myGeolocation database? 2688
How doIupdate Security Intelligence feeds? 2688
How doIupdate URL reputations? 2689
How doIsetup Rate-Based Attack Prevention ontheFTD using Snort 2? 2689
Complete theInitial Configuration ofaSecure Firewall Threat Defense Device Using theCLI 2690
Secur eFirewall Management Center Command Line Refer ence 2695 CHAPTER 102
About theSecure Firewall Management Center CLI 2695
Secure Firewall Management Center CLIModes 2696
Secure Firewall Management Center CLIManagement Commands 2696
exit 2696
expert 2696
?(question mark) 2697
Secure Firewall Management Center CLIShow Commands 2697
version 2697
Secure Firewall Management Center CLIConfiguration Commands 2698
password 2698
Secure Firewall Management Center CLISystem Commands 2699
generate-troubleshoot 2699
lockdown 2700
reboot 2700
restart 2700
shutdown 2700
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxviiContents

Security ,Inter netAccess, andCommunication Ports 2703 CHAPTER 103
Security Requirements 2703
Cisco Clouds 2703
Internet Access Requirements 2704
Communication Port Requirements 2704
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
lxxxviiiContents

PARTI
Managing Cisco Secure Firewall Threat Defense
with Cloud-delivered Firewall Management
Center
•Managing Cisco Secure Firewall Threat Defense Devices with Cloud-delivered Firewall Management
Center ,onpage 1
•Cisco AIAssistant User Guide ,onpage 5

CHAPTER 1
Managing Cisco Secure Firewall Threat Defense
Devices with Cloud-delivered Firewall
Management Center
Thecloud-delivered Firewall Management Center isasoftware-as-a-service (SaaS) product thatmanages
Secure Firewall Threat Defense devices andisdelivered viaCisco Defense Orchestrator (CDO). The
cloud-delivered Firewall Management Center offersmany ofthesame functions asanon-premises Secure
Firewall Management Center .
Thecloud-delivered Firewall Management Center hasthesame appearance andbehavior asanon-premises
Secure Firewall Management Center anduses thesame FMC API.
AsaSaaS product, theCisco Defense Orchestrator (CDO) operations team isresponsible fordeploying and
maintaining cloud-delivered Firewall Management Center software. Asnewfeatures areintroduced, theCDO
operations team updates your CDO tenant's cloud-delivered Firewall Management Center foryou.
Amigration wizard isavailable tohelp youmigrate your Secure Firewall Threat Defense devices from your
on-premises Secure Firewall Management Center tothecloud-delivered Firewall Management Center .The
devices must have Threat Defense software Version 7.0.3 oralater 7.0.x release, orVersion 7.2orlater
installed tobemigrated. Threat Defense 7.1releases arenotsupported.
Onboarding Secure Firewall Threat Defense devices iscarried outinCDO using familiar processes such as
onboarding adevice with itsserial number orusing aCLIcommand thatincludes aregistration key.Once
thedevice isonboarded, itisvisible both inCDO andinthecloud-delivered Firewall Management Center ,
however ,youconfigure thedevice inthecloud-delivered Firewall Management Center .InCDO, youcan
view device-specific information such asversion, configuration status, connectivity ,health status, andnode
status. When youclick onthehealth status from CDO, youaretaken totherespective device's health monitoring
page inthecloud-delivered Firewall Management Center user interface.
CDO provides high availability support forthethreat defense devices thatitmanages through thedatainterface.
This feature issupported fordevices running software version 7.2orlater.
Youcananalyze syslog events generated byyour onboarded threat defense devices using Security Analytics
andLogging (SaaS) orSecurity Analytics andLogging (On-Premises). TheSaaS version stores events inthe
cloud andyouview theevents inCDO. Theon-premises version stores events inanon-premises Secure
Network Analytics appliance andanalysis isdone intheon-premises Secure Firewall Management Center .
Inboth cases, justaswith anon-premises FMC today ,youcanstillsend logs toalogcollector ofyour choice
directly from thesensors.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
1

Thelicense forcloud-delivered Firewall Management Center isaper-device-managed license andthere isno
license required forthecloud-delivered Firewall Management Center itself. Existing Secure Firewall Threat
Defense devices re-use their existing smart licenses andnewSecure Firewall Threat Defense devices provision
new smart licenses foreach feature implemented ontheFTD.
Existing customers cancontinue touseCDO formanaging other device types like, theSecure Firewall ASA,
Meraki, Cisco IOSdevices, Umbrella, andAWSvirtual private clouds. IfyouuseCDO tomanage aSecure
Firewall Threat Defense device configured forlocal management with Firepower Device Manager ,youcan
continue tomanage them with CDO aswell.
Tolearn how tohave acloud-delivered Firewall Management Center provisioned onyour tenant, seeEnable
Cloud-delivered Firewall Management Center onYourCDO Tenant ,onpage 3.
Learn more about theFirewall Management Center features wesupport incloud-delivered Firewall Management
Center
•Onboarding Overview
•Migrate Secure Firewall Threat Defense toCloud
•Health
•Backup/Restore ,onpage 333
•Scheduling
•Import/Export
•Reporting andAlerting
•Transparent orRouted Firewall Mode
•High Availability
•Interfaces andDevice Settings
•Routing ,onpage 1117
•Objects andCertificates
•Network Address Translation
•Access Control Policies
•VPN
•Intrusion Detection andPrevention
•Network Malware Protection andFilePolicies
•Encrypted TrafficHandling
•User Identity
•Network Discovery
•FlexConfig Policies
•Advanced Network Analysis andPreprocessing
•Enable Cloud-delivered Firewall Management Center onYourCDO Tenant ,onpage 3
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
2Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center

•Hardware andSoftware Support ,onpage 3
•CDO Platf orm Maintenance Schedule ,onpage 4
Enable Cloud-delivered Firewall Management Center onYour
CDO Tenant
Ifyouwant tomanage your Secure Firewall Threat Defense devices, youcanenable thecloud-delivered
Firewall Management Center onyour tenant. Youneed tohave anadmin orasuper admin userroletoperform
thistask.
Procedure
Step 1 From theCDO menu, click Tools &Services >Firewall Management Center >
 >FMC >Enable
Cloud-Deli veredFMC .
Step 2 CDO starts provisioning acloud-delivered Firewall Management Center instance inthebackground; ittypically
takes 15to30minutes forthistobecomplete. Youcantrack theprovisioning progress ontheStatus column
ofCloud-Deli veredFMC .
After theprovisioning iscomplete, thestatus changes toActive.Inaddition, yougetaCloud-deli vered
Firewall Management Center isReady notification ontheCDO notifications panel andontheapplications
onwhich youhave configured incoming webhooks. SeeNotification Settings formore information.
After youreceive theCloud-deli veredFirewall Management Center isReady notification, ensure
thatyoulogoutofandloginback toyour tenant once, toseetheCloud-Deli veredFMC right pane
options, such asActions ,Management ,andSystem .Note
Youcanthen onboard your threat defense devices tothecloud-delivered Firewall Management Center and
manage them.
Hardware and Software Support
Cloud-delivered Firewall Management Center supports these Secure Firewall Threat Defense software versions
when they areinstalled onanysupported hardware orvirtual device:
•Verion 7.0.3 orlater 7.0.x versions.
•Version 7.2andlater versions.
Software Version 7.1is_not_ supported. Note
SeeFirepower Threat Defense Support Specifics formore information.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
3Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Enable Cloud-delivered Firewall Management Center onYourCDO Tenant

CDO Platform Maintenance Schedule
CDO updates itsplatform every week with new features andquality improvements. Updates canbemade
during a3hour period according tothisschedule.
Time ofDay
(24-hour time)Day oftheWeek
09:00 UTC -12:00 UTC Thursday
During thismaintenance period, youcanstillaccess your tenant andifyouhave acloud-delivered Firewall
Management Center ,youcanaccess thatplatform aswell. Additionally ,thedevices youhave onboarded to
CDO continue toenforce their security policies.
•Weadvise younottouseCDO todeploy configuration changes onthedevices itmanages during
maintenance periods.
•Ifthere isanyissue thatstops CDO from communicating, thatfailure isaddressed onallaffected tenants
asquickly aspossible, even ifitisoutside themaintenance window .Note
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
4Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
CDO Platform Maintenance Schedule

CHAPTER 2
Cisco AIAssistant User Guide
•Getting Started with Cisco AIAssistant ,onpage 5
•Prompt Guide forCisco AIAssistant ,onpage 9
•Create Policy Rules ,onpage 12
•Cisco AIAssistant Frequently Asked Questions (FAQ),onpage 16
Getting Started with Cisco AIAssistant
Overview
Firewall administrators often encounter challenges inmanaging firewall policies andaccessing related
documentation. TheAIAssistant with Cisco Defense Orchestrator (CDO) andcloud-delivered Firewall
Management Center streamlines these tasks, making itmore efficient tomanage firewall devices, policies,
andreference documentation when needed.
Prerequisites
Administrators need toensure they have metthefollowing prerequisites tousetheAIAssistant :
•User roles:
•CDO andcloud-delivered Firewall Management Center- Super Administrators orAdministrators.
•On-Prem FMC -Global Domain Admin.
Upon successful login intoyour tenant, youwillnotice anAIAssistant widget positioned inthetopmenu bar
ofthedashboard (
 ),click onthewidget tolaunch theAIAssistant .
Onboarding First-T ime User
After opening theAIAssistant forthefirsttime, acarousel window opens andyouareintroduced totheAI
Assistant .Youarepresented with information onhow theAIAssistant protects theprivacy ofyour data, and
afewtipsonhow tobestuseit.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
5

Inthecarousel window ,Click Next tothelearn how theAIAssistant works with your data. Werecommend
thatyouread through thistounderstand how theAIAssistant treats your data andstrives fortransparency .
Atanypoint, ifyouclick Cancel theAIAssistant carousel closes.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
6Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Getting Started with Cisco AIAssistant

Youwillnotbeable tousetheAIAssistant until youhave navigated through allthescreens inthecarousel.
This andanyother action youtake with theAIAssistant isspecific toyour user account.
Youractions donotaffectother authorized administrators ofyour tenant.
Note
Clicking Launch AIAssistant opens theAIAssistant inafloating conversation window; Youcanselect a
response from oneofoursuggestion tiles ortype inaquestion inthetextbox.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
7Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Getting Started with Cisco AIAssistant

TheAIAssistant comes pre-enabled onevery tenant. Ifyouprefer todisable theAIAssistant navigate goto
theSettings page andswitch offtheAIAssistant toggle todisable it.Note
Cisco AIAssistant Components
TheCisco AIAssistant isengineered with user-friendly components.
•TextInput Box -Atthebottom ofthewindow ,youhave atextinput boxthatallows youtotype and
engage with theAIAssistant.
•New Thread-Click the"+"icon tostart anew conversation with theAIAssistant
•Chat History -Expand themenu trayontheleftsideofthescreen toseeyour chat history .
•Feedback -TheAIAssistant hasanoption toprovide feedback foritsresponses. Click thumbs upto
show appreciation orthumbs down tolettheassistant know thatitcandobetter .
•Expand View-Click ontheexpand icon onthetopright toopen theAIAssistant infullscreen view .
Cisco AIAssistant Best Practices
Werecommend thefollowing bestpractices toeffectively communicate with theAIAssistant :
•Askdetailed questions -TheAIAssistant istrained with policy/rule configuration anddocumentation
data.. Inorder toreceive arelevant response, werecommend thatyouprovide theassistant with important
details.
Sample question- How many decryption policies areenabled onmyaccount? Where canIaccess thepolicies?
Dothepolicies have source anddestination enabled?Tip
•Divide thetasks intosub-tasks -Fortasks thatrequired multiple setsofinstructions itcanbebeneficial
todivide thetasks andinput thesub-tasks after theprevious taskisanswered.
TheAIAssistant takes 24-hours tosync policy database, thisresults ina24hr delay ofthedata provided in
responses forpolicy inquiry .This does notimpact anyother features andusers cancontinue tointeract with
theAIAssistant .Note
Inthesample question above -Wesuggest breaking down thequestion intosmaller tasks andasking them
oneatatime, waiting foraresponse before moving ontothenext question. This approach helps prevent
information overload andreduces theneed forrepetition. -
•How many decryption policies areenabled onmyaccount?
•Where canIaccess thepolicies?
•Dothepolicies have source anddestination enabled?Tip
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
8Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Getting Started with Cisco AIAssistant

•Youcannot upload files orimages totheAIAssistant .
•TheAIAssistant currently provides support only inEnglish language.
Please read through thePrompt Guide togain abetter understanding oftherecommended bestpractices. Note
Prompt Guide forCisco AIAssistant
TheCisco AIAssistant ’sPrompt Guide isdesigned tohelp youinteract more effectively with ourAIAssistant ,
ensuring yougetaccurate, relevant, andhelpful responses toyour queries andcommands. Yourexperience
with Cisco AIAssistant canbegreatly enhanced byhow effectively youcommunicate with it.
Understanding aPrompt
Aprompt isaquestion oranytextinput thatyouprovide totheCisco AIAssistant toinitiate aconversation
orrequest information. Essentially ,it'sthequestion youpose totheAIAssistant .Theway youformat and
construct your prompt plays acrucial roleindetermining theresponse from theAIAssistant .
KeyComponents ofaprompt:
•Clarity :Beclear andspecific about what you're asking for.
•Context :Provide necessary background information.
•Purpose :State what youwant toachieve with your prompt.
Examples ofEffective Prompts
What’ sthedifference? Effective Prompt General Prompt
General prompt -Without
indicating theneed for"both" or
"all" attributes explicitly ,the
assistant might provide default
information oneither IPsorports,
notboth.
Effecti veprompt -This prompt is
clear anduses thekeyword
"distinct" tospecify theneed for
unique values, which aligns with
theAIAssistant capabilities.Canyouprovide mewith the
distinct IPaddresses thatare
currently blocked byourfirewall
policies?What aretheIPaddresses andports
currently being blocked?
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
9Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Prompt Guide forCisco AIAssistant

What’ sthedifference? Effective Prompt General Prompt
General prompt -This is
overloaded with requests andlacks
clarity onwhether allattributes are
needed together ,leading to
potential confusion fortheAI
Assistant .
Effecti veprompt -This clearly
states therequirement formultiple
attributes byusing "both," ensuring
theassistant understands toinclude
allrequested information.Ineed both thenames and
descriptions ofallactive firewall
rules. Please include both attributes
intheoutput.Tellmethefirewall rules, who set
them, andallthechanges made last
month.
General prompt -This combines
questions about rules andupdating
procedures, which canlead to
incomplete orinaccurate responses
duetolackofcontext orspecificity .
Effecti veprompt -Theisspecific
about theneed foralistofrules and
their actions, making ita
straightforward request fortheAI
Assistant .Show mealistofallfirewall rules
along with their corresponding
actions forthepastweek.What arethefirewall rules forIP
addresses XandY,andhow doI
update them?
General prompt -This is
ambiguous anddoes notusethe
provided keywords inamanner that
theAIAssistant caneffectively
interpret.
Effecti veprompt -This approach
helps maintain context andensures
each question isaddressed
accurately .Initial Question: What arethe
current firewall rules?
Follow-Up Question: Canyoualso
provide theactions associated with
these rules?Give meeverything butonly the
names.
General prompt -This istoo
vague andlacks detail. TheAI
Assistant isunable todetermine
which specific policy theuser is
requesting information about.
Effecti veprompt -This informs
theAIAssistant theuser needs
details forEdge ACP access policy .
TheAIAssistant willrespond with
alltherelevant details.Iwant tounderstand myEdge ACP
access control policy ,canyoutell
memore about it?Tellmeeverything about the
policies onmyaccount.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
10Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Prompt Guide forCisco AIAssistant

What’ sthedifference? Effective Prompt General Prompt
General prompt -This lacks
specificity ,combining multiple
complex requests without clear
instructions, andassuming theAI
Assistant hasimplicit knowledge
ofhow toaggregate andpresent the
data. This leads topotential
misunderstandings andresponses
thatmay notmeet user
expectations.
Effecti veprompt -This approach
helps maintain context andprovides
theassistant with clear instructions.InEdge ACP policy ,what ports and
protocols areconfigured inthe
rules? Include thecounts ofthe
number ofrules using itandsort
largesttosmallest.Show meports, protocols, andrule
counts inEdge ACP policy ,biggest
tosmallest.
Guidelines forCrafting Effective Prompts
Byproviding precise input andcontext, yousignificantly increase thechances ofreceiving atargeted, relevant,
anduseful answer from theAIAssistant
•BeSpecif icandprovide context: Draft your with relevant information, usethecorrect device names,
policy names, etc.thatcould help theAIAssistant understand your request better .
•UseProper Syntax: While AIAssistant canunderstand colloquial language, clear andgrammatically
correct sentences canimprove response accuracy .
•Clarify theDesir edOutput: Ifyouhave apreference fortheresponse format (e.g., alist,adetailed
explanation, tables), mention it.
•Corr ection andFeedback: Iftheresponse doesn't meet your expectations, youcanprovide feedback
oraskforclarification within your next .
•DirectNaming Requests: Usethephrase "give meonly thenames" toinstruct theAIAssistant toprovide
solely names initsresponse. Forexample, ifauser wants toknow thenames offirewall rules orpolicy
names without additional details, they canusethephrase 'give meonly thenames offirewall rules' to
instruct theAIAssistant toprovide solely thenames initsresponse.
•Unique Values: Employ thekeyword "unique" torequest unique values from theAIAssistant .
•Rules andActions: When requesting information about rules, users canspecify which attributes they
want toinclude intheresponse forcomprehensive insights. Forexample, ifauser wants toknow about
firewall rules allowing access toaspecific zone, they canspecify additional attributes such astheaction
(e.g., allow ordeny) andanyrelevant source zones. Byproviding specific instructions, users cantailor
theresponse totheir exact requirements andgain deeper insights intotheconfiguration. This approach
allows users toobtain more relevant andactionable information from theAIAssistant .
•Sequential Questioning: Formultiple inquiries, pose them asseparate, follow-up questions toenhance
clarity andcontext, rather than combining them intoasingle complex .
•Explicit Multi-Attrib uteQueries: Clearly state "Both" or"allofthefollowing" when seeking multiple
attributes; otherwise, theAIAssistant might select anattribute atrandom torespond to.Forexample,
when querying about firewall rules, attributes could include details such astherulename, description,
action (e.g., allow ordeny), source IPaddresses, destination IPaddresses, ports, protocols, etc.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
11Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Prompt Guide forCisco AIAssistant

Inthecontext ofmulti-attribute queries, itmeans requesting information about multiple characteristics
orproperties simultaneously .Forinstance, auser might want toknow both thenames anddescriptions
offirewall rules, orthey might beinterested inthesource IPaddresses anddestination ports ofnetwork
traffic.
Create Policy Rules
TheAIAssistant simplifies policy rulecreation process fortheSecure Firewall Threat Defense managed by
cloud-delivered Firewall Management Center andminimizes theneed forextensive technical knowledge or
manual configuration. Byleveraging Prompt Guide forCisco AIAssistant ,administrators canquickly establish
robust security measures, enhancing theoverall efficiency andsecurity oftheir network. These rules once
created arelisted under thepolicies section inyour tenant.
Example Scenario
Consider ascenario where anadministrator receives thefollowing request:
RickMiles canaccess Facebook onhiswork computer only fromtheoffice.
This would betheprocess theadministrator would follow tocreate therule:
Procedure
Step 1 Theadministrator needs tocreate anew ruletoaccommodate thisrequest. They putthisrequest totheAI
Assistant:
Step 2 TheAIAssistant asks aquestion tobetter understand theadministrator ’srequirement, andthen guides them
through aselection ofoptions tocreate therule:
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
12Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Create Policy Rules

Step 3 TheAIAssistant finds multiple results forFacebook, andasks theadministrator toclarify ifthey arereferring
toFacebook asanapplication, URL oraZone:
Step 4 TheAIAssistant prompts theadministrator toselect thepolicy towhich therulewillbeadded:
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
13Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Create Policy Rules

Step 5 TheAIAssistant suggests a“Rule Name”, which theadministrator canmodify ifneeded:
Iftheadministrator chooses a“Rule Name” thatalready exists inapolicy ,theassistant displays an
error prompting theadministrator toenter anew name.Note
Step 6 TheAIAssistant prompts theadministrator toselect a“User name” anda“Category” fortherule:
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
14Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Create Policy Rules

Step 7 TheAIAssistant requests confirmation forrulecreation andprovides asummary oftheadministrator's request
along with theinputs fortherule:
Theadministrator canedittheruleinformation byclicking Edit andcancel theprocess ofrulecreation
byclicking Cancel .Note
Step 8 Assuming thattheadministrator confirms “Yes”forrulecreation, theruleiscreated andwillbereflected in
thepolicy theadministrator chose:
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
15Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Create Policy Rules

Ifyouareunable tocreate apolicy rule, refer toCisco AIAssistant Frequently Asked Questions (FAQ),
onpage 16.Note
Cisco AIAssistant Frequently Asked Questions (FAQ)
Q.What istheCisco AIAssistant ?
A. TheCisco AIAssistant isanapplication thatanswers questions about existing configurations onyour
Secure Firewall Threat Defense device andhow tomanage those devices inthecloud-delivered Firewall
Management Center .
Q.What cantheAIAssistant help youwith?
A. TheAIAssistant answers questions about how toconfigure your Secure Firewall Threat Defense
devices.•
•TheAIAssistant answers questions about how toconfigure access control andother security policies.
•TheAIAssistant simplifies theconfiguration foraquicker ,easier policy rulebuilding.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
16Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Cisco AIAssistant Frequently Asked Questions (FAQ)

•TheAIAssistant helps diagnose andtroubleshoot firewall-related issues.
Q.How doyouaccess theAIAssistant ?
A. TheAIAssistant isintegrated with Cisco Defense Orchestrator andcloud-delivered Firewall Management
Center .Toaccess theAIAssistant click theAIAssistant button (
 )ontheCDO orcloud-delivered
Firewall Management Center home page.
Q.What doIdoifaresponse iswrong?
A. Click thefeedback option toreport incorrect information.
Q.How doIasktheAIAssistant aquestion?
A. Click theAIAssistant button (
 )onCisco Defense Orchestrator orcloud-delivered Firewall
Management Center home page andtype your question textbox.
Q.What subjects canIaskabout?
A. YoucanasktheAIAssistant about your configured firewall devices, policies, andsettings; andask
questions about how toconfigure your firewall.
Q.What subjects canIaskabout?
A. YoucanasktheAIAssistant about your configured firewall devices, policies, andsettings; andask
questions about how toconfigure your firewall.
Q.IstheCisco AIAssistant Secure?
A. Yes.TheCisco AIAssistant implemented onyour CDO tenant only hasaccess totheinformation and
security policies onyour tenant andyour cloud-delivered Firewall Management Center ,ifyouhave
implemented thatfeature. TheAIAssistant cannot “learn” about policies onother CDO tenants andso,
can’tanswer questions about other CDO tenants orintegrate information from them.
Q.What isCisco's data privacy policy?
A. This isCisco's Online Privacy Statement intheCisco's TrustCenter .
Q.CanIusetheAIAssistant tocreate rules?
A. Yes,youcanusetheAIAssistant tocreate rules. TheAIAssistant provides auser-friendly interface
with simple prompts thatguide youthrough therulecreation process. Itensures accuracy andefficiency ,
allowing youtoseamlessly integrate andmanage policy rules within your workflow .
Q.What types ofrules aresupported bytheAIAssistant?
A. Currently ,theAIAssistant supports theAccess Control Policy Rules. Youcancreate ruletoAllow ,
block ,BLOCK_RESET .Administrators canrequest specific details about Access Rule policies fortheir
tenant.
Q.TheAIAssistant isunable tocreate arule, how doIfixthis?
A. TheAIAssistant isunable tocreate apolicy rule:
•Object notfound: IftheAIAssistant cannot findthespecified object name within thetenant, it
willprompt theadmin toverify theobject name andtryagain. Werecommend providing theassistant
with anupdated prompt thatincludes thecorrect object name.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
17Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Cisco AIAssistant Frequently Asked Questions (FAQ)

•Incomplete Request :TheAIAssistant requires complete andaccurate information tocreate arule.
Forabetter understanding, please refer tothetable below:
A.Required Object
(Theuser must provide atleast oneofthese objects
togive theAIAssistant better context forrule
creation. )Object provided bytheuser
•Destination Zone
•Destination Network
•Destination Port
•Destination Dynamic Attribute
•Application
•URL•Source Zone
•Source Network
•Source Dynamic Attribute
•Destination Zone
•Destination Network
•Destination Port
•Destination Dynamic Attribute
•Application
•URLUser
•Source Zone
•Source Network
•Source Dynamic Attribute
•User
•Application
•URL•Destination Zone
•Destination Network
•Destination Port
•Destination Dynamic Attribute
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
18Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Cisco AIAssistant Frequently Asked Questions (FAQ)

Required Object
(Theuser must provide atleast oneofthese objects
togive theAIAssistant better context forrule
creation. )Object provided bytheuser
•Source Zone
•Source Network
•Source Dynamic Attribute
•User
•Destination Zone
•Destination Network
•Destination Port
•Destination Dynamic Attribute•Application
•URL
Q.DoIneed topaytousetheCisco AIAssistant forFirewall?
A. TheCisco AIAssistant iscurrently available forearly customer evaluation atnocost. During thisrollout
phase, usage isfreeofcharge.However ,Cisco plans toinclude theproduct intheGeneral Price List
(GPL) inthefuture. After general availability ,Cisco reserves theright torequire customers topurchase
asubscription tocontinue using theproduct.
Q.Arethere anylimitations onfeatures andfunctionality during theabove -mentioned initial customer
evaluation period?
A. No,there arenoplanned limitations ontheusage ofavailable functionality .During theearly availability
period, youwillhave fullaccess toallfeatures andfunctionalities oftheproduct. However ,Cisco will
monitor usage levels andmay,atitssolediscretion, restrict orlimit usage, aswell asaddorremove
features andfunctionalities during thisevaluation phase.
Q.What happens ifIchoose nottosubscribe and/or donotpayfortheproduct after theabove-mentioned
period?
A. Ifyouchoose nottosubscribe, your access totheCisco AIAssistant forFirewall willbelimited or
discontinued inaccordance with ourpolicy .Youwillhave theoption toreactivate your subscription at
anytime.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
19Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Cisco AIAssistant Frequently Asked Questions (FAQ)

Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
20Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
Cisco AIAssistant Frequently Asked Questions (FAQ)

PARTII
Onboard Devices toCloud-delivered Firewall
Management Center
•Onboard anFTD totheCloud-delivered Firewall Management Center ,onpage 23
•Migrate On-Prem Management Center Managed Secure Firewall Threat Defense toCloud-delivered
Firewall Management Center ,onpage 49
•Device Management ,onpage 73
•Change Management ,onpage 149
•Users ,onpage 161
•Configuration Deployment ,onpage 169

CHAPTER 3
Onboard anFTD totheCloud-delivered Firewall
Management Center
Read thefollowing information foronboarding prerequisties andprocedures.
•Onboarding Overview ,onpage 23
•Prerequisites toOnboard aDevice toCloud-delivered Firewall Management Center ,onpage 24
•Onboard aDevice with aCLIRegistration Key,onpage 25
•Onboard aDevice with Zero-T ouch Provisioning ,onpage 27
•Deploy aThreat Defense Device with AWS,onpage 28
•Deploy aThreat Defense Device inAzure ,onpage 30
•Deploy aThreat Defense Device toGoogle Cloud Platform ,onpage 33
•Onboard aSecure Firewall Threat Defense Cluster ,onpage 36
•Delete Devices from Cloud-delivered Firewall Management Center ,onpage 37
•About Device Interfaces ,onpage 38
•Troubleshooting ,onpage 41
Onboarding Overview
Review thefollowing usecases andsupported sofware versions thatarecompatible with cloud-delivered
Firewall Management Center management.
Youmust ensure thatthethreat defense device ports have external andoutbound access forthecloud-delivered
Firewall Management Center toonboard them. There isnorequirement foranon-premises orcloud-based
Security Device Controller (SDC) forthisoperation. Formore information, seeNetwork Requirements .
Tosend threat defense Syslog events totheCisco cloud, youcansetuptheSecure Event Connector (SEC).
Formore information, seeInstalling Secure Event Connectors .Note
Threat Defense Devices Currently Managed byCloud-delivered Firewall Management Center
Thefollowing scenarios occur when youeither move ormigrate adevice tothecloud-delivered Firewall
Management Center :
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
23

•Ifyoudelete adevice from anon-prem management center orSecure Firewall Threat Defense device
manager toonboard tothecloud-delivered Firewall Management Center ,thechange ofmanagers wipes
anypolicies configured through theon-prem management center .
•Ifyoumigrate adevice from anon-prem management center tothecloud-delivered Firewall Management
Center ,thedevice retains themajority ofyour previously configured policies.
Ifyoudonotknow ifyour device isalready managed byanalternative manager ,usetheshowmanagers
command inthedevice's CLI.Note
Onboarding Methods
Cloud-delivered Firewall Management Center supports thefollowing onboarding methods:
•Onboard aDevice with aCLIRegistration Key -Onboard adevice with aregistration key.Theinitial
device setup wizard iscomplete onthedevice.
•Onboard aDevice with Zero-T ouch Provisioning -Onboard anew factory-shipped device with itsserial
number .Note thatthismethod only supports Firepower 1000 ,Firepower 2100 ,orSecure Firewall 3100
devices.
Version 7.0.3 does notsupport zero-touch provisioning . Note
Prerequisites toOnboard aDevice toCloud-delivered Firewall
Management Center
Onboard Limitations and Requirements
Beaware ofthefollowing limitations when onboarding adevice tothecloud-delivered Firewall Management
Center :
•Devices must berunning version 7.0.3, orversion 7.2andlater.Westrongly recommend version 7.2
orlater.
•Youcanmigrate anHApairthatismanaged byanOn-Prem Firewall Management Center byfollowing
theMigrate FTD toCloud-Delivered Firewall Management Center process. Confirm both peers areina
healthy state prior tomigrating.
•Only devices thatareconfigured forlocal management andaremanaged byadevice manager canbe
onboarded with theserial number andzero-touch provisioning methods.
•Ifthedevice ismanaged byanon-prem management center ,youcaneither onboard thedevice to
cloud-delivered Firewall Management Center ormigrate thedevice. Migrating retains anyexisting
policies andobjects, whereas onboarding thedevice removes most policies andallobjects. SeeMigrate
FTD toCloud-Delivered Firewall Management Center formore information.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
24Onboard Devices toCloud-delivered Firewall Management Center
Prerequisites toOnboard aDevice toCloud-delivered Firewall Management Center

•Ifyour device iscurrently managed byadevice manager ,unregister allyour smart licenses before you
onboard thedevice. Even ifyouswitch device management, theCisco Smart Software Manager will
retain thesmart licenses.
•Ifyouhave previously onboarded adevice thatwasmanaged byadevice manager anddeleted thedevice
from CDO with theintention ofre-onboarding forcloud management, youmust register thedevice
manager totheSecurity Services Exchange cloud after deleting thedevice. Seethe"Access Security
Services Exchange" chapter intheFirepower andCisco Secur eXThreatResponse Integration Guide .
Onboarding adevice tothecloud-delivered Firewall Management Center removes anypolicies andmost
objects configured through theprevious manager .Ifyour device iscurrently managed byanon-prem
management center ,itispossible tomigrate thedevice andretain your policies andobjects. SeeMigrate FTD
toCloud-Delivered Firewall Management Center formore information.Tip
Network Requirements
Before youonboard adevice, ensure thefollowing ports have external andoutbound access. Confirm the
following ports onthedevice areallowed. Ifcommunication ports areblocked behind afirewall, onboarding
thedevice may fail.
Youcannot configure these ports intheCDO UI.Youmust enable these ports through thedevice's SSH. Note
Table 1:Device Port Requirements
Details Protocol /Feature Port
Send andreceive data from the
internet.HTTPS 443/tcp
Communicate with theAMP cloud
(public orprivate)HTTPS 443
Securely communicate between
appliances inadeployment.Appliance communications 8305/tcp
Management and Data Interfaces
Make sure your device iscorrectly configured with either amanagement ordata interface.
Toconfigure amanagement ordata interface onyour device, seeComplete theInitial Configuration ofa
Secure Firewall Threat Defense Device Using theCLI,onpage 2690 .
Onboard aDevice with aCLIRegistration Key
Usetheprocedure below toonboard adevice forcloud-delivered Firewall Management Center with aCLI
registration key.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
25Onboard Devices toCloud-delivered Firewall Management Center
Onboard aDevice with aCLIRegistration Key

Ifyour device iscurrently managed byanon-prem management center ,onboarding thedevice willfail.You
caneither delete thedevice from theon-prem management center andonboard asafresh, new device with
nopolicies orobjects, oryoucanmigrate thedevice andretain theexisting policies andobjects. SeeMigrate
FTD toCloud-Delivered Firewall Managmenet Center formore information.Note
Youcancreate aCDO -managed, standalone logical threat defense device using theSecure Firewall chassis
manager ortheFXOS CLI.Important
Before you begin
Before youonboard adevice, besure tocomplete thefollowing tasks:
•Cloud-delivered Firewall Management Center isenabled foryour tenant.
•Confirm thedevice's CLIconfiguration issuccessfully completed. SeeComplete theInitial Configuration
ofaSecure Firewall Threat Defense Device Using theCLI,onpage 2690 formore information.
•Review theprerequesites andlimitations before youonboard thedevice. See"Prerequisites toOnboard
aDevice toCloud-delivered Firewall Management Center "inManaging Firewall Threat Defense with
Cloud-Delivered Firewall Management Center inCisco Defense Orchestrator formore information.
•Thedevice canbeconfigured foreither local management with Secure Firewall device manager orremote
management with Secure Firewall Management Center .
•Device must berunning version 7.0.3, or7.2.0 andlater.
•Youhave reset thedevice's SSH password aspartofthebootstrap process. Ifyouhave younotreset the
SSH password, CDO recommends using theOnboard aDevice with Zero-T ouch Provisioning ,onpage
27method
Procedure
Step 1 LogintoCDO .
Step 2 Intheleftpane, click Inventory .
Step 3 Inthetop-right corner ,click Onboard (
 ).
Step 4 Click theFTD tile.
Step 5 Under Management Mode ,ensure youselect FTD .Byselecting FTD under Management Mode ,youwill
notbeable tomanage thedevice using theprevious management platform. Allexisting policy configurations
except forinterface configurations willbereset. Youmust re-configure policies after youonboard thedevice.
Step 6 Select UseCLI Registration Keyastheonboarding method.
Step 7 Enter thedevice name intheDevice Name field andclick Next .
Step 8 InthePolicy Assignment step, usethedrop-down menu toselect anaccess control policy todeploy once
thedevice isonboarded. Ifyouhave nopolicies configured, select theDefault Access Contr olPolicy .
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
26Onboard Devices toCloud-delivered Firewall Management Center
Onboard aDevice with aCLIRegistration Key

Step 9 Specify whether thedevice youareonboarding isaphysical orvirtual device. Ifyouareonboarding avirtual
device, youmust select thedevice's performance tierfrom thedrop-down menu.
Step 10 Select thesubscription licenses youwant toapply tothedevice. Click Next .
Step 11 CDO generates acommand with theregistration key.Connect tothedevice youareonboarding using SSH.
Loginas"admin" orauser with equivalent admin privileges andpaste theentire registration keyasisinto
thedevice's CLI.
Note: ForFirepower 1000 ,Firepower 2100 ,ISA3000 ,andthreat defense virtual devices, open anSSH
connection tothedevice andloginasadmin .Copy theentire registration command andpaste itintothe
device's CLIinterface attheprompt. IntheCLI, enter Ytocomplete theregistration. Ifyour device was
previously managed bydevice manager ,enter Yestoconfirm thesubmission.
Step 12 Click Next intheCDO onboarding wizard.
Step 13 (Optional) Add labels toyour device tohelp sortandfilter theInventory page. Enter alabel andselect the
blue plus button. Labels areapplied tothedevice after it'sonboarded toCDO .
What todonext
Once thedevice issynchronized, select thedevice youjustonboarded from theInventory page andselect
anyoftheoptions listed under theDevice Management pane located totheright. Westrongly recommend
thefollowing actions:
•Ifyoudidnotalready ,create acustom access control policy tocustomize thesecurity foryour environment.
SeeAccess Control Overview inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall
Mana gement Center inCisco Defense Orchestr ator formore information.
•Enable Cisco Security Analytics andLogging (SAL) toview events intheCDO dashboard orregister
thedevice toanSecure Firewall Management Center forsecurity analytics. SeeCisco Security Analytics
andLogging inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall Mana gement Center
inCisco Defense Orchestr ator formore information.
Onboard aDevice with Zero-T ouch Provisioning
Only theFirepower 1000 ,Firepower 2100 ,andSecure Firewall 3100 devices canbeonboarded with the
zero-touch provisioning method.
Before you begin
Confirm thefollowing iscompleted prior toonboarding:
•Youhave aCDO tenant. Ifyoudonot,seeRequest aCDO Tenant formore information.
•Cloud-delivered Firewall Management Center isenabled foryour tenant.
•Thedevice isfreshly installed buthasnever been logged intobyeither thedevice CLI, amanagement
center ,orthedevice manager .
•Thedevice isrunning version 7.2orlater.Version 7.0.3 does notsupport zero-touch provisioning .
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
27Onboard Devices toCloud-delivered Firewall Management Center
Onboard aDevice with Zero-T ouch Provisioning

Procedure
Step 1 LogintoCDO .
Step 2 Intheleftpane, click Inventory .
Step 3 Inthetop-right corner ,click Onboard (
 ).
Step 4 Click theFTD tile.
Step 5 Under Management Mode ,ensure youselect FTD .Byselecting FTD under Management Mode ,youwill
notbeable tomanage thedevice using theprevious management platform. Allexisting policy configurations
except forinterface configurations willbereset. Youmust re-configure policies after youonboard thedevice.
Step 6 Click theUseSerial Number tile.
Step 7 Select cloud-delivered Firewall Management Center from thedrop-down list.Click Next .
Step 8 Enter theDevice Serial Number andtheDevice Name .Select Next .
Step 9 Choose anoption depending onwhether thedevice islogged intoandconfigured foramanager:
•Ifyour device isbrand new andhasnever been configured foramanager ,click Yes,thisnew device
hasneverbeen logged into orconfiguredforamanager .
•Ifyour device hasbeen previously registered foramanager orisstillregistered toamanager ,click No,
thisdevice hasbeen logged into andconfiguredforamanager .
Step 10 Click Next .
Step 11 InthePolicy Assignment step, usethedrop-down menu toselect anaccess control policy todeploy once
thedevice isonboarded. Ifyouhave nopolicies configured, select theDefault Access Contr olPolicy .
Step 12 Select thesubscription licenses youwant toapply tothedevice. Click Next .
What todonext
Once thedevice issynchronized, select thedevice youjustonboarded from theInventory page andselect
anyoftheoptions listed under theDevice Management pane located totheright. Westrongly recommend
thefollowing actions:
•Ifyoudidnotalready ,create acustom access control policy tocustomize thesecurity foryour environment.
SeeAccess Control Overview inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall
Mana gement Center inCisco Defense Orchestr ator formore information.
•Enable Cisco Security Analytics andLogging (SAL) toview events intheCDO dashboard orregister
thedevice toanSecure Firewall Management Center forsecurity analytics. SeeCisco Security Analytics
andLogging inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall Mana gement Center
inCisco Defense Orchestr ator formore information.
Deploy aThreat Defense Device with AWS
Usethefollowing procedure toonboard andpreliminarily provision thefirewall ofathreat defense device
thatisassociated with anAWSVPC tobemanaged bycloud-delivered Firewall Management Center .
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
28Onboard Devices toCloud-delivered Firewall Management Center
Deploy aThreat Defense Device with AWS

Before you begin
Confirm thefollowing prerequisites arefulfilled prior togenerating avirtual threat defense anddeploying to
anAWSenvironment:
•Youmust have thecloud-delivered Firewall Management Center feature enabled andassociated with
your tenant.
Procedure
Step 1 LogintoCDO .
Step 2 Inthenavigation pane, click Inventory andclick theblue plus button.
Step 3 Select theFTD tile.
Step 4 Under Management Mode ,besure FTD isselected.
Step 5 Select UseAWSVPC astheonboarding method. Ifthere isnoAWSVPC already onboarded, youcanclick
theprovided linkfrom thisstepandonboard thevirtual environment.
Step 6 Select theavailability zone from thedrop-down menu. Select thezone where thecloud threat defense is
located, andnotwhere your local computer islocated.
Step 7 Select themanagement interface subnet with either ofthefollowing options:
•Useexisting subnets -Expand thedrop-down menus andselect theappropriate subnets forthe
management interface, inside interface, andoutside interface subnets.
•Create new subnets -Add asetofsubnet interfaces forthedevice touseonce onboarded. Cisco Defense
Orchestrator automatically creates these subnets andapplies them totheAWSVPC aspartofthe
onboarding procedure.
Note thatthediagnostic interface willusethesame interface asthemanagement interface.
Step 8 Click Select toassign thesubnets. Click Next .
Step 9 Enter thedevice name intheDevice Name field andclick Next .
Step 10 InthePolicy Assignment step, usethedrop-down menu toselect anaccess control policy todeploy once the
device isonboarded. Ifyouhave nopolicies configured, select theDefault Access Contr olPolicy .
Step 11 Select theSubscription Licenses youwant applied tothedevice. Youmust have atleast theURL license
selected forvirtual threat defense devices.
What todonext
Itmay take afewminutes forthedevice toappear inCDO 'sInventory page asitcannot synchronize until
CDO hassuccessfully deployed thecloud formation, initliaized thedevice connections, andestablished
communication with both thevirtual device andtheAWSVPC environment.
Ifnecessary ,youcanmodfiy thevirtual threat defense device performance tierselection after onboarding
through thecloud-delivered Firewall Management Center UI.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
29Onboard Devices toCloud-delivered Firewall Management Center
Deploy aThreat Defense Device with AWS

Deploy aThreat Defense Device inAzure
This isatwo-part process thatinvolves onboarding anAzure account toCDO aswell asgenerating avirtual
threat defense andsimultaneously deploying ittoyour Azure instance.
Onboard anAzure VNet Environment
Usethefollowing procedure toonboard anAzure VNet forcloud-delivered Firewall Management Center
management:
Before you begin
Youmust have thefollowing completed prior tothisonboarding procedure:
•Cloud-delivered Firewall Management Center isenabled foryour tenant.
•Youmust have atleast oneresource group available inyour Azure account with anempty Azure VNet
instance. Ifyoudonothave aresource group tohost thevirtual device, create onewith theAzure portal.
SeeMicrosoft Azure's Manage Azur eresour cegroups byusing theAzur eportal guide formore
information.
•Yourresource group intheAzure portal must have avirtual network created forthevirtual device. If
youdonothave one, create oneintheAzure portal. SeeMicrosoft Azure's Create avirtual netw ork
using theAzur eportal quickstart guide formore information.
•Youmust register Cisco Defense Orchestrator toyour Microsoft account toensure successful
communication between Azure andCDO .Seethe"Quickstart: Register anapplication with theMicrosoft
identity platform" section oftheAzure product documentation formore information.
•Youmust assign abuilt-in role, orcreate acustom role, within theAzure environment andassign ita
member orgroup thatwillaccess both Azure andCDO .Seethe"Azure custom role" section orthe
"Azure custom roles" oftheAzure product documentation formore information.
•Youmust enable allofthefollowing permissions intheAzure environment inorder tosuccessully
communicate with andonboard toCDO :
"Microsoft.Network/virtualNetworks/write"
"Microsoft.Network/virtualNetworks/join/action"
"Microsoft.Network/virtualNetworks/subnets/read"
"Microsoft.Network/virtualNetworks/subnets/write"
"Microsoft.Network/virtualNetworks/subnets/prepareNetworkPolicies/action"
"Microsoft.Network/networkSecurityGroups/read"
"Microsoft.Network/networkSecurityGroups/write"
"Microsoft.Network/networkSecurityGroups/join/action"
"Microsoft.Network/networkSecurityGroups/securityRules/write"
"Microsoft.Network/networkSecurityGroups/securityRules/read"
"Microsoft.Network/networkSecurityGroups/securityRules/delete"
"Microsoft.Storage/storageAccounts/write"
"Microsoft.Storage/storageAccounts/read"
"Microsoft.Resources/deployments/write"
"Microsoft.Resources/deployments/read"
"Microsoft.Network/publicIP Addresses/read"
"Microsoft.Network/publicIP Addresses/write"
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
30Onboard Devices toCloud-delivered Firewall Management Center
Deploy aThreat Defense Device inAzure

"Microsoft.Network/routeT ables/read"
"Microsoft.Network/routeT ables/write"
"Microsoft.Network/networkInterfaces/read"
"Microsoft.Network/networkInterfaces/write"
"Microsoft.Compute/virtualMachines/write"
"Microsoft.Resources/deployments/operationstatuses/read"
"Microsoft.Resources/subscriptions/resourcegroups/deployments/operationstatuses/read"
"Microsoft.Network/routeT ables/join/action"
"Microsoft.Network/virtualNetworks/subnets/join/action"
"Microsoft.Network/publicIP Addresses/join/action"
"Microsoft.Network/networkInterfaces/join/action"
"Microsoft.Compute/virtualMachines/read"
"Microsoft.Resources/subscriptions/resourceGroups/write"
"Microsoft.Resources/subscriptions/resourceGroups/delete"
Procedure
Step 1 Review theprerequisites listed above. Youmust register CDO toyour Microsoft account, create auser role,
andenable alltheapplicable permissions prior toonboarding avirtual environment.
Step 2 LogintoCDO .
Step 3 Inthenavigation pane, click Inventory andclick theblue plus button.
Step 4 Select theAzur eVNet tile.
Step 5 Enter thefollowing credentials tocontinue with theonboarding wizard, then click Next :
•Azur eTenant ID(Directory ID)-Adirectory IDisaunique identifier forthetenant intheworld of
Microsoft cloud services. There isonly onedirectory IDpertenant. Tolocate it,logintotheAzure portal
andnavigate toAzur eServices >Azur eActiveDirectory andlocate theTenant IDlisted onthatpage.
•Client ID(Application ID)-Anapplication IDisaunique identifier assigned toCDO byAzure AD
when theappwasregistered. Tolocate it,logintotheAzure portal andnavigate toAzur eServices >
Azur eActiveDirectory >AppRegistrations andview theapplication IDinthelistofapps. Ifthere
isnoapplication IDforCDO ,click New Registrations tocreate oneforthisonboarding procedure.
•Client Secret-Youmust manually request aclient secret, although theAzure portal auto-generates a
unique string toprotect your tenant. Tolocate it,logintotheAzure portal andnavigate toAzur eServices >
Azur eActiveDirectory >AppRegistrations ,then expand theapplication forCDO .Inthepanel on
theleft,click Certif icates &secrets.Ifthere isnosecret, click New client secrettocreate one. Copy
theValue entry forthisonboarding procedure, nottheSecret IDentry .
•Subscription ID-Asubscription isatenant-based agreement touseMicrosoft cloud services; inthis
case, Azure VNet. Thesubscription IDistheunique code associated between thetenant andthisparticular
cloud service. Tolocate it,logintotheAzure portal andnavigate toAzur eServices >Subscriptions .
Ifthere arenosubscriptions available forCDO ,click Add tocreate one.
Step 6 IntheCDO onboarding wizard, usethedrop-down menu toselect theAzur eVNet youwant toonboard.
Step 7 Enter theDevice Name andselect Next .This device name iswhat theAzure VNet isdisplayed asinthe
Inventory page.
Step 8 (Optional) Add labels toyour device tohelp sortandfilter theInventory page. Enter alabel andselect the
blue plus button. Labels areapplied tothedevice after it'sonboarded toCDO .
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
31Onboard Devices toCloud-delivered Firewall Management Center
Onboard anAzure VNet Environment

What todonext
Onboard avirtual device inCDO with thisinstance ofAzure VNet asthemanager .SeeDeploy aThreat
Defense Virtual inAzure ,onpage 32formore information.
Deploy aThreat Defense Virtual inAzure
Onboard athreat defense virtual forAzure thatismanaged bycloud-delivered Firewall Management Center .
TheAzure environment canonly support onethreat defense virtual .Toonboard multiple devices, youmust
have aseparate Azure instance foreach ofthose devices.
Before you begin
Ensure thatyouhave anactive Azure subscription.
Procedure
Step 1 LogintoCDO .
Step 2 Intheleftpane, click Inventory andclick theplus icon.
Step 3 Under Select aDevice orService Type,click theFTD tile.
Step 4 Under Management Mode ,ensure thatFTD isselected.
Byselecting FTD under Management Mode ,thedevice isreconfigured tousethecloud-delivered
Firewall Management Center asthemanager .Warning
Step 5 Click Deploy anFTD toacloud environment astheonboarding method.
Step 6 Choose Azur easyour cloud provider from thedrop-down list.
Step 7 (Optional) Ifyouhave notregistered your CDO account toanAzure subscription, youcandosonow.Click
Azur eCloud Shell tolaunch theAzure cloud shell andpaste thescript thatisprovided. Ifyouhave registered
your account orifyouhave completed executing thescript, click Next .
Step 8 Choose aRegion todeploy theAzure subscription from thedrop-down list.
Step 9 Enter theFTD Passw ordthatyouwish touseforSSH console access.
Step 10 Enter aDevice Name .This name isapplied tothethreat defense virtual intheInventory page andAzure
resource group.
Step 11 InthePolicy Assignment step, usethedrop-down menu toselect anaccess control policy todeploy once
thedevice isonboarded. Ifyouhave nopolicies configured, select theDefault Access Contr olPolicy .
Step 12 Select thelicenses youwant toapply tothedevice. Youmust select atleast theessential license asthebase
license forthisdevice. Click Next .
Step 13 Click Complete onboarding .
This completes theonboarding wizard. Itmay take upto20minutes forthedevice tofully onboard and
synchronize. Tomonitor thecreation process, expand theWorkflo wsoption oftheAzure subscription that
ishosting thedevice.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
32Onboard Devices toCloud-delivered Firewall Management Center
Deploy aThreat Defense Virtual inAzure

What todonext
Once thedevice issynchronized, select thedevice youjustonboarded from theInventory page andselect
anyoftheoptions listed under theDevice Management pane located totheright. Westrongly recommend
thefollowing actions:
•Ifyoudidnotalready ,create acustom access control policy tocustomize thesecurity foryour environment.
SeeAccess Control Overview inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall
Mana gement Center inCisco Defense Orchestr ator formore information.
•Enable Cisco Security Analytics andLogging (SAL) toview events intheCDO dashboard orregister
thedevice toanSecure Firewall Management Center forsecurity analytics. SeeCisco Security Analytics
andLogging inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall Mana gement Center
inCisco Defense Orchestr ator formore information.
Deploy aThreat Defense Device toGoogle Cloud Platform
Deploy athreat defense device onyour Google Cloud Platform (GCP) account toprotect your Google Cloud
workloads. Thesecurity policy forthisdevice willbemanaged onyour cloud-delivered Firewall Management
Center .
Youmust firsthave aGCP account, aGCP project created, andseveral networks established foreffective
communication between cloud-delivered Firewall Management Center andGCP.Once youhave established
theGCP settings, onboard athreat defense device tobedeployed totheGCP.
Usethefollowing procedures toonboard anddeploy athreat defense device toGCP.
Create VPC Networks forGCP
Thethreat defense virtual deployment requires four networks which youmust create prior todeploying the
threat defense virtual. Thenetworks areasfollows:
•Management VPC forthemanagement subnet.
•Diagnostic VPC orthediagnostic subnet.
•Inside VPC fortheinside subnet.
•Outside VPC fortheoutside subnet.
Additionally ,youmay have tosetuptheroute tables andGCP firewall rules toallow trafficflow through the
threat defense virtual. Theroute tables andfirewall rules areseparate from those thatareconfigured onthe
threat defense virtual itself. Name theGCP route tables andfirewall rules according toassociated network
andfunctionality
Procedure
Step 1 IntheGCP console, choose VPC netw orks ,then click Create VPC Netw ork.
Step 2 IntheName field, enter thedesired name.
Step 3 From theSubnet creation mode, click Custom .
Step 4 IntheName field under New subnet ,enter thedesired name.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
33Onboard Devices toCloud-delivered Firewall Management Center
Deploy aThreat Defense Device toGoogle Cloud Platform

Step 5 From theRegion drop-down list,select theregion appropriate foryour deployment. Allfour networks must
beinthesame region.
Step 6 From theIPaddr essrange field, enter thefirstnetwork's subnet inCIDR format, such as10.10.0.0/24.
Step 7 Accept thedefaults forallother settings, then click Create.
Step 8 Repeat steps 1-7tocreate theremaining three VPC networks.
What todonext
Youmay have tocreate firewall rules toapply toyour newly created VPC networks. GototheGCP console
andnavigate toNetw orking >VPC netw ork>Firewall andthen click Create Firewall Rule .SeeGCP
documentation formore information.
Once your GCP VPC networks have been finalized, continue ontodeploy thethreat defense virtual.
Deploy aThreat Defense Device onGoogle Cloud Platform
Before you begin
When youperform thisprocedure, Cisco Defense Orchestrator creates thethreat defense virtual aspartofthe
onboarding wizard. Youcannot usethisprocedure with physical threat defense device oradevice thatis
already onboarded toCDO .
Thefollowing prerequisites must bemetprior toonboarding athreat defense thatiscurrently associated with
aGoogle Cloud Platform (GCP) environment:
•Youmust have cloud-delivered Firewall Management Center enabled foryour tenant.
•Youmust have aGCP account andalready have aproject created. SeeGCP documentation formore
information.
•Management interfaces (2)—One used toconnect thethreat defense virtual tothemanagement center ,
second used fordiagnostics; cannot beused forthrough traffic.
Trafficinterfaces (2)—Used toconnect thethreat defense virtual toinside hosts andtothepublic
network. SeeCreate VPC Networks forGCP ,onpage 33formore information.
•Youmust enable allofthefollowing permissions intheGCP environment inorder tosuccessully
communicate with andonboard toCDO :
deploymentmanager .deployments.create
deploymentmanager .deployments.get
compute.networks.list
Procedure
Step 1 LogintoCDO .
Step 2 Inthenavigation pane, click Inventory andclick theblue plus button (+)toaddanew device.
Step 3 Select theFTD tile.
Step 4 Under Management Mode ,select FTD .
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
34Onboard Devices toCloud-delivered Firewall Management Center
Deploy aThreat Defense Device onGoogle Cloud Platform

Step 5 Select UseGCP VPC astheonboarding method.
Step 6 IFyouhave notauthenticated your GCP environment with CDO before thispoint, copy thebash command
thatCDO generates andrunitonyour bash environment orontheGoogle Cloud Shell toauthenticate your
GCP account andallow communication between theapplications. IFyouhave already authenticated your
GCP account prior ,ignore theaccount integration steps andclick Next .
Step 7 Usethedrop-down menu toselect theGCP project youwant toassociate with thedevice youaregoing to
onboard. Ifthere arenoprojects immeidately available, click +Link New Project .Ifyouclick +Link New
Project ,follow these steps:
a)Enter theGCP project IDwhen prompted. Locate thisvalue intheGCP UI.Tolocate theproject ID,see
GCP documentation .
b)Upload Credentials File. Click Browseandnavigate towhere thethe.JSON filegenerated from the
script inStep 1oftheonboarding wizard islocally stored. Select itandclick Save.
Step 8 Click Next .
Step 9 Usethedrop-down menus toselect thefollowing paramters andclick Next :
•Inside VPC
•Inside Sub Netw ork
•Outside VPC
•Outside Sub Netw ork
•Management VPC
•Management Sub Netw ork
•Diagnostic Netw ork
•Diagnostic Sub Netw ork
Step 10 Enter aname forthethreat defense device intheDevice Name field andclick Next .
Step 11 InthePolicy Assignment step, usethedrop-down menu toselect anaccess control policy todeploy once the
device isonboarded. Ifyouhave nopolicies configured inthecloud-delivered Firewall Management Center
associated with your CDO tenant, select theDefault Access Contr olPolicy .
Step 12 Select theSubscription Licenses youwant applied tothedevice. Youmust have atleast theURL license
selected forvirtual threat defense devices.
Step 13 Click Complete Onboarding .
What todonext
Navigate totheInventory page toview theprogress ofthedevice registration there. Once thedevice is
synchronized, westrongly recommend cross-launching tocloud-delivered Firewall Management Center and
customize your access control policy anddevice status.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
35Onboard Devices toCloud-delivered Firewall Management Center
Deploy aThreat Defense Device onGoogle Cloud Platform

Onboard aSecure Firewall Threat Defense Cluster
Ifyoumust delete acluster ,delete thecluster from theCDO Inventory page. SeeDelete Devices from
Cloud-delivered Firewall Management Center ,onpage 37formore information.Note
Thefollowing table provides information about device models thatsupport cluster onboarding andcreation
onthecloud-delivered Firewall Management Center :
Support cluster creation from
cloud-delivered Firewall
Management Center ?Minimum Secure Firewall
Threat Defense Version for
Cluster ManagementSecure Firewall Threat Defense Platforms
Yes 7.2.1 VMware, KVM
No 7.2.1 AWS, GCP
No 7.3 Azure
Yes 7.2.1 Secure Firewall 3100
No 7.0.6 Firepower 4100
Yes 7.4 Secure Firewall 4200
No 7.0.6 Firepower 9300
Before you begin
Read through thefollowing limitations:
•Firepower 4100 andFirepower 9300 devices must beclustered through thedevice's chassis manager .
•Secure Firewall 3100 devices, Secure Firewall 4200 devices, KVM, andVMware environments must
beclustered through theSecure Firewall Management Center UI.
•Azure, AWS, andGCP environment clusters must becreated through their own environment and
onboarded toSecure Firewall Management Center .
Procedure
Step 1 LogintoCDO .
Step 2 Intheleftpane, click Inventory .
Step 3 Click theFTD tile.
Step 4 Under Management Mode ,ensure youselect FTD .Byselecting FTD under Management Mode ,youwill
notbeable tomanage thedevice using theprevious management platform. Allexisting policy configurations
except forinterface configurations willbereset. Youmust re-configure policies after youonboard thedevice.
Step 5 Select UseCLI Registration Key.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
36Onboard Devices toCloud-delivered Firewall Management Center
Onboard aSecure Firewall Threat Defense Cluster

Step 6 Enter thedevice name intheDevice Name field andclick Next .
Step 7 InthePolicy Assignment step, usethedrop-down menu toselect anaccess control policy todeploy once
thedevice isonboarded. Ifyouhave nopolicies configured, select theDefault Access Contr olPolicy .
Step 8 Specify whether thedevice youareonboarding isaphysical orvirtual device. Ifyouareonboarding avirtual
device, youmust select thedevice's performance tierfrom thedrop-down menu.
Step 9 Select thesubscription licenses youwant toapply tothedevice. Click Next .
Step 10 CDO generates acommand with theregistration key.Paste theentire registration keyasisintothedevice's
CLI.
Step 11 (Optional) Add labels toyour device tohelp sortandfilter theInventory page. Enter alabel andselect the
blue plus button. Labels areapplied tothedevice after it'sonboarded toCDO .
What todonext
Once thedevice issynchronized, select thedevice youjustonboarded from theInventory page andselect
anyoftheoptions listed under theDevice Management pane located totheright. Westrongly recommend
thefollowing actions:
•Ifyoudidnotalready ,create acustom access control policy tocustomize thesecurity foryour environment.
SeeAccess Control Overview inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall
Mana gement Center inCisco Defense Orchestr ator formore information.
•Enable Cisco Security Analytics andLogging (SAL) toview events intheCDO dashboard orregister
thedevice toanSecure Firewall Management Center forsecurity analytics. SeeCisco Security Analytics
andLogging inMana ging Firewall ThreatDefense with Cloud-Deliver edFirewall Mana gement Center
inCisco Defense Orchestr ator formore information.
Delete Devices from Cloud-delivered Firewall Management
Center
Though devices may beregistered tocloud-delivered Firewall Management Center ,CDO stillmanages device
enrollment. Youmust delete thedevice from theCDO dashboard toremove adevice from cloud-delivered
Firewall Management Center .
CDO does notsynchronize thedeletion ofdevices thatareassociated with anAWSVPC environment. You
must delete adevice direclty from theAWSVPC UI.SeeAWSdocumentation formore information.Note
Procedure
Step 1 LogintoCDO andclick Inventory .
Step 2 Locate thedevice youwant todelete byusing thefilters orsearch bar.Select itsothedevice rowishighlighted.
Ifyour device ispartofahigh availability pair,locate andselect theactive device.
Step 3 IntheDevice Actions pane located totheright, click Remo ve.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
37Onboard Devices toCloud-delivered Firewall Management Center
Delete Devices from Cloud-delivered Firewall Management Center

Step 4 When prompted, select OKtoconfirm theremoval oftheselected device. Click Cancel tokeep thedevice
onboarded.
About Device Interfaces
Management Interfaces
When yousetupyour device, youspecify theIPaddress thatyouwant toconnect to.Both management and
event trafficgotothisaddress atinitial registration.
Insome situations, thedevice might establish theinitial connection onadifferent management interface;
subsequent connections should usethemanagement interface with thespecified IPaddress.Note
Ifthedevice hasaseparate event-only interface, themanaged device sends subsequent event trafficissentto
theevent-only interface ifthenetwork allows. Inaddition, some managed-device models include anadditional
management interface thatyoucanconfigure forevent-only traffic.
Note thatifyouconfigure adata interface formanagement, youcannot useseparate management andevent
interfaces.Note
Iftheevent network goes down, then event trafficreverts totheregular management interfaces onthethe
managed device.
About Data Interfaces
Youcanuseeither thededicated management interface oraregular data interface forcommunication with
thedevice. CDO access onadatainterface isuseful ifyouwant tomanage theFTD remotely from theoutside
interface, oryoudonothave aseparate management network. CDO supports high availability ontheFTD
managed remotely from thedata interface.
FTD management access from adata interface hasthefollowing limitations:
•Youcanonly enable manager access ononephysical, data interface. Youcannot useasubinterface or
EtherChannel.
•Routed firewall mode only,using arouted interface.
•PPPoE isnotsupported. Ifyour ISPrequires PPPoE, youwillhave toputarouter with PPPoE support
between theFTD andtheWANmodem.
•Theinterface must beintheglobal VRF only.
•SSH isnotenabled bydefault fordata interfaces, soyouwillhave toenable SSH later using CDO .
Because themanagement interface gateway willbechanged tobethedata interfaces, youalsocannot
SSH tothemanagement interface from aremote network unless youaddastatic route forthemanagement
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
38Onboard Devices toCloud-delivered Firewall Management Center
About Device Interfaces

interface using theconfigurenetw orkstatic-r outes command. ForFTDv onAmazon WebServices, a
console portisnotavailable, soyoushould maintain your SSH access tothemanagement interface: add
astatic route forManagement before youcontinue with your configuration. Alternatively ,besure to
finish allCLIconfiguration (including theconfiguremanager addcommand) before youconfigure the
data interface.
Network Routes onDevice Management Interfaces
Management interfaces (including event-only interfaces) support only static routes toreach remote networks.
When yousetupyour managed device, thesetup process creates adefault route tothegateway IPaddress
thatyouspecify .Youcannot delete thisroute; youcanonly modify thegateway address.
Ifyouconfigure adatainterface formanagement instead ofusing thededicated Management interface, traffic
isrouted over thebackplane tousethedata routing table. Theinformation inthissection does notapply .Note
Atleast onestatic route isrecommended permanagement interface toaccess remote networks. Werecommend
placing each interface onaseparate network toavoid potential routing problems, including routing problems
from other devices tothedevice. Ifyoudonotexperience problems with interfaces onthesame network, then
besure toconfigure static routes correctly .Forexample, both management0 andmanagement1 areonthe
same network, buttheFTD management andevent interfaces areondifferent networks. Thegateway is
192.168.45.1. Ifyouwant management1 toconnect tothemanagement's event-only interface at10.6.6.1/24,
youcancreate astatic route for10.6.6.0/24 through management1 with thesame gateway of192.168.45.1.
Trafficto10.6.6.0/24 willhitthisroute before ithitsthedefault route, somanagement1 willbeused as
expected.
Log Into theCommand Line Interface ontheDevice
Youcanlogdirectly intothecommand lineinterface onthreat defense devices. Ifthisisyour firsttime logging
in,complete theinitial setup process using thedefault admin user; seeComplete theInitial Configuration of
aSecure Firewall Threat Defense Device Using theCLI,onpage 2690 .
Ifauser makes three consecutive failed attempts tologintotheCLIviaSSH, thesystem terminates theSSH
connection.Note
Before you begin
Create additional user accounts thatcanlogintotheCLIusing theconfigureuser addcommand.
Procedure
Step 1 Connect tothethreat defense CLI, either from theconsole portorusing SSH.
YoucanSSH tothemanagement interface ofthethreat defense device. Youcanalsoconnect totheaddress
onadata interface ifyouopen theinterface forSSH connections. SSH access todata interfaces isdisabled
bydefault. SeeSSH Access ,onpage 946toallow SSH connections tospecific data interfaces.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
39Onboard Devices toCloud-delivered Firewall Management Center
Network Routes onDevice Management Interfaces

Forphysical devices, youcandirectly connect totheconsole portonthedevice. Seethehardware guide for
your device formore information about theconsole cable. Usethefollowing serial settings:
•9600 baud
•8data bits
•Noparity
•1stop bit
TheCLIontheconsole portisFXOS (with theexception oftheISA3000, where itistheregular threat defense
CLI) .Usethethreat defense CLIforbasic configuration, monitoring, andnormal system troubleshooting.
SeetheFXOS documentation forinformation onFXOS commands.
Step 2 Loginwith theadmin username andpassword.
Example:
firepower login:admin
Password:
Lastlogin:ThuMay1614:01:03 UTC2019onttyS0
Successful loginattempts foruser'admin' :1
firepower#
Step 3 Ifyouused theconsole port, access thethreat defense CLI.
connect ftd
This stepdoes notapply totheISA3000. Note
Example:
firepower# connect ftd
>
Step 4 AttheCLIprompt (>),useanyofthecommands allowed byyour level ofcommand lineaccess.
Toreturn toFXOS ontheconsole port, enter exit.
Step 5 (Optional) Ifyouused SSH, youcanconnect toFXOS.
connect fxos
Toreturn tothethreat defense CLI, enter exit.
Step 6 (Optional) Access thediagnostic CLI:
system support diagnostic-cli
UsethisCLIforadvanced troubleshooting. This CLIincludes additional showandother commands.
This CLIhastwosub-modes: user EXEC andprivileged EXEC mode. More commands areavailable in
privileged EXEC mode. Toenter privileged EXEC mode, enter theenable command; press enter without
entering apassword when prompted.
Example:
>systemsupport diagnostic-cli
firepower> enable
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
40Onboard Devices toCloud-delivered Firewall Management Center
Log Into theCommand Line Interface ontheDevice

Password:
firepower#
Toreturn totheregular CLI, type Ctrl-a ,d.
Troubleshooting
Usethefollowing scenarios totroubleshoot anyonboarding issues.
Troubleshoot Cloud-delivered Firewall Management Center Connectivity with
TCP
Usethefollowing procedure totroubleshoot connectivity between thecloud-delivered Firewall Management
Center andathreat defense device with TCP port8305.
Procedure
Step 1 LogintoCDO .
Step 2 Navigate toTools&Services intheleftpanel andselect Firewall Management Center toopen theServices
page. Choose Cloud-Deli veredFMC andlocate thecloud-delivered Firewall Management Center 'sFQDN
inthetoprighthand corner .
Step 3 Make sure thethreat defense device's state inCDO iscurrently Onboarding .Cloud-delivered Firewall
Management Center willnotrespond ifthedevice isnotinanonboarding state. Ifonboarding hasfailed, click
Retry Onboarding .
Step 4 Logintothethreat defense device with SSH.
Step 5 Enter intoExpert mode with thefollowing command:
>expert
admin@devicename:~$
Step 6 Execute aTCP handshake:
admin@devicename: ~$nc-vxxxxxx.cdo.cisco.com 8305
Connection toxxxxxx.cdo.cisco.com 8305port[tcp/*] succeeded!
^C(CTRL-C toexitnetcat)
admin@devicename:~$.
What todonext
Ifthere isstillnoresponse from thecloud-delivered Firewall Management Center ,then there isachance that
outbound portTCP 8305 may beblocked upstream from your threat defense device andthatnetwork path
willneed tobeassured before your threat defense willbeable toconnect tocloud-delivered Firewall
Management Center .
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
41Onboard Devices toCloud-delivered Firewall Management Center
Troubleshooting

Troubleshoot Threat Defense Device Connectivity
Testconnectivity totheInternet from themanagement-plane ofthethreat defense device:
Procedure
Purpose Command orAction
Logintothethreat defense device with SSH. Step 1
Ping oneorboth ofthefollowing: Step 2 •system 208.67.222.222
•system cisco.com
What todonext
Ifeither ofthese tests fail,there islikely anL1-L3 issue andyouwillneed tocheck your management
networking configuration (shownetwork )and/or aDNS issue.
Troubleshoot Device Connectivity Loss After Cloud-delivered Firewall
Management Center Update
Acloud-delivered Firewall Management Center isassigned adynamic IPaddress when itisadded toaCDO
tenant. When themanagement center isupdated, themanagement center receives anew dynamic IPaddress.
Ifyouhave afirewall inspecting theoutbound trafficfrom your threat defense device tothecloud-delivered
Firewall Management Center ,your firewall rules must allow thethreat defense traffictoflow totheFQDN
andportofthemanagement center rather than itsIPaddress, orthemanagement center willnotbeable to
manage your threat defense device.
Forexample, ifyour network trafficruleallowing management trafficfrom your threat defense device tothe
cloud-delivered Firewall Management Center looks likethis:
allowalltraffic <my-threat-defense-ip-src> to200.165.200.225
where 200.165.200.225 isthemanagement address ofthecloud-delivered Firewall Management Center ,
change theoneallow ruletothese twoallow rules asboth ports 443and8305 need tobeopen:
allowalltraffic <my-threat-defense-ip-src >to<my-cdfFMC-FQDN>:443
allowalltraffic <my-threat-defense-ip-src >to<my-cdfFMC-FQDN>:8305
See“Network Requirements” inPrerequisites toOnboard aDevice toCloud-delivered Firewall Management
Center formore portinformation.
Where doIfind thedomain name ofmycloud-delivered Firewall Management Center ?
Where doIfindthedomain name ofmycloud-delivered Firewall Management Center?
1.LogintoCDO .
2.From themenu bar,navigate Tools &Services >Firewall Management Center .
3.Select theCloud-delivered Firewall Management Center intheFMC table.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
42Onboard Devices toCloud-delivered Firewall Management Center
Troubleshoot Threat Defense Device Connectivity

4.Inthetop-right corner ofthescreen, youwillseetheHostname ofthemanagement center .This isthe
FQDN.
Figure 1:Cloud-delivered FMC FQDN
Troubleshoot Onboarding aDevice totheCloud-delivered Firewall
Management Center Using theCLIRegistration Key
Error: Device Remains inPending Setup State After Onboarding
When adevice fails toregister ,thedevice's connectivity status isdisplayed asPending Setup .Inthepanel
located totheright, CDO displays aRegistration Failed message aswell asaRetry Onboarding button to
immediately allow youtoreattempt onboarding thedevice.
Ifyoufailtoexecute theconfiguration manager command inthedevice CLIwithin 3mins after onboarding
ittoCDO ,thedevice's registration attempt expires andresults inaregistrationg failure. Usethefollowing
procedure toresolve theissue:
Procedure
Step 1 LogintoCDO andnavigate totheInventory page. Locate thedevice thatfailed toregister .
Step 2 Inthepanel located totheright, locate theRegistration Failed window .Beside thedevice's CLIregistration
key,click Copy .This actions copies theCLIkeytoalocal clipboard.
Step 3 Open anSSH connection tothedevice andloginasadmin .
Step 4 Paste theCLIregistration keyintothedevice's CLIinterface. IntheCLI, enter Ytocomplete theregistration.
Ifyour device waspreviously managed bydevice manager ,enter Yestoconfirm thesubmission.
Troubleshoot Onboarding aDevice toCloud-delivered Firewall Management
Center Using theSerial Number
Device isOffline orUnreachable
Ifthedevice isunreachable during theonboarding proess, oratanypoint post-onboarding, CDO displays an
Unreachable connectivity status. Thedevice willnotbeable tofully onboard toCDO until thedevice isable
toconnect. Thefollowing scenarios might bethecause:
•Thedevice iscabled incorrectly .
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
43Onboard Devices toCloud-delivered Firewall Management Center
Troubleshoot Onboarding aDevice totheCloud-delivered Firewall Management Center Using theCLIRegistration Key

•Yournetwork may require astatic IPaddress forthedevice.
•Yournetwork uses custom DNS, orthere isexternal DNS blocking thenetwork.
•Ifyour device isassociated with theEuropean region (https://defenseorchestrator .eu/),youmay need to
enable PPPoE authentication.For other domains, review thedomain requirements .
•Thedevice may beblocked byafirewall, orisincorrectly blocking aportforconnectivity .Review the
device Network Requirements ,onpage 25andconfirm thecorrect outgoing ports areenabled.
Error: Serial Number Already Claimed
The Device was Purchased From anExternal Vendor
Ifthedevice waspurchased from anexternal vendor andfails toonboard with aSerial Number Already
Claimed error ,it'spossible thedevice isstillassociated tothevendor's tenant. Usethefollowing steps to
claim thedevice anditsserial number:
1.Delete thedevice from your CDO tenant.
2.Install theFXOS image onthedevice. Formore information, seethe"Reimage Procedures" chapter of
theCisco FXOS Troubleshooting Guide fortheFirepower 1000/21000 andSecure Firewall 3100 Firepower
Threat Defense guide.
3.Connect alaptop tothedevice's console port.
4.Connect totheFXOS CLIandloginasadmin .
5.IntheFXOS CLI, connect tolocal-mgmt with thefirepower #connect local-mgmt command.
6.Execute thefirepower(local-mgmt) #cloudderegister command toderegister thedevice from the
cloud tenancy .
7.Once thedevice issuccessfully unregistered, theCLIinterface returns asuccess message. Anexample
ofthemessage:
Example: firepower(local-mgmt) #cloudderegister Release ImageDetected RESULT=success
MESSAGE=SUCCESS 10,X-Flow-Id: 2b3c9e8b-76c3-4764-91e4-cfd9828e73f9
Ifthedevice wasnever registered toanother CDO tenant, themessage above statesRESULT=success
MESSAGE=DEVICE_NOT_FOUND .Note
8.Onboard thedevice toyour CDO tenant with itsserial number .SeeOnboard aDevice with Zero-T ouch
Provisioning ,onpage 27formore information.
The Device isClaimed ByaCDO Tenant inAnother Region
Thedevice may have been previously managed byanother CDO instance inadifferent region andisstill
registered tothattenant.
Ifyoudohave access tothetenant thedevice iscurrently registered to,usethefollowing procedure:
1.Delete thedevice from theincorrect CDO tenant.
2.Logintothedevice's device manager UI.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
44Onboard Devices toCloud-delivered Firewall Management Center
Error: Serial Number Already Claimed

3.Navigate toSystem Settings >Cloud Services .
4.Click Cloud Services andselect Unregister Cloud Services from thedrop-down list.
5.Confirm theaction andclick Unregister .This action generates awarning toindicate thatthedevice has
been removed from CDO .This isexpected behavior .
6.LogintoCDO tenant inthecorrect region andonboard thedevice. SeeOnboard aDevice with Zero-T ouch
Provisioning ,onpage 27formore information.
7.Navigate toSystem Settings >Cloud Services .
8.Click Cloud Services andselect Unregister Cloud Services from thedrop-down list.
9.Select theAuto-enr ollwith Tenancy fromCisco Defense Orchestrator andclick Register .Thedevice
maps tothenew tenant thatbelongs tothenew region andCDO onboards thedevice.
Ifyoudonothave access tothetenant, usetheprocedure below:
1.Connect totheFXOS CLIfrom theconsole portandloginasadmin .Forinformation onhow tologinto
theFXOS CLI, seeAccessing theFXOS CLI.
2.IntheFXOS CLI, connect tolocal-mgmt with thefirepower #connect local-mgmt command.
3.Execute thefirepower(local-mgmt) #cloudderegister command toderegister thedevice from the
cloud tenancy .
4.Once thedevice issuccessfully unregistered, theCLIinterface returns asuccess message. Anexample
ofthemessage:
Example: firepower(local-mgmt) #cloudderegister Release ImageDetected RESULT=success
MESSAGE=SUCCESS 10,X-Flow-Id: 2b3c9e8b-76c3-4764-91e4-cfd9828e73f9
Ifthedevice wasnever registered toanother CDO tenant, themessage above statesRESULT=success
MESSAGE=DEVICE_NOT_FOUND .Note
5.Inyour CDO tenant inthecorrect domain, onboard thedevice. SeeOnboard aDevice with Zero-T ouch
Provisioning ,onpage 27formore information.
6.Inthedevice's device manager UI,navigate toSystem Settings >Cloud Services .
7.Select theAuto-enr ollwith Tenancy fromCisco Defense Orchestrator andclick Register .Thedevice
maps tothenew tenant thatbelongs tothenew region andCDO onboards thedevice.
Error: Claim Error
Ifyouenter thewrong serial number when onboarding adevice, CDO generates aClaim Errorstatus.
Confirm thatthedevice isclaimed inthecorrect region within CDO . Note
Resolve thisissue with theprovedure below:
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
45Onboard Devices toCloud-delivered Firewall Management Center
Error: Claim Error

Procedure
Step 1 LogintoCDO andnavigate totheInventory page. Locate thedevice with theerror .
Step 2 Select thedevice soitishighlighted andRemo vethedevice from CDO .
Step 3 Confirm thefollowing:
•Thedevice isonline andcanreach theinternet.
•Thedevice hasnotalready been onboarded toyour CDO instance orclaimed byaCDO tenant inanother
region.
Step 4 Locate thedevice's serial number .Youcanuseoneofthefollowing methods:
•Forthe1000, 2100 and3100 series model, locate theserial number onthephysical device.
•Open anSSH connection tothedevice andissue theshowserial-number command.
Step 5 InCDO ,onboard thedevice with thecorrect serial number .SeeOnboard aDevice with Zero-T ouch
Provisioning ,onpage 27formore information.
Error: Failed toClaim
IfyouseeanError:Failed toClaim connectivity status orerror message after attempting toonboard a
device, thefollowing might bethecause:
•TheSecurity Services Exchange platform may have temporary issues thatresult innoconnectivity .
•TheCDO server may bedown.
Follow theprocedure below toresolve thisissue:
Procedure
Step 1 LogintoCDO andnavigate totheInventory page. Locate thedevice thatfailed toregister .
Step 2 Select thedevice soitishighlighted andRemo vethedevice from your CDO tenant.
Step 3 Waitatleast 10minutes before attempting toonboard thedevice back toyour CDO tenant. SeeOnboard a
Device with Zero-T ouch Provisioning ,onpage 27formore information.
What todonext
Ifyouarestillunable toclaim thedevice, review thedevice's workflow toseeisthere isanerror message. If
there is,Export theWorkflow andopen asupport case tofurther troubleshoot theissue.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
46Onboard Devices toCloud-delivered Firewall Management Center
Error: Failed toClaim

Error: Provisional Error
Device Password Has Not Been Changed
Ifyoudidnotchange thedefault password ofthedevice when configuring thedevice forremote management
andselected theNo,thisdevicehasbeen logged intoandconfiguredforamanager option when onboarding
thedevice toCDO ,thedevice willgenerate anUnPr ovisioned connectivity status intheInventory page.
Usethefollowing procedure toresolve thisissue:
1.LogintoCDO andnavigate totheInventory page.
2.Locate andselect thedevice with theUnPr ovisioned connectivity status soitishighlighted.
3.Inthepane located totheright, locate theChange Passw ordwindow .
4.Click Change Passw ordandenter anewpassword foryour device. This overwrites thedefault password.
Itmay take afewminutes forthedevice toonboard andfully synchronize toCDO .
Device Password Has Already Been Changed
Ifyoudidchange thedefault password ofthedevice when configuring thedevice forremote management
andselected theIsthisanew device that hasneverbeen logged into orconfiguredbefore?option when
onboarding thedevice toCDO ,CDO generates anUnPr ovisioned connectivity status intheInvenotry page.
Usethefollowing procedure toresolve thisissue:
1.LogintoCDO andnavigate totheInventory page.
2.Locate andselect thedevice with theUnPr ovisioned connectivity status soitishighlighted.
3.Inthepane located totheright, locate theConf irmandProceed window .
4.Click Conf irmandProceed .This action ignores thepassword thatwasprovided intheonboarding wizard
andreinstates thedefault password forthedevice. CDO then continues toonboard thedevice.
Other Provisional Error Scenarios
Regardless ofthedefault password configuration ofthedevice, itisstillpossible foradevice toresult inan
UnPr ovisioned conectivity status during theonboarding process. Ifyouconfirm thepassword selection in
theonboarding wizard isaccurate forthestate ofthedevice, consider thefollowing options toresolve the
issue:
•Select thedevice soitishighlighted. Inthewindow located ontheright pane ofthescreen, click Retry
toforce CDO tore-onboard thedevice with existing provisional parameters.
•Delete thedevice from theInventory page andattempt tore-onboard thedevice.
•Inthedevice's device manager UI,navigate toSystem Settings >Cloud Services .Select theAuto-enr oll
with Tenancy fromCisco Defense Orchestrator andclick Register .
Ifyouarestillunable toclaim thedevice, review thedevice's workflow toseeisthere isanerror message. If
there is,Export theWorkflow andopen asupport case tofurther troubleshoot theissue.
Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
47Onboard Devices toCloud-delivered Firewall Management Center
Error: Provisional Error

Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center inCisco Defense Orchestrator
48Onboard Devices toCloud-delivered Firewall Management Center


